const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vendor-D0b57E6Q.js","assets/react-vendor-9c8TE4CQ.js","assets/pdf-BS8VfjLT.js","assets/pdfService-B2mUxKie.js","assets/Calculator-Czu8L2XE.js","assets/icons-CrYPN78F.js","assets/router-D4Yn-kk_.js","assets/ShareButton-Cfwd4-4l.js","assets/SocialShare-CQxgrFJH.js","assets/SocialShare-BeqQbHY3.css","assets/supabase-CpXiahKC.js","assets/charts-D-0nM1O5.js","assets/date-utils-DhyeW5k6.js","assets/Calculator-BxpSx5Fb.css","assets/HalfLife-Dpn4YjGE.js","assets/HalfLife-Bzb4TIfV.css","assets/PriceChecker-D8jqzBHU.js","assets/PriceChecker-BrUf30AF.css","assets/Encyclopedia-K9_ZozCi.js","assets/PeptideDetail-CzBW8CCb.js","assets/Guides-Bk28KSZi.js","assets/Safety-CddXVqfx.js","assets/BeginnerGuide-CjkcZ21W.js","assets/InjectionGuide-C2ZSleki.js","assets/Forum-exe7ZX1h.js","assets/Forum-BF2Z8NER.css","assets/Inventory-DfNyP7ac.js","assets/Inventory-_cP4O8uB.css","assets/InjectionSites-lzCxJYIa.js","assets/InjectionSites-BQP1Mo-e.css","assets/BloodWork-DjMaPvW8.js","assets/BloodWork-OrTzRCvJ.css","assets/TitrationPlan-8_1n-f3v.js","assets/TitrationPlan-uSv-Rg3H.css","assets/Reviews-DHqrkFdN.js","assets/Reviews-Crgheim5.css"])))=>i.map(i=>d[i]);
import{r,j as e,d as ns,f as Xs}from"./react-vendor-9c8TE4CQ.js";import{a9 as Zs,aa as Ks,ab as Cs,ac as Qs,ad as ea,ae as ta,af as sa,ag as aa}from"./vendor-D0b57E6Q.js";import{_ as le,E as na}from"./pdf-BS8VfjLT.js";import{c as ia}from"./supabase-CpXiahKC.js";import{u as ct,N as $t,a as Fe,O as Is,L as pe,b as Ut,B as ra,R as oa,c as ne}from"./router-D4Yn-kk_.js";import{L as ut,S as ca,X as et,M as la,A as Ee,B as wt,T as zt,P as Gt,a as He,b as da,c as it,d as ke,e as Ds,f as Oe,C as Qt,E as ma,g as St,h as pt,i as Nt,j as Ce,k as kt,R as ua,l as ha,m as es,n as is,o as mt,p as gt,q as Ke,D as pa,r as ze,U as xt,s as Ts,H as ga,t as xa,u as Ve,v as _a,w as fa,x as lt,y as us,z as ja,F as Be,G as je,I as Je,Z as Ls,J as Ae,K as ya,N as It,O as Dt,Q as ts,V as Rt,W as Mt,Y as Wt,_ as Bs,$ as rt,a0 as va,a1 as Ct,a2 as hs,a3 as ot,a4 as Ot,a5 as rs,a6 as Qe,a7 as Ze,a8 as os,a9 as ba,aa as wa,ab as Sa,ac as Na,ad as Vt,ae as As,af as Pe,ag as Jt,ah as ka,ai as qt,aj as Ft,ak as Ps,al as ft,am as Ca,an as Ia,ao as ss,ap as Da,aq as ps,ar as Ta,as as Es,at as $s,au as La,av as Ba,aw as gs,ax as Aa,ay as zs,az as Pa,aA as Ea}from"./icons-CrYPN78F.js";import{C as $a,a as za,L as Ra,P as Ma,b as Oa,B as Va,A as Fa,p as Ha,c as Ua,d as Ga,i as Wa,e as qa,D as Ya,f as Ja}from"./charts-D-0nM1O5.js";import{s as nt,f as ve,a as Xa,e as Za,b as Ka,c as Xt,i as Qa,d as en,g as tn,h as xs,j as _s}from"./date-utils-DhyeW5k6.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const d of o)if(d.type==="childList")for(const c of d.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function a(o){const d={};return o.integrity&&(d.integrity=o.integrity),o.referrerPolicy&&(d.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?d.credentials="include":o.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function i(o){if(o.ep)return;o.ep=!0;const d=a(o);fetch(o.href,d)}})();const sn={translation:{nav:{home:"Home",tracker:"Tracker",calculator:"Calc",library:"Library",schedule:"Schedule",guides:"Guides",profile:"Profile",login:"Login",more:"More"},dashboard:{welcome:"Welcome back",quickActions:"Quick Actions",recentInjections:"Recent Injections",upcomingSchedule:"Upcoming Schedule",noInjections:"No injections logged yet",noSchedule:"No upcoming doses scheduled"},tracker:{title:"Injection Tracker",logInjection:"Log Injection",peptide:"Peptide",dosage:"Dosage",date:"Date",time:"Time",site:"Injection Site",notes:"Notes",save:"Save",delete:"Delete",edit:"Edit"},calculator:{title:"Reconstitution Calculator",peptideAmount:"Peptide Amount",bacWater:"BAC Water",desiredDose:"Desired Dose",result:"Draw",units:"units"},schedule:{title:"Schedule",addDose:"Add Dose",today:"Today",upcoming:"Upcoming",completed:"Completed",markComplete:"Mark Complete"},settings:{title:"Settings",profile:"Profile",preferences:"Preferences",notifications:"Notifications",theme:"Theme",language:"Language",darkMode:"Dark Mode",lightMode:"Light Mode",export:"Export Data",logout:"Log Out"},common:{save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",loading:"Loading...",error:"Error",success:"Success",confirm:"Confirm",back:"Back",next:"Next",mg:"mg",mcg:"mcg",iu:"IU",ml:"mL"},export:{title:"Export Data",format:"Format",csv:"CSV",pdf:"PDF",dateRange:"Date Range",allTime:"All Time",lastMonth:"Last Month",lastWeek:"Last Week",download:"Download"},notifications:{enabled:"Notifications Enabled",disabled:"Notifications Disabled",scheduled:"Scheduled Dose Reminder",lowStock:"Low Stock Alert",permission:"Allow Notifications"}}},an={translation:{nav:{home:"Inicio",tracker:"Registro",calculator:"Calc",library:"Biblioteca",schedule:"Horario",guides:"Guías",profile:"Perfil",login:"Iniciar",more:"Más"},dashboard:{welcome:"Bienvenido de nuevo",quickActions:"Acciones Rápidas",recentInjections:"Inyecciones Recientes",upcomingSchedule:"Próximas Dosis",noInjections:"No hay inyecciones registradas",noSchedule:"No hay dosis programadas"},tracker:{title:"Registro de Inyecciones",logInjection:"Registrar Inyección",peptide:"Péptido",dosage:"Dosis",date:"Fecha",time:"Hora",site:"Sitio de Inyección",notes:"Notas",save:"Guardar",delete:"Eliminar",edit:"Editar"},calculator:{title:"Calculadora de Reconstitución",peptideAmount:"Cantidad de Péptido",bacWater:"Agua BAC",desiredDose:"Dosis Deseada",result:"Extraer",units:"unidades"},schedule:{title:"Horario",addDose:"Agregar Dosis",today:"Hoy",upcoming:"Próximo",completed:"Completado",markComplete:"Marcar Completo"},settings:{title:"Configuración",profile:"Perfil",preferences:"Preferencias",notifications:"Notificaciones",theme:"Tema",language:"Idioma",darkMode:"Modo Oscuro",lightMode:"Modo Claro",export:"Exportar Datos",logout:"Cerrar Sesión"},common:{save:"Guardar",cancel:"Cancelar",delete:"Eliminar",edit:"Editar",loading:"Cargando...",error:"Error",success:"Éxito",confirm:"Confirmar",back:"Atrás",next:"Siguiente",mg:"mg",mcg:"mcg",iu:"UI",ml:"mL"},export:{title:"Exportar Datos",format:"Formato",csv:"CSV",pdf:"PDF",dateRange:"Rango de Fechas",allTime:"Todo el Tiempo",lastMonth:"Último Mes",lastWeek:"Última Semana",download:"Descargar"},notifications:{enabled:"Notificaciones Activadas",disabled:"Notificaciones Desactivadas",scheduled:"Recordatorio de Dosis Programada",lowStock:"Alerta de Stock Bajo",permission:"Permitir Notificaciones"}}};Zs.use(Ks).init({resources:{en:sn,es:an},lng:localStorage.getItem("peptide_language")||"en",fallbackLng:"en",interpolation:{escapeValue:!1}});const nn="https://nhiwjerqyhtpienorzky.supabase.co",rn="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5oaXdqZXJxeWh0cGllbm9yemt5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQxODU1MDEsImV4cCI6MjA3OTc2MTUwMX0.F4vRdN3qeH2ONDxoIgchW3Pn21KsGAWavwdnD3zkxhI",S=ia(nn,rn),Rs=r.createContext({}),Se=()=>r.useContext(Rs),on=({children:t})=>{const[s,a]=r.useState(null),[i,o]=r.useState(!0);r.useEffect(()=>{S.auth.getSession().then(({data:{session:p}})=>{a(p?.user??null),o(!1)});const{data:{subscription:z}}=S.auth.onAuthStateChange((p,C)=>{a(C?.user??null),o(!1)});return()=>z.unsubscribe()},[]);const D={user:s,loading:i,signUp:async(z,p,C)=>{const{data:y,error:x}=await S.auth.signUp({email:z,password:p,options:{data:{full_name:C}}});if(x)throw x;return y},signIn:async(z,p)=>{const{data:C,error:y}=await S.auth.signInWithPassword({email:z,password:p});if(y)throw y;return C},signInWithOAuth:async z=>{const{data:p,error:C}=await S.auth.signInWithOAuth({provider:z,options:{redirectTo:`${window.location.origin}/settings`}});if(C)throw C;return p},signOut:async()=>{const{error:z}=await S.auth.signOut();if(z)throw z},resetPassword:async z=>{const{error:p}=await S.auth.resetPasswordForEmail(z,{redirectTo:`${window.location.origin}/update-password`});if(p)throw p},updatePassword:async z=>{const{error:p}=await S.auth.updateUser({password:z});if(p)throw p},mockLogin:()=>{a({id:"mock-user-id",email:"demo@example.com",user_metadata:{full_name:"Demo User"}}),o(!1)}};return e.jsx(Rs.Provider,{value:D,children:!i&&t})},Ms=r.createContext(),Os=()=>{const t=r.useContext(Ms);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t},cn=({children:t})=>{const{user:s}=Se(),[a,i]=r.useState(()=>{const c=localStorage.getItem("peptide_theme");return c||(window.matchMedia("(prefers-color-scheme: light)").matches?"light":"dark")});r.useEffect(()=>{document.documentElement.setAttribute("data-theme",a),localStorage.setItem("peptide_theme",a)},[a]),r.useEffect(()=>{(async()=>{if(s)try{const{data:u}=await S.from("profiles").select("theme_preference").eq("id",s.id).single();u?.theme_preference&&i(u.theme_preference)}catch{console.log("Theme preference not found, using local")}})()},[s]);const o=async()=>{const c=a==="dark"?"light":"dark";if(i(c),s)try{await S.from("profiles").update({theme_preference:c}).eq("id",s.id)}catch(u){console.error("Error saving theme preference:",u)}},d=async c=>{if(i(c),s)try{await S.from("profiles").update({theme_preference:c}).eq("id",s.id)}catch(u){console.error("Error saving theme preference:",u)}};return e.jsx(Ms.Provider,{value:{theme:a,toggleTheme:o,setThemeMode:d},children:t})},Pt=({children:t})=>{const{user:s,loading:a}=Se(),i=ct();return a?e.jsx("div",{className:"loading-screen",children:"Loading..."}):s?t:e.jsx($t,{to:"/login",state:{from:i},replace:!0})},ln=({children:t})=>{const{user:s,loading:a}=Se(),[i,o]=r.useState(null),[d,c]=r.useState(!0),u=ct();return r.useEffect(()=>{a||(async()=>{if(!s){o(!1),c(!1);return}try{const{data:h,error:j}=await S.from("profiles").select("is_admin").eq("id",s.id).single();j?(console.error("Error checking admin status:",j),o(!1)):o(h?.is_admin===!0)}catch(h){console.error("Error checking admin status:",h),o(!1)}finally{c(!1)}})()},[s,a]),a||d?e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",gap:"1rem"},children:[e.jsx(ut,{className:"animate-spin",size:32}),e.jsx("p",{style:{color:"var(--text-secondary)"},children:"Checking permissions..."})]}):s?i?t:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100vh",gap:"1.5rem",padding:"2rem",textAlign:"center"},children:[e.jsx("div",{style:{width:"80px",height:"80px",borderRadius:"50%",background:"rgba(239, 68, 68, 0.1)",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ca,{size:40,color:"#ef4444"})}),e.jsx("h1",{style:{fontSize:"1.5rem",margin:0},children:"Access Denied"}),e.jsx("p",{style:{color:"var(--text-secondary)",maxWidth:"400px"},children:"You don't have permission to access the admin panel. This area is restricted to administrators only."}),e.jsx("a",{href:"/",className:"btn-primary",style:{textDecoration:"none"},children:"Return to Home"})]}):e.jsx($t,{to:"/login",state:{from:u},replace:!0})},Te=Cs.isNativePlatform(),_t=Cs.getPlatform(),dn={async impact(t="medium"){if(Te)try{const{Haptics:s,ImpactStyle:a}=await le(async()=>{const{Haptics:o,ImpactStyle:d}=await import("./vendor-D0b57E6Q.js").then(c=>c.ai);return{Haptics:o,ImpactStyle:d}},__vite__mapDeps([0,1,2])),i={light:a.Light,medium:a.Medium,heavy:a.Heavy};await s.impact({style:i[t]||a.Medium})}catch(s){console.log("Haptics not available",s)}},async notification(t="success"){if(Te)try{const{Haptics:s,NotificationType:a}=await le(async()=>{const{Haptics:o,NotificationType:d}=await import("./vendor-D0b57E6Q.js").then(c=>c.ai);return{Haptics:o,NotificationType:d}},__vite__mapDeps([0,1,2])),i={success:a.Success,warning:a.Warning,error:a.Error};await s.notification({type:i[t]||a.Success})}catch(s){console.log("Haptics not available",s)}},async vibrate(t=300){if(Te)try{const{Haptics:s}=await le(async()=>{const{Haptics:a}=await import("./vendor-D0b57E6Q.js").then(i=>i.ai);return{Haptics:a}},__vite__mapDeps([0,1,2]));await s.vibrate({duration:t})}catch(s){console.log("Haptics not available",s)}}},at={async requestPermission(){if(!Te)return!1;try{const{LocalNotifications:t}=await le(async()=>{const{LocalNotifications:a}=await import("./vendor-D0b57E6Q.js").then(i=>i.aj);return{LocalNotifications:a}},__vite__mapDeps([0,1,2]));return(await t.requestPermissions()).display==="granted"}catch(t){return console.log("Local notifications not available",t),!1}},async schedule(t){if(Te)try{const{LocalNotifications:s}=await le(async()=>{const{LocalNotifications:a}=await import("./vendor-D0b57E6Q.js").then(i=>i.aj);return{LocalNotifications:a}},__vite__mapDeps([0,1,2]));await s.schedule({notifications:t})}catch(s){console.log("Failed to schedule notification",s)}},async scheduleInjectionReminder({id:t,title:s,body:a,scheduledAt:i}){return this.schedule([{id:t,title:s||"Peptide Tracker Reminder",body:a,schedule:{at:i},sound:"default",smallIcon:"ic_stat_icon",iconColor:"#8b5cf6",actionTypeId:"INJECTION_REMINDER",extra:{type:"injection_reminder"}}])},async cancel(t){if(Te)try{const{LocalNotifications:s}=await le(async()=>{const{LocalNotifications:a}=await import("./vendor-D0b57E6Q.js").then(i=>i.aj);return{LocalNotifications:a}},__vite__mapDeps([0,1,2]));await s.cancel({notifications:t.map(a=>({id:a}))})}catch(s){console.log("Failed to cancel notifications",s)}},async getPending(){if(!Te)return[];try{const{LocalNotifications:t}=await le(async()=>{const{LocalNotifications:a}=await import("./vendor-D0b57E6Q.js").then(i=>i.aj);return{LocalNotifications:a}},__vite__mapDeps([0,1,2]));return(await t.getPending()).notifications}catch(t){return console.log("Failed to get pending notifications",t),[]}}},Ht={async setStyle(t="dark"){if(Te)try{const{StatusBar:s,Style:a}=await le(async()=>{const{StatusBar:i,Style:o}=await import("./vendor-D0b57E6Q.js").then(d=>d.ak);return{StatusBar:i,Style:o}},__vite__mapDeps([0,1,2]));await s.setStyle({style:t==="dark"?a.Dark:a.Light})}catch(s){console.log("Status bar not available",s)}},async setBackgroundColor(t){if(!(!Te||_t!=="android"))try{const{StatusBar:s}=await le(async()=>{const{StatusBar:a}=await import("./vendor-D0b57E6Q.js").then(i=>i.ak);return{StatusBar:a}},__vite__mapDeps([0,1,2]));await s.setBackgroundColor({color:t})}catch(s){console.log("Status bar not available",s)}},async hide(){if(Te)try{const{StatusBar:t}=await le(async()=>{const{StatusBar:s}=await import("./vendor-D0b57E6Q.js").then(a=>a.ak);return{StatusBar:s}},__vite__mapDeps([0,1,2]));await t.hide()}catch(t){console.log("Status bar not available",t)}},async show(){if(Te)try{const{StatusBar:t}=await le(async()=>{const{StatusBar:s}=await import("./vendor-D0b57E6Q.js").then(a=>a.ak);return{StatusBar:s}},__vite__mapDeps([0,1,2]));await t.show()}catch(t){console.log("Status bar not available",t)}}},mn={async hide(){if(Te)try{const{SplashScreen:t}=await le(async()=>{const{SplashScreen:s}=await import("./vendor-D0b57E6Q.js").then(a=>a.al);return{SplashScreen:s}},__vite__mapDeps([0,1,2]));await t.hide()}catch(t){console.log("Splash screen not available",t)}},async show(t={}){if(Te)try{const{SplashScreen:s}=await le(async()=>{const{SplashScreen:a}=await import("./vendor-D0b57E6Q.js").then(i=>i.al);return{SplashScreen:a}},__vite__mapDeps([0,1,2]));await s.show(t)}catch(s){console.log("Splash screen not available",s)}}},fs={async addStateListener(t){try{const{App:s}=await le(async()=>{const{App:a}=await import("./vendor-D0b57E6Q.js").then(i=>i.am);return{App:a}},__vite__mapDeps([0,1,2]));s.addListener("appStateChange",t)}catch{}},async addUrlListener(t){try{const{App:s}=await le(async()=>{const{App:a}=await import("./vendor-D0b57E6Q.js").then(i=>i.am);return{App:a}},__vite__mapDeps([0,1,2]));s.addListener("appUrlOpen",t)}catch{}},async addBackButtonListener(t){if(_t==="android")try{const{App:s}=await le(async()=>{const{App:a}=await import("./vendor-D0b57E6Q.js").then(i=>i.am);return{App:a}},__vite__mapDeps([0,1,2]));s.addListener("backButton",t)}catch{}},async exitApp(){if(_t==="android")try{const{App:t}=await le(async()=>{const{App:s}=await import("./vendor-D0b57E6Q.js").then(a=>a.am);return{App:s}},__vite__mapDeps([0,1,2]));await t.exitApp()}catch{}}},ht={isNative:Te,isAndroid:_t==="android"};async function un(){Te&&(await Ht.setStyle("dark"),_t==="android"&&await Ht.setBackgroundColor("#0f172a"),setTimeout(()=>{mn.hide()},500),await at.requestPermission(),console.log(`Peptide Tracker running on ${_t}`))}const hn="_nav_s3me3_2",pn="_navContent_s3me3_16",gn="_desktopOnly_s3me3_27",xn="_mobileOnly_s3me3_31",_n="_navItem_s3me3_42",fn="_label_s3me3_53",jn="_avatarIcon_s3me3_57",yn="_moreMenu_s3me3_117",vn="_backdrop_s3me3_118",bn="_active_s3me3_166",wn="_moreButton_s3me3_195",Sn="_activeDot_s3me3_199",Nn="_backdropVisible_s3me3_235",kn="_moreMenuOpen_s3me3_262",Cn="_moreMenuHeader_s3me3_268",In="_moreMenuTitle_s3me3_276",Dn="_closeButton_s3me3_282",Tn="_moreMenuGrid_s3me3_305",Ln="_moreMenuItem_s3me3_312",Bn="_moreMenuItemActive_s3me3_337",An="_moreMenuIcon_s3me3_343",Pn="_moreMenuLabel_s3me3_364",En="_premiumBadge_s3me3_374",$n="_premiumItem_s3me3_388",te={nav:hn,navContent:pn,desktopOnly:gn,mobileOnly:xn,navItem:_n,label:fn,avatarIcon:jn,moreMenu:yn,backdrop:vn,active:bn,moreButton:wn,activeDot:Sn,backdropVisible:Nn,moreMenuOpen:kn,moreMenuHeader:Cn,moreMenuTitle:In,closeButton:Dn,moreMenuGrid:Tn,moreMenuItem:Ln,moreMenuItemActive:Bn,moreMenuIcon:An,moreMenuLabel:Pn,premiumBadge:En,premiumItem:$n},zn=()=>{const{user:t}=Se(),[s,a]=r.useState(!1),i=ct(),o=r.useRef(null);r.useEffect(()=>{a(!1)},[i.pathname]),r.useEffect(()=>{const h=j=>{o.current&&!o.current.contains(j.target)&&a(!1)};return s&&(document.addEventListener("mousedown",h),document.addEventListener("touchstart",h)),()=>{document.removeEventListener("mousedown",h),document.removeEventListener("touchstart",h)}},[s]);const d=()=>{if(!t)return"";const h=t.user_metadata?.full_name||t.email||"";if(t.user_metadata?.full_name){const j=h.split(" ");return j.length>1?`${j[0][0]}${j[1][0]}`.toUpperCase():h[0]?.toUpperCase()||"U"}return h[0]?.toUpperCase()||"U"},c=["/half-life","/guides","/price-checker","/forum","/injection-sites","/blood-work","/titration","/reviews"].includes(i.pathname),u=()=>{dn.impact("light")},g=[{to:"/injection-sites",icon:la,label:"Inject Sites",ariaLabel:"Injection Site Guide"},{to:"/half-life",icon:Ee,label:"Decay Plot",ariaLabel:"Half-Life Plotter"},{to:"/guides",icon:wt,label:"Guides",ariaLabel:"Peptide Guides"},{to:"/price-checker",icon:zt,label:"Prices",ariaLabel:"Price Checker"},{to:"/inventory",icon:Gt,label:"Stock",ariaLabel:"Peptide Inventory"},{to:"/reviews",icon:He,label:"Reviews",ariaLabel:"Vendor Reviews"},{to:"/blood-work",icon:da,label:"Blood Work",ariaLabel:"Blood Work Tracker",premium:!0},{to:"/titration",icon:it,label:"Titration",ariaLabel:"Dose Titration Planner",premium:!0},{to:"/forum",icon:ke,label:"Forum",ariaLabel:"Community Forum"}];return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`${te.backdrop} ${s?te.backdropVisible:""}`,onClick:()=>a(!1)}),e.jsxs("div",{ref:o,className:`${te.moreMenu} ${s?te.moreMenuOpen:""}`,children:[e.jsxs("div",{className:te.moreMenuHeader,children:[e.jsx("span",{className:te.moreMenuTitle,children:"More Options"}),e.jsx("button",{className:te.closeButton,onClick:()=>a(!1),"aria-label":"Close menu",children:e.jsx(et,{size:20})})]}),e.jsx("div",{className:te.moreMenuGrid,children:g.map(h=>e.jsxs(Fe,{to:h.to,"aria-label":h.ariaLabel,className:({isActive:j})=>`${te.moreMenuItem} ${j?te.moreMenuItemActive:""} ${h.premium?te.premiumItem:""}`,onClick:()=>a(!1),children:[e.jsxs("div",{className:te.moreMenuIcon,children:[e.jsx(h.icon,{size:22}),h.premium&&e.jsx("span",{className:te.premiumBadge,children:"PRO"})]}),e.jsx("span",{className:te.moreMenuLabel,children:h.label})]},h.to))})]}),e.jsx("nav",{className:te.nav,children:e.jsxs("div",{className:te.navContent,children:[e.jsxs(Fe,{to:"/","aria-label":"Home",onClick:u,className:({isActive:h})=>`${te.navItem} ${h?te.active:""}`,children:[e.jsx(Ds,{size:22}),e.jsx("span",{className:te.label,children:"Home"})]}),e.jsxs(Fe,{to:"/log","aria-label":"Injection Log",onClick:u,className:({isActive:h})=>`${te.navItem} ${h?te.active:""}`,children:[e.jsx(Oe,{size:22}),e.jsx("span",{className:te.label,children:"Log"})]}),e.jsxs(Fe,{to:"/calculator","aria-label":"Reconstitution Calculator",onClick:u,className:({isActive:h})=>`${te.navItem} ${h?te.active:""}`,children:[e.jsx(Qt,{size:22}),e.jsx("span",{className:te.label,children:"Calc"})]}),e.jsxs(Fe,{to:"/encyclopedia","aria-label":"Peptide Encyclopedia",onClick:u,className:({isActive:h})=>`${te.navItem} ${h?te.active:""}`,children:[e.jsx(wt,{size:22}),e.jsx("span",{className:te.label,children:"Library"})]}),g.map(h=>e.jsxs(Fe,{to:h.to,"aria-label":h.ariaLabel,className:({isActive:j})=>`${te.navItem} ${te.desktopOnly} ${j?te.active:""}`,children:[e.jsx(h.icon,{size:22}),e.jsx("span",{className:te.label,children:h.label})]},h.to)),e.jsxs("button",{className:`${te.navItem} ${te.moreButton} ${te.mobileOnly} ${c?te.active:""}`,onClick:()=>{u(),a(!s)},"aria-label":"More options","aria-expanded":s,children:[e.jsx(ma,{size:22}),e.jsx("span",{className:te.label,children:"More"}),c&&e.jsx("span",{className:te.activeDot})]}),t?e.jsxs(Fe,{to:"/settings","aria-label":"Profile Settings",className:({isActive:h})=>`${te.navItem} ${h?te.active:""}`,children:[e.jsx("div",{className:te.avatarIcon,children:d()}),e.jsx("span",{className:te.label,children:"Profile"})]}):e.jsxs(Fe,{to:"/login","aria-label":"Login",className:({isActive:h})=>`${te.navItem} ${h?te.active:""}`,children:[e.jsx(St,{size:22}),e.jsx("span",{className:te.label,children:"Login"})]})]})})]})},Rn=()=>{const t=ct();return r.useEffect(()=>{if(ht.isNative){const s=document.documentElement.getAttribute("data-theme")!=="light";Ht.setStyle(s?"dark":"light"),ht.isAndroid&&Ht.setBackgroundColor("#0a0e1a")}},[]),r.useEffect(()=>{window.scrollTo(0,0)},[t.pathname]),r.useEffect(()=>{ht.isAndroid&&fs.addBackButtonListener(({canGoBack:s})=>{s||t.pathname!=="/"?window.history.back():fs.exitApp()})},[t.pathname]),r.useEffect(()=>{const s=()=>{const a=window.visualViewport?.height||window.innerHeight,i=window.innerHeight;a<i*.75?document.body.classList.add("keyboard-open"):document.body.classList.remove("keyboard-open")};return window.visualViewport&&window.visualViewport.addEventListener("resize",s),()=>{window.visualViewport&&window.visualViewport.removeEventListener("resize",s)}},[]),e.jsxs("div",{style:{minHeight:"100vh",display:"flex",flexDirection:"column",paddingTop:"var(--safe-area-top, 0px)"},children:[e.jsx("a",{href:"#main-content",className:"skip-link",style:{position:"absolute",top:"-50px",left:"16px",background:"var(--accent-primary)",color:"white",padding:"12px 24px",borderRadius:"0 0 8px 8px",zIndex:9999,fontWeight:600,textDecoration:"none",transition:"top 0.3s ease"},children:"Skip to main content"}),e.jsx("main",{id:"main-content",role:"main",style:{flex:1,paddingBottom:"calc(80px + var(--safe-area-bottom, 0px))"},children:e.jsx(Is,{})}),e.jsx(zn,{})]})},cs="peptide_tracker_injections",Et=()=>{try{const t=localStorage.getItem(cs);return t?JSON.parse(t):[]}catch{return[]}},Zt=t=>{try{localStorage.setItem(cs,JSON.stringify(t))}catch(s){console.error("Error saving to localStorage:",s)}},Tt=()=>{const[t,s]=r.useState([]),[a,i]=r.useState(!0),[o,d]=r.useState(null),{user:c}=Se(),u=r.useCallback(async()=>{try{d(null);const{data:p,error:C}=await S.from("injections").select("*").order("injection_date",{ascending:!1});if(C)throw C;const y=(p||[]).map(x=>({id:x.id,peptide:x.peptide_name,dosage:x.dosage_value||x.dosage_mcg/1e3,unit:x.dosage_unit||"mg",date:x.injection_date,notes:x.notes||"",site:x.injection_site||"Abdomen",bodyWeightLbs:x.body_weight_lbs||null}));s(y)}catch(p){console.error("Error fetching injections:",p),d("Failed to load injections")}},[]),g=r.useCallback(()=>{const p=Et();p.sort((C,y)=>new Date(y.date)-new Date(C.date)),s(p)},[]);r.useEffect(()=>{i(!0),c&&c.id!=="mock-user-id"?u().finally(()=>i(!1)):(g(),i(!1))},[c,u,g]);const h=async p=>{const C={...p,id:p.id||crypto.randomUUID(),date:p.date||new Date().toISOString()};if(s(y=>[C,...y]),c&&c.id!=="mock-user-id")try{const{data:y,error:x}=await S.from("injections").insert([{user_id:c.id,peptide_name:p.peptide,dosage_mcg:p.unit==="mg"?p.dosage*1e3:(p.unit==="mcg",p.dosage),dosage_value:p.dosage,dosage_unit:p.unit,injection_date:C.date,injection_site:p.site,body_weight_lbs:p.bodyWeightLbs||null,notes:p.notes||""}]).select().single();if(x)throw x;return s(m=>m.map(w=>w.id===C.id?{...w,id:y.id}:w)),{success:!0,data:y}}catch(y){return console.error("Error adding injection:",y),s(x=>x.filter(m=>m.id!==C.id)),d("Failed to save injection"),{success:!1,error:y}}else{const y=Et();return Zt([C,...y]),{success:!0,data:C}}},j=async(p,C)=>{if(s(y=>y.map(x=>x.id===p?{...x,...C}:x)),c&&c.id!=="mock-user-id")try{const{error:y}=await S.from("injections").update({peptide_name:C.peptide,dosage_mcg:C.unit==="mg"?C.dosage*1e3:C.dosage,dosage_value:C.dosage,dosage_unit:C.unit,injection_date:C.date,injection_site:C.site,body_weight_lbs:C.bodyWeightLbs,notes:C.notes}).eq("id",p);if(y)throw y;return{success:!0}}catch(y){return console.error("Error updating injection:",y),u(),{success:!1,error:y}}else{const x=Et().map(m=>m.id===p?{...m,...C}:m);return Zt(x),{success:!0}}},I=async p=>{const C=[...t];if(s(y=>y.filter(x=>x.id!==p)),c&&c.id!=="mock-user-id")try{const{error:y}=await S.from("injections").delete().eq("id",p);if(y)throw y;return{success:!0}}catch(y){return console.error("Error deleting injection:",y),s(C),d("Failed to delete injection"),{success:!1,error:y}}else{const x=Et().filter(m=>m.id!==p);return Zt(x),{success:!0}}},D=()=>{localStorage.removeItem(cs)},z=r.useCallback(()=>{if(t.length===0)return null;const p=Date.now(),C=t[0];let y=0;t.forEach(w=>{const l=new Date(w.date).getTime(),N=(p-l)/(1e3*60*60),F=(w.unit==="mcg"?w.dosage/1e3:w.dosage)*Math.pow(.5,N/168);F>.001&&(y+=F)});const x=p-10080*60*1e3,m=t.filter(w=>new Date(w.date).getTime()>x);return{totalInjections:t.length,lastInjection:C,activeLevel:y.toFixed(3),weeklyCount:m.length,weeklyDosage:m.reduce((w,l)=>w+(l.unit==="mcg"?l.dosage/1e3:l.dosage),0).toFixed(2)}},[t]);return{injections:t,loading:a,error:o,addInjection:h,updateInjection:j,deleteInjection:I,clearLocalInjections:D,getStats:z,refresh:c&&c.id!=="mock-user-id"?u:g,isUsingLocalStorage:!c||c.id==="mock-user-id"}},vt="peptidelog_onboarding_complete",Mn=()=>{const{user:t}=Se(),[s,a]=r.useState(!1),[i,o]=r.useState(!0);r.useEffect(()=>{(async()=>{o(!0);try{if(t){const{data:h,error:j}=await S.from("profiles").select("onboarding_complete").eq("id",t.id).single();j&&j.code!=="PGRST116"&&console.warn("Error checking onboarding status:",j);const I=h?.onboarding_complete===!0;a(!I)}else{const h=localStorage.getItem(vt)==="true";a(!h)}}catch(h){console.error("Error checking onboarding:",h),a(!1)}finally{o(!1)}})()},[t]);const d=r.useCallback(async()=>{try{t&&await S.from("profiles").update({onboarding_complete:!0}).eq("id",t.id),localStorage.setItem(vt,"true"),a(!1)}catch(g){console.error("Error completing onboarding:",g),localStorage.setItem(vt,"true"),a(!1)}},[t]),c=r.useCallback(()=>{localStorage.setItem(vt,"true"),a(!1)},[]),u=r.useCallback(async()=>{try{t&&await S.from("profiles").update({onboarding_complete:!1}).eq("id",t.id),localStorage.removeItem(vt),a(!0)}catch(g){console.error("Error resetting onboarding:",g)}},[t]);return{showOnboarding:s,loading:i,completeOnboarding:d,skipOnboarding:c,resetOnboarding:u}},On="_container_1aj82_1",Vn="_header_1aj82_5",Fn="_title_1aj82_14",Hn="_rangeSelector_1aj82_24",Un="_rangeButton_1aj82_28",Gn="_dropdown_1aj82_48",Wn="_dropdownItem_1aj82_62",qn="_active_1aj82_81",Yn="_statsGrid_1aj82_87",Jn="_statCard_1aj82_100",Xn="_statIcon_1aj82_116",Zn="_statContent_1aj82_126",Kn="_statValue_1aj82_132",Qn="_statLabel_1aj82_141",ei="_chartsGrid_1aj82_148",ti="_chartCard_1aj82_159",si="_chartTitle_1aj82_181",ai="_chartContainer_1aj82_188",ni="_noData_1aj82_193",ie={container:On,header:Vn,title:Fn,rangeSelector:Hn,rangeButton:Un,dropdown:Gn,dropdownItem:Wn,active:qn,statsGrid:Yn,statCard:Jn,statIcon:Xn,statContent:Zn,statValue:Kn,statLabel:Qn,chartsGrid:ei,chartCard:ti,chartTitle:si,chartContainer:ai,noData:ni};$a.register(za,Ra,Ma,Oa,Va,Fa,Ha,Ua,Ga,Wa);const ii=()=>{const{injections:t}=Tt(),{theme:s}=Os(),[a,i]=r.useState("30"),[o,d]=r.useState(!1),c=s==="dark",u={primary:"#3b82f6",secondary:"#06b6d4",accent:"#8b5cf6",success:"#10b981",warning:"#f59e0b",text:c?"#e2e8f0":"#1f2937",textMuted:c?"#94a3b8":"#6b7280",grid:c?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.1)",background:"rgba(59, 130, 246, 0.1)"},g=r.useMemo(()=>{const x=nt(new Date,parseInt(a));return t.filter(m=>new Date(m.injection_date||m.date)>=x)},[t,a]),h=r.useMemo(()=>{const x=g.length,m=[...new Set(g.map(k=>k.peptide_name||k.peptide))],w=x/(parseInt(a)/7),l={};g.forEach(k=>{const B=k.peptide_name||k.peptide;l[B]=(l[B]||0)+1});const N=Object.entries(l).sort((k,B)=>B[1]-k[1])[0];return{total:x,uniquePeptides:m.length,avgPerWeek:w.toFixed(1),mostUsed:N?N[0]:"N/A"}},[g,a]),j=r.useMemo(()=>{const x=parseInt(a),m=[],w=[];for(let l=x-1;l>=0;l--){const N=nt(new Date,l),k=ve(N,"yyyy-MM-dd");m.push(ve(N,x>14?"MMM d":"EEE"));const B=g.filter(F=>ve(new Date(F.injection_date||F.date),"yyyy-MM-dd")===k).length;w.push(B)}return{labels:m,datasets:[{label:"Injections",data:w,fill:!0,borderColor:u.primary,backgroundColor:"rgba(59, 130, 246, 0.15)",tension:.4,pointRadius:x>14?0:4,pointHoverRadius:6,pointBackgroundColor:u.primary}]}},[g,a,u]),I=r.useMemo(()=>{const x={};g.forEach(l=>{const N=l.peptide_name||l.peptide;x[N]=(x[N]||0)+1});const m=Object.entries(x).sort((l,N)=>N[1]-l[1]).slice(0,6),w=[u.primary,u.secondary,u.accent,u.success,u.warning,"#ec4899"];return{labels:m.map(([l])=>l),datasets:[{data:m.map(([,l])=>l),backgroundColor:w.slice(0,m.length),borderWidth:0,hoverOffset:8}]}},[g,u]),D=r.useMemo(()=>{const x=[];for(let m=3;m>=0;m--){const w=Xa(nt(new Date,m*7)),l=Za(nt(new Date,m*7)),N=ve(w,"MMM d"),k=g.filter(B=>{const F=new Date(B.injection_date||B.date);return F>=w&&F<=l}).length;x.push({label:N,count:k})}return{labels:x.map(m=>m.label),datasets:[{label:"Weekly Injections",data:x.map(m=>m.count),backgroundColor:["rgba(59, 130, 246, 0.6)","rgba(59, 130, 246, 0.7)","rgba(59, 130, 246, 0.8)","rgba(59, 130, 246, 1)"],borderRadius:8,borderSkipped:!1}]}},[g]),z={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:c?"#1a1f35":"#fff",titleColor:u.text,bodyColor:u.textMuted,borderColor:u.grid,borderWidth:1,padding:12,cornerRadius:8}},scales:{x:{grid:{display:!1},ticks:{color:u.textMuted,maxTicksLimit:7}},y:{beginAtZero:!0,grid:{color:u.grid},ticks:{color:u.textMuted,stepSize:1}}}},p={responsive:!0,maintainAspectRatio:!1,cutout:"65%",plugins:{legend:{position:"bottom",labels:{color:u.textMuted,padding:16,usePointStyle:!0,pointStyle:"circle"}}}},C={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{grid:{display:!1},ticks:{color:u.textMuted}},y:{beginAtZero:!0,grid:{color:u.grid},ticks:{color:u.textMuted,stepSize:1}}}},y=[{value:"7",label:"Last 7 Days"},{value:"14",label:"Last 14 Days"},{value:"30",label:"Last 30 Days"},{value:"90",label:"Last 90 Days"}];return e.jsxs("div",{className:ie.container,children:[e.jsxs("div",{className:ie.header,children:[e.jsxs("h2",{className:ie.title,children:[e.jsx(it,{size:24}),"Progress Analytics"]}),e.jsxs("div",{className:ie.rangeSelector,children:[e.jsxs("button",{className:ie.rangeButton,onClick:()=>d(!o),children:[y.find(x=>x.value===a)?.label,e.jsx(pt,{size:16})]}),o&&e.jsx("div",{className:ie.dropdown,children:y.map(x=>e.jsx("button",{className:`${ie.dropdownItem} ${a===x.value?ie.active:""}`,onClick:()=>{i(x.value),d(!1)},children:x.label},x.value))})]})]}),e.jsxs("div",{className:ie.statsGrid,children:[e.jsxs("div",{className:ie.statCard,children:[e.jsx("div",{className:ie.statIcon,style:{background:"rgba(59, 130, 246, 0.15)",color:u.primary},children:e.jsx(Ee,{size:20})}),e.jsxs("div",{className:ie.statContent,children:[e.jsx("span",{className:ie.statValue,children:h.total}),e.jsx("span",{className:ie.statLabel,children:"Total Injections"})]})]}),e.jsxs("div",{className:ie.statCard,children:[e.jsx("div",{className:ie.statIcon,style:{background:"rgba(6, 182, 212, 0.15)",color:u.secondary},children:e.jsx(Nt,{size:20})}),e.jsxs("div",{className:ie.statContent,children:[e.jsx("span",{className:ie.statValue,children:h.uniquePeptides}),e.jsx("span",{className:ie.statLabel,children:"Peptides Used"})]})]}),e.jsxs("div",{className:ie.statCard,children:[e.jsx("div",{className:ie.statIcon,style:{background:"rgba(139, 92, 246, 0.15)",color:u.accent},children:e.jsx(Ce,{size:20})}),e.jsxs("div",{className:ie.statContent,children:[e.jsx("span",{className:ie.statValue,children:h.avgPerWeek}),e.jsx("span",{className:ie.statLabel,children:"Avg/Week"})]})]}),e.jsxs("div",{className:ie.statCard,children:[e.jsx("div",{className:ie.statIcon,style:{background:"rgba(16, 185, 129, 0.15)",color:u.success},children:e.jsx(it,{size:20})}),e.jsxs("div",{className:ie.statContent,children:[e.jsx("span",{className:ie.statValue,title:h.mostUsed,children:h.mostUsed.substring(0,12)}),e.jsx("span",{className:ie.statLabel,children:"Most Used"})]})]})]}),e.jsxs("div",{className:ie.chartsGrid,children:[e.jsxs("div",{className:ie.chartCard,children:[e.jsx("h3",{className:ie.chartTitle,children:"Injection Trend"}),e.jsx("div",{className:ie.chartContainer,children:e.jsx(qa,{data:j,options:z})})]}),e.jsxs("div",{className:ie.chartCard,children:[e.jsx("h3",{className:ie.chartTitle,children:"Peptide Distribution"}),e.jsx("div",{className:ie.chartContainer,children:I.labels.length>0?e.jsx(Ya,{data:I,options:p}):e.jsx("div",{className:ie.noData,children:"No data available"})})]}),e.jsxs("div",{className:ie.chartCard,children:[e.jsx("h3",{className:ie.chartTitle,children:"Weekly Comparison"}),e.jsx("div",{className:ie.chartContainer,children:e.jsx(Ja,{data:D,options:C})})]})]})]})},ri="_overlay_vreib_4",oi="_modal_vreib_28",ci="_progressBar_vreib_59",li="_progressFill_vreib_69",di="_header_vreib_77",mi="_skipButton_vreib_82",ui="_stepIndicators_vreib_105",hi="_stepDot_vreib_112",pi="_stepDotActive_vreib_126",gi="_stepDotComplete_vreib_132",xi="_content_vreib_137",_i="_stepContent_vreib_143",fi="_stepIcon_vreib_160",ji="_stepIconInner_vreib_182",yi="_stepTitle_vreib_188",vi="_stepSubtitle_vreib_198",bi="_featureList_vreib_206",wi="_featureItem_vreib_212",Si="_featureIcon_vreib_229",Ni="_featureContent_vreib_239",ki="_featureTitle_vreib_243",Ci="_featureDescription_vreib_250",Ii="_quickStartOptions_vreib_258",Di="_quickStartCard_vreib_264",Ti="_quickStartIcon_vreib_285",Li="_quickStartLabel_vreib_295",Bi="_quickStartHint_vreib_302",Ai="_tipBox_vreib_310",Pi="_tipIcon_vreib_321",Ei="_tipText_vreib_326",$i="_navigation_vreib_338",zi="_navButton_vreib_347",Ri="_navButtonSecondary_vreib_359",Mi="_navButtonPrimary_vreib_370",Oi="_navSpacer_vreib_388",Vi="_confetti_vreib_397",Fi="_sparkle_vreib_407",ae={overlay:ri,modal:oi,progressBar:ci,progressFill:li,header:di,skipButton:mi,stepIndicators:ui,stepDot:hi,stepDotActive:pi,stepDotComplete:gi,content:xi,stepContent:_i,stepIcon:fi,stepIconInner:ji,stepTitle:yi,stepSubtitle:vi,featureList:bi,featureItem:wi,featureIcon:Si,featureContent:Ni,featureTitle:ki,featureDescription:Ci,quickStartOptions:Ii,quickStartCard:Di,quickStartIcon:Ti,quickStartLabel:Li,quickStartHint:Bi,tipBox:Ai,tipIcon:Pi,tipText:Ei,navigation:$i,navButton:zi,navButtonSecondary:Ri,navButtonPrimary:Mi,navSpacer:Oi,confetti:Vi,sparkle:Fi},Hi=({onComplete:t,onSkip:s})=>{const[a,i]=r.useState(0),o=[{id:"welcome",icon:ua,iconBg:"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)",iconColor:"#ffffff",title:"Welcome to PeptideLog",subtitle:"Your all-in-one companion for tracking, calculating, and optimizing your peptide journey.",features:[{icon:Oe,color:"#10b981",bgColor:"rgba(16, 185, 129, 0.15)",title:"Track Every Dose",description:"Log injections with precision timing and dosage records"},{icon:Qt,color:"#3b82f6",bgColor:"rgba(59, 130, 246, 0.15)",title:"Calculate Reconstitution",description:"Never mess up your BAC water ratios again"},{icon:kt,color:"#8b5cf6",bgColor:"rgba(139, 92, 246, 0.15)",title:"Monitor Progress",description:"Visualize your journey with detailed analytics"}]},{id:"tools",icon:es,iconBg:"linear-gradient(135deg, #10b981 0%, #06b6d4 100%)",iconColor:"#ffffff",title:"Powerful Tools at Your Fingertips",subtitle:"Everything you need to manage your peptides like a pro.",features:[{icon:Ce,color:"#f59e0b",bgColor:"rgba(245, 158, 11, 0.15)",title:"Smart Scheduling",description:"Set reminders and never miss a dose with our calendar"},{icon:zt,color:"#06b6d4",bgColor:"rgba(6, 182, 212, 0.15)",title:"Price Comparison",description:"Find the best deals across multiple vendors"},{icon:wt,color:"#ec4899",bgColor:"rgba(236, 72, 153, 0.15)",title:"Peptide Encyclopedia",description:"Research 50+ peptides with detailed info"},{icon:Gt,color:"#f97316",bgColor:"rgba(249, 115, 22, 0.15)",title:"Inventory Management",description:"Track your stock and get expiration alerts"}],tip:{icon:ha,text:"All core features are <strong>completely free</strong>. No credit card required!"}},{id:"start",icon:Nt,iconBg:"linear-gradient(135deg, #f59e0b 0%, #ef4444 100%)",iconColor:"#ffffff",title:"You're All Set!",subtitle:"Choose how you want to get started:",celebration:!0,quickStart:[{to:"/log",icon:Oe,color:"#10b981",bgColor:"rgba(16, 185, 129, 0.15)",label:"Log First Injection",hint:"Start tracking now"},{to:"/calculator",icon:Qt,color:"#3b82f6",bgColor:"rgba(59, 130, 246, 0.15)",label:"Use Calculator",hint:"Reconstitute a peptide"},{to:"/encyclopedia",icon:wt,color:"#8b5cf6",bgColor:"rgba(139, 92, 246, 0.15)",label:"Browse Encyclopedia",hint:"Learn about peptides"},{to:"/price-checker",icon:zt,color:"#06b6d4",bgColor:"rgba(6, 182, 212, 0.15)",label:"Compare Prices",hint:"Find the best deals"}]}],d=o[a],c=a===o.length-1,u=a===0,g=(a+1)/o.length*100,h=r.useCallback(()=>{c?t?.():i(p=>p+1)},[c,t]),j=r.useCallback(()=>{u||i(p=>p-1)},[u]),I=r.useCallback(()=>{s?.()},[s]),D=r.useCallback(p=>{t?.()},[t]),z=r.useCallback(p=>{i(p)},[]);return e.jsx("div",{className:ae.overlay,children:e.jsxs("div",{className:ae.modal,children:[e.jsx("div",{className:ae.progressBar,children:e.jsx("div",{className:ae.progressFill,style:{width:`${g}%`}})}),e.jsxs("div",{className:ae.header,children:[e.jsxs("button",{className:ae.skipButton,onClick:I,"aria-label":"Skip onboarding",children:["Skip ",e.jsx(et,{size:14})]}),e.jsx("div",{className:ae.stepIndicators,children:o.map((p,C)=>e.jsx("button",{className:`${ae.stepDot} ${C===a?ae.stepDotActive:""} ${C<a?ae.stepDotComplete:""}`,onClick:()=>z(C),"aria-label":`Go to step ${C+1}`},p.id))})]}),e.jsx("div",{className:ae.content,children:e.jsxs("div",{className:ae.stepContent,children:[d.celebration&&e.jsxs("div",{className:ae.confetti,children:[e.jsx("span",{className:ae.sparkle}),e.jsx("span",{className:ae.sparkle}),e.jsx("span",{className:ae.sparkle}),e.jsx("span",{className:ae.sparkle}),e.jsx("span",{className:ae.sparkle})]}),e.jsx("div",{className:ae.stepIcon,style:{background:d.iconBg},children:e.jsx(d.icon,{size:36,color:d.iconColor,className:ae.stepIconInner})}),e.jsx("h2",{className:ae.stepTitle,children:d.title}),e.jsx("p",{className:ae.stepSubtitle,children:d.subtitle}),d.features&&e.jsx("div",{className:ae.featureList,children:d.features.map((p,C)=>e.jsxs("div",{className:ae.featureItem,children:[e.jsx("div",{className:ae.featureIcon,style:{background:p.bgColor,color:p.color},children:e.jsx(p.icon,{size:22})}),e.jsxs("div",{className:ae.featureContent,children:[e.jsx("h4",{className:ae.featureTitle,children:p.title}),e.jsx("p",{className:ae.featureDescription,children:p.description})]})]},C))}),d.quickStart&&e.jsx("div",{className:ae.quickStartOptions,children:d.quickStart.map((p,C)=>e.jsxs(pe,{to:p.to,className:ae.quickStartCard,onClick:()=>D(p.to),children:[e.jsx("div",{className:ae.quickStartIcon,style:{background:p.bgColor,color:p.color},children:e.jsx(p.icon,{size:28})}),e.jsx("span",{className:ae.quickStartLabel,children:p.label}),e.jsx("span",{className:ae.quickStartHint,children:p.hint})]},C))}),d.tip&&e.jsxs("div",{className:ae.tipBox,children:[e.jsx(d.tip.icon,{size:20,className:ae.tipIcon}),e.jsx("p",{className:ae.tipText,dangerouslySetInnerHTML:{__html:d.tip.text}})]})]},a)}),e.jsxs("div",{className:ae.navigation,children:[u?e.jsx("div",{className:ae.navSpacer}):e.jsxs("button",{className:`${ae.navButton} ${ae.navButtonSecondary}`,onClick:j,children:[e.jsx(is,{size:18}),"Back"]}),e.jsx("button",{className:`${ae.navButton} ${ae.navButtonPrimary}`,onClick:h,children:c?e.jsxs(e.Fragment,{children:[e.jsx(mt,{size:18}),"Get Started"]}):e.jsxs(e.Fragment,{children:["Next",e.jsx(gt,{size:18})]})})]})]})})},Ui="_container_xmaym_1",Gi="_header_xmaym_10",Wi="_welcomeSection_xmaym_19",qi="_userName_xmaym_27",Yi="_subtitle_xmaym_34",Ji="_primaryAction_xmaym_40",Xi="_statsGrid_xmaym_60",Zi="_statCard_xmaym_67",Ki="_statPrimary_xmaym_101",Qi="_statIcon_xmaym_106",er="_statInfo_xmaym_118",tr="_statValue_xmaym_125",sr="_statUnit_xmaym_135",ar="_statLabel_xmaym_141",nr="_mainGrid_xmaym_151",ir="_section_xmaym_159",rr="_sectionHeader_xmaym_172",or="_showMoreBtn_xmaym_193",cr="_viewAllBtn_xmaym_194",lr="_rotated_xmaym_213",dr="_actionsGrid_xmaym_218",mr="_actionCard_xmaym_224",ur="_actionPrimary_xmaym_259",hr="_actionIcon_xmaym_264",pr="_actionContent_xmaym_279",gr="_actionTitle_xmaym_284",xr="_actionDesc_xmaym_292",_r="_actionArrow_xmaym_297",fr="_premiumBadge_xmaym_308",jr="_activityList_xmaym_324",yr="_activityItem_xmaym_331",vr="_activityIcon_xmaym_348",br="_activityInfo_xmaym_360",wr="_activityTitle_xmaym_367",Sr="_activityMeta_xmaym_376",Nr="_emptyState_xmaym_382",kr="_emptyIcon_xmaym_394",Cr="_emptyAction_xmaym_404",Ir="_analyticsSection_xmaym_416",Dr="_mobileStats_xmaym_424",Tr="_guestCta_xmaym_429",Lr="_ctaContent_xmaym_441",Br="_ctaButton_xmaym_465",Ar="_mobileStatItem_xmaym_603",Pr="_mobileStatValue_xmaym_610",Er="_mobileStatLabel_xmaym_616",$r="_mobileStatDivider_xmaym_623",zr="_actionText_xmaym_629",U={container:Ui,header:Gi,welcomeSection:Wi,userName:qi,subtitle:Yi,primaryAction:Ji,statsGrid:Xi,statCard:Zi,statPrimary:Ki,statIcon:Qi,statInfo:er,statValue:tr,statUnit:sr,statLabel:ar,mainGrid:nr,section:ir,sectionHeader:rr,showMoreBtn:or,viewAllBtn:cr,rotated:lr,actionsGrid:dr,actionCard:mr,actionPrimary:ur,actionIcon:hr,actionContent:pr,actionTitle:gr,actionDesc:xr,actionArrow:_r,premiumBadge:fr,activityList:jr,activityItem:yr,activityIcon:vr,activityInfo:br,activityTitle:wr,activityMeta:Sr,emptyState:Nr,emptyIcon:kr,emptyAction:Cr,analyticsSection:Ir,mobileStats:Dr,guestCta:Tr,ctaContent:Lr,ctaButton:Br,mobileStatItem:Ar,mobileStatValue:Pr,mobileStatLabel:Er,mobileStatDivider:$r,actionText:zr},Rr=()=>{const{getStats:t,injections:s}=Tt(),{user:a}=Se(),{showOnboarding:i,completeOnboarding:o,skipOnboarding:d}=Mn(),[c,u]=r.useState(!1),g=r.useMemo(()=>t(),[t]),h=r.useMemo(()=>a?(a.user_metadata?.full_name||a.email||"User").split(" ")[0].split("@")[0]:"Guest",[a]),j=r.useMemo(()=>{if(!s||s.length===0)return{totalInjections:0,thisWeek:0,uniquePeptides:0,streak:0};const y=new Date,x=new Date(y.getTime()-10080*60*1e3),m=s.filter(k=>new Date(k.date)>=x).length,w=new Set(s.map(k=>k.peptide)).size;let l=0;const N=[...new Set(s.map(k=>new Date(k.date).toDateString()))].sort((k,B)=>new Date(B)-new Date(k));for(let k=0;k<N.length;k++){const B=new Date(y);if(B.setDate(B.getDate()-k),N.includes(B.toDateString()))l++;else break}return{totalInjections:s.length,thisWeek:m,uniquePeptides:w,streak:l}},[s]),I=r.useMemo(()=>!s||s.length===0?[]:s.slice(0,4).map(y=>({...y,timeAgo:D(new Date(y.date))})),[s]);function D(y){const x=Math.floor((new Date-y)/1e3);return x<60?"Just now":x<3600?`${Math.floor(x/60)}m ago`:x<86400?`${Math.floor(x/3600)}h ago`:x<604800?`${Math.floor(x/86400)}d ago`:y.toLocaleDateString()}const z=r.useMemo(()=>{const y=new Date().getHours();return y<12?"Good morning":y<18?"Good afternoon":"Good evening"},[]),p=[{to:"/log",icon:Oe,title:"Log Injection",desc:"Record a new dose",color:"#10b981",primary:!0},{to:"/calculator",icon:Ee,title:"Calculator",desc:"Reconstitute peptides",color:"#3b82f6"},{to:"/injection-sites",icon:Nt,title:"Injection Sites",desc:"Where to inject",color:"#8b5cf6"},{to:"/encyclopedia",icon:wt,title:"Encyclopedia",desc:"Learn about peptides",color:"#f59e0b"},{to:"/price-checker",icon:zt,title:"Price Checker",desc:"Compare prices",color:"#06b6d4"},{to:"/reviews",icon:xt,title:"Vendor Reviews",desc:"Community ratings",color:"#ec4899"},{to:"/inventory",icon:Gt,title:"Inventory",desc:"Manage your stock",color:"#14b8a6"},{to:"/blood-work",icon:kt,title:"Blood Work",desc:"Track lab results",color:"#6366f1",premium:!0},{to:"/titration",icon:es,title:"Titration Plan",desc:"Dose escalation",color:"#f97316",premium:!0}],C=c?p:p.slice(0,4);return e.jsxs("div",{className:U.container,children:[i&&e.jsx(Hi,{onComplete:o,onSkip:d}),e.jsxs("header",{className:U.header,children:[e.jsxs("div",{className:U.welcomeSection,children:[e.jsxs("h1",{children:[z,", ",e.jsx("span",{className:U.userName,children:h})]}),e.jsx("p",{className:U.subtitle,children:"Here's your peptide journey at a glance"})]}),a&&e.jsxs(pe,{to:"/tracker",className:U.primaryAction,children:[e.jsx(Ke,{size:20}),e.jsx("span",{className:U.actionText,children:"Log Injection"})]})]}),e.jsxs("div",{className:U.statsGrid,children:[e.jsxs("div",{className:`${U.statCard} ${U.statPrimary}`,children:[e.jsx("div",{className:U.statIcon,children:e.jsx(pa,{size:24})}),e.jsxs("div",{className:U.statInfo,children:[e.jsxs("span",{className:U.statValue,children:[g?g.activeLevel:"0.00",e.jsx("span",{className:U.statUnit,children:"mg"})]}),e.jsx("span",{className:U.statLabel,children:"Est. Active Level"})]})]}),e.jsxs("div",{className:U.statCard,children:[e.jsx("div",{className:U.statIcon,style:{background:"rgba(236, 72, 153, 0.15)",color:"#ec4899"},children:e.jsx(ze,{size:24})}),e.jsxs("div",{className:U.statInfo,children:[e.jsx("span",{className:U.statValue,children:g?.lastInjection?new Date(g.lastInjection.date).toLocaleDateString(void 0,{month:"short",day:"numeric"}):"--"}),e.jsx("span",{className:U.statLabel,children:g?.lastInjection?.peptide||"Last Injection"})]})]}),e.jsxs("div",{className:U.statCard,children:[e.jsx("div",{className:U.statIcon,style:{background:"rgba(16, 185, 129, 0.15)",color:"#10b981"},children:e.jsx(kt,{size:24})}),e.jsxs("div",{className:U.statInfo,children:[e.jsx("span",{className:U.statValue,children:j.thisWeek}),e.jsx("span",{className:U.statLabel,children:"This Week"})]})]}),e.jsxs("div",{className:U.statCard,children:[e.jsx("div",{className:U.statIcon,style:{background:"rgba(245, 158, 11, 0.15)",color:"#f59e0b"},children:e.jsx(Nt,{size:24})}),e.jsxs("div",{className:U.statInfo,children:[e.jsxs("span",{className:U.statValue,children:[j.streak,e.jsx("span",{className:U.statUnit,children:"days"})]}),e.jsx("span",{className:U.statLabel,children:"Current Streak"})]})]})]}),e.jsxs("div",{className:U.mainGrid,children:[e.jsxs("section",{className:U.section,children:[e.jsxs("div",{className:U.sectionHeader,children:[e.jsxs("h2",{children:[e.jsx(es,{size:20})," Quick Actions"]}),p.length>4&&e.jsxs("button",{className:U.showMoreBtn,onClick:()=>u(!c),children:[c?"Show Less":"Show All",e.jsx(gt,{size:16,className:c?U.rotated:""})]})]}),e.jsx("div",{className:U.actionsGrid,children:C.map((y,x)=>e.jsxs(pe,{to:y.to,className:`${U.actionCard} ${y.primary?U.actionPrimary:""}`,style:{"--action-color":y.color},children:[y.premium&&e.jsx("span",{className:U.premiumBadge,children:"PRO"}),e.jsx("div",{className:U.actionIcon,style:{background:`${y.color}15`,color:y.color},children:e.jsx(y.icon,{size:24})}),e.jsxs("div",{className:U.actionContent,children:[e.jsx("span",{className:U.actionTitle,children:y.title}),e.jsx("span",{className:U.actionDesc,children:y.desc})]}),e.jsx(Ts,{size:18,className:U.actionArrow})]},y.to))})]}),e.jsxs("section",{className:U.section,children:[e.jsxs("div",{className:U.sectionHeader,children:[e.jsxs("h2",{children:[e.jsx(ga,{size:20})," Recent Activity"]}),I.length>0&&e.jsxs(pe,{to:"/log",className:U.viewAllBtn,children:["View All ",e.jsx(gt,{size:16})]})]}),I.length>0?e.jsx("div",{className:U.activityList,children:I.map((y,x)=>e.jsxs("div",{className:U.activityItem,children:[e.jsx("div",{className:U.activityIcon,children:e.jsx(xa,{size:16})}),e.jsxs("div",{className:U.activityInfo,children:[e.jsx("span",{className:U.activityTitle,children:y.peptide}),e.jsxs("span",{className:U.activityMeta,children:[y.dosage,y.unit," • ",y.timeAgo]})]})]},y.id||x))}):e.jsxs("div",{className:U.emptyState,children:[e.jsx(Oe,{size:32,className:U.emptyIcon}),e.jsx("p",{children:"No injections logged yet"}),e.jsx(pe,{to:"/log",className:U.emptyAction,children:"Log your first injection"})]})]})]}),a&&e.jsx("section",{className:U.analyticsSection,children:e.jsx(ii,{})}),e.jsxs("div",{className:U.mobileStats,children:[e.jsxs("div",{className:U.mobileStatItem,children:[e.jsx("span",{className:U.mobileStatValue,children:j.totalInjections}),e.jsx("span",{className:U.mobileStatLabel,children:"Total"})]}),e.jsx("div",{className:U.mobileStatDivider}),e.jsxs("div",{className:U.mobileStatItem,children:[e.jsx("span",{className:U.mobileStatValue,children:j.uniquePeptides}),e.jsx("span",{className:U.mobileStatLabel,children:"Peptides"})]}),e.jsx("div",{className:U.mobileStatDivider}),e.jsxs("div",{className:U.mobileStatItem,children:[e.jsx("span",{className:U.mobileStatValue,children:j.thisWeek}),e.jsx("span",{className:U.mobileStatLabel,children:"This Week"})]})]}),!a&&e.jsxs("div",{className:U.guestCta,children:[e.jsxs("div",{className:U.ctaContent,children:[e.jsx(Ve,{size:24}),e.jsxs("div",{children:[e.jsx("h3",{children:"Track Your Progress"}),e.jsx("p",{children:"Sign in to save your injections and access all features"})]})]}),e.jsx(pe,{to:"/login",className:U.ctaButton,children:"Sign In"})]})]})};class Mr{constructor(){this.scheduledNotifications=new Map}isSupported(){return"Notification"in window}async requestPermission(){return this.isSupported()?await Notification.requestPermission()==="granted":(console.log("This browser does not support desktop notification"),!1)}getPermission(){return this.isSupported()?Notification.permission:"unsupported"}sendNotification(s,a={}){if(Notification.permission==="granted"){const i=new Notification(s,{icon:"/pwa-192x192.png",badge:"/pwa-192x192.png",vibrate:[100,50,100],...a});return i.onclick=function(){window.focus(),i.close(),a.onClick&&a.onClick()},i}return null}scheduleNotification(s,a,i,o={}){this.cancelNotification(s);const d=new Date,u=new Date(a).getTime()-d.getTime();if(u<=0)return!1;const g=setTimeout(()=>{this.sendNotification(i,o),this.scheduledNotifications.delete(s)},u);return this.scheduledNotifications.set(s,g),!0}scheduleNotificationDelay(s,a,i){setTimeout(()=>{this.sendNotification(s,a)},i)}cancelNotification(s){return this.scheduledNotifications.has(s)?(clearTimeout(this.scheduledNotifications.get(s)),this.scheduledNotifications.delete(s),!0):!1}cancelAllNotifications(){this.scheduledNotifications.forEach(s=>{clearTimeout(s)}),this.scheduledNotifications.clear()}scheduleReminders(s,a=30){this.cancelAllNotifications();const i=new Date;let o=0;return s.forEach(d=>{if(d.completed)return;let c;if(d.scheduled_date&&d.scheduled_time)c=new Date(`${d.scheduled_date}T${d.scheduled_time}`);else if(d.date)c=new Date(d.date);else return;const u=new Date(c.getTime()-a*60*1e3);if(u>i){const g=d.peptide_name||d.peptide||"your peptide",h=d.dosage||"",j=d.unit||"mg";this.scheduleNotification(`reminder-${d.id}`,u,"⏰ Dose Reminder",{body:`Time to take ${g} (${h}${j}) in ${a} minutes`,tag:`dose-reminder-${d.id}`}),o++}if(c>i){const g=d.peptide_name||d.peptide||"your peptide",h=d.dosage||"",j=d.unit||"mg";this.scheduleNotification(`dose-${d.id}`,c,"💉 Time for your dose!",{body:`Take ${g} - ${h}${j}`,tag:`dose-${d.id}`,requireInteraction:!0}),o++}}),o}sendLowStockAlert(s,a,i="mg"){return this.sendNotification("⚠️ Low Stock Alert",{body:`${s} is running low (${a}${i} remaining)`,tag:`low-stock-${s}`,requireInteraction:!0})}}const qe=new Mr,as={requestPermission:()=>qe.requestPermission(),sendNotification:(t,s)=>qe.sendNotification(t,s),scheduleNotification:(t,s,a)=>qe.scheduleNotificationDelay(t,s,a),scheduleReminders:(t,s)=>qe.scheduleReminders(t,s),cancelAllNotifications:()=>qe.cancelAllNotifications(),sendLowStockAlert:(t,s,a)=>qe.sendLowStockAlert(t,s,a),getPermission:()=>qe.getPermission(),isSupported:()=>qe.isSupported()},js="peptide_tracker_schedule",Kt="peptide_tracker_templates",Or=()=>{const[t,s]=r.useState([]),[a,i]=r.useState([]),[o,d]=r.useState(!0),{user:c}=Se();r.useEffect(()=>{c?(j().then(l=>{l&&ht.isNative&&u(l)}),I()):g()},[c]);const u=l=>{!ht.isNative||!l||l.length===0||(console.log("Syncing mobile notifications for",l.length,"schedules"),at.getPending().then(N=>{const k=N.map(B=>B.id);k.length>0&&at.cancel(k),l.forEach(B=>{if(B.completed)return;const F=new Date(B.date);F>new Date&&at.scheduleInjectionReminder({id:parseInt(B.id.toString().replace(/\D/g,"").slice(-8))||Math.floor(Math.random()*1e5),title:"Time for your dose!",body:`Take ${B.peptide} (${B.dosage}${B.unit})`,scheduledAt:F})})}))};r.useEffect(()=>{t.length>0&&(ht.isNative?at.getPending().then(l=>{const N=l.map(k=>k.id);N.length>0&&at.cancel(N),t.forEach(k=>{if(k.completed)return;const B=new Date(k.date);B>new Date&&at.scheduleInjectionReminder({id:parseInt(k.id.toString().replace(/\D/g,"").slice(-8))||Math.floor(Math.random()*1e5),title:"Time for your dose!",body:`Take ${k.peptide} (${k.dosage}${k.unit})`,scheduledAt:B})})}):as.scheduleReminders(t))},[t]);const g=()=>{try{const l=localStorage.getItem(js),N=localStorage.getItem(Kt);l&&s(JSON.parse(l)),N&&i(JSON.parse(N))}catch(l){console.error("Error loading from localStorage:",l)}d(!1)},h=(l,N=js)=>{try{localStorage.setItem(N,JSON.stringify(l))}catch(k){console.error("Error saving to localStorage:",k)}},j=async()=>{try{d(!0);const{data:l,error:N}=await S.from("schedules").select("*").order("scheduled_date",{ascending:!0});if(N)throw N;const k=l.map(B=>({id:B.id,date:new Date(`${B.scheduled_date}T${B.scheduled_time}`).toISOString(),peptide:B.peptide_name,dosage:B.dosage,unit:B.unit,time:B.scheduled_time?.slice(0,5)||"08:00",completed:B.completed,notes:B.notes,isRecurring:B.is_recurring||!1,parentTemplateId:B.parent_schedule_id}));return s(k),k}catch(l){return console.error("Error fetching schedules:",l),g(),[]}finally{d(!1)}},I=async()=>{try{const{data:l,error:N}=await S.from("schedule_templates").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(N)throw N;const k=l.map(B=>({id:B.id,name:B.name,peptide:B.peptide_name,dosage:B.dosage,unit:B.unit,time:B.time?.slice(0,5)||"08:00",recurrenceDays:B.recurrence_days||[],isActive:B.is_active,notes:B.notes}));i(k)}catch(l){console.error("Error fetching templates:",l)}},D=async l=>{const N={id:"temp-"+Date.now(),completed:!1,...l},k=[...t,N];if(s(k),c)try{const B=new Date(l.date),{data:F,error:A}=await S.from("schedules").insert([{user_id:c.id,peptide_name:l.peptide,dosage:l.dosage,unit:l.unit,scheduled_date:B.toISOString().split("T")[0],scheduled_time:l.time+":00",completed:!1,notes:l.notes||null,is_recurring:!1}]).select().single();if(A)throw A;s(T=>T.map(K=>K.id===N.id?{...K,id:F.id}:K))}catch(B){console.error("Error adding schedule:",B),j()}else h(k)},z=async(l,N,k)=>{const{peptide:B,dosage:F,unit:A,time:T,recurrenceDays:K,notes:X,name:n}=l,H=xs({start:N,end:k}).filter(V=>K.includes(_s(V))).map(V=>{const v=new Date(V.getFullYear(),V.getMonth(),V.getDate(),12,0,0);return{id:"temp-"+Date.now()+"-"+V.getTime(),date:v.toISOString(),peptide:B,dosage:F,unit:A,time:T,completed:!1,notes:X,isRecurring:!0}});if(s(V=>[...V,...H]),c)try{const{data:V,error:v}=await S.from("schedule_templates").insert([{user_id:c.id,name:n||`${B} Protocol`,peptide_name:B,dosage:F,unit:A,time:T+":00",recurrence_days:K,is_active:!0,notes:X}]).select().single();if(v)throw v;const G=H.map(J=>({user_id:c.id,peptide_name:J.peptide,dosage:J.dosage,unit:J.unit,scheduled_date:new Date(J.date).toISOString().split("T")[0],scheduled_time:J.time+":00",completed:!1,notes:J.notes,is_recurring:!0,parent_schedule_id:V.id})),{error:P}=await S.from("schedules").insert(G);if(P)throw P;return await j(),await I(),V}catch(V){return console.error("Error creating recurring schedule:",V),j(),null}else{h([...t,...H]);const V={id:"local-"+Date.now(),name:n||`${B} Protocol`,peptide:B,dosage:F,unit:A,time:T,recurrenceDays:K,isActive:!0,notes:X},v=[...a,V];return i(v),h(v,Kt),V}},p=async(l,N=!1)=>{if(c)try{N&&await S.from("schedules").delete().eq("parent_schedule_id",l);const{error:k}=await S.from("schedule_templates").delete().eq("id",l);if(k)throw k;await I(),N&&await j()}catch(k){console.error("Error deleting template:",k)}else{const k=a.filter(B=>B.id!==l);if(i(k),h(k,Kt),N){const B=t.filter(F=>F.parentTemplateId!==l);s(B),h(B)}}},C=async(l,N=28)=>{const k=a.find(n=>n.id===l);if(!k)return;const F=t.filter(n=>n.parentTemplateId===l).reduce((n,L)=>{const H=new Date(L.date);return H>n?H:n},new Date),A=Xt(F,1),T=Xt(A,N),X=xs({start:A,end:T}).filter(n=>k.recurrenceDays.includes(_s(n))).map(n=>{const L=new Date(n.getFullYear(),n.getMonth(),n.getDate(),12,0,0);return{id:"temp-"+Date.now()+"-"+n.getTime(),date:L.toISOString(),peptide:k.peptide,dosage:k.dosage,unit:k.unit,time:k.time,completed:!1,notes:k.notes,isRecurring:!0,parentTemplateId:l}});if(s(n=>[...n,...X]),c)try{const n=X.map(L=>({user_id:c.id,peptide_name:L.peptide,dosage:L.dosage,unit:L.unit,scheduled_date:new Date(L.date).toISOString().split("T")[0],scheduled_time:L.time+":00",completed:!1,notes:L.notes,is_recurring:!0,parent_schedule_id:l}));await S.from("schedules").insert(n),await j()}catch(n){console.error("Error extending schedule:",n),j()}else h([...t,...X])},y=async l=>{const N=t.filter(k=>k.id!==l);if(s(N),c)try{const{error:k}=await S.from("schedules").delete().eq("id",l);if(k)throw k}catch(k){console.error("Error deleting schedule:",k),j()}else h(N)},x=async l=>{const N=t.find(F=>F.id===l);if(!N)return;const k=!N.completed,B=t.map(F=>F.id===l?{...F,completed:k}:F);if(s(B),c)try{const{error:F}=await S.from("schedules").update({completed:k}).eq("id",l);if(F)throw F}catch(F){console.error("Error toggling schedule:",F),j()}else h(B)},m=r.useCallback((l=7)=>{const N=Ka(new Date),k=Xt(N,l);return t.filter(B=>{const F=new Date(B.date);return(Qa(F,N)||en(F,N))&&tn(F,k)}).sort((B,F)=>new Date(B.date)-new Date(F.date))},[t]),w=r.useCallback(()=>{const l={};return t.forEach(N=>{l[N.peptide]||(l[N.peptide]=[]),l[N.peptide].push(N)}),l},[t]);return{schedules:t,templates:a,loading:o,addSchedule:D,createRecurringSchedule:z,deleteTemplate:p,extendRecurringSchedule:C,deleteSchedule:y,toggleComplete:x,getUpcomingSchedules:m,getSchedulesByPeptide:w,refreshSchedules:j,refreshTemplates:I}},Vr=()=>{const[t,s]=r.useState([]),[a,i]=r.useState(!0),[o,d]=r.useState(null);return r.useEffect(()=>{(async()=>{try{const{data:h,error:j}=await S.from("peptides").select("*").order("name");if(j)throw j;const I=(h||[]).map(D=>({...D,halfLife:D.half_life_hours?`${D.half_life_hours} hours`:"Unknown",sideEffects:D.side_effects||[],commonDosage:D.common_dosage||"Consult protocol",researchLinks:D.research_links||[],protocols:D.dosage_protocols||[]}));s(I)}catch(h){console.error("Error fetching peptides:",h),d(h.message)}finally{i(!1)}})()},[]),{peptides:t,loading:a,error:o,getPeptideByName:g=>g?t.find(h=>h.name.toLowerCase()===g.toLowerCase()):null,getPeptidesByCategory:g=>t.filter(h=>h.category===g)}},Fr="_container_ow5v7_1",Hr="_loadingState_ow5v7_23",Ur="_spinner_ow5v7_33",Gr="_pageHeader_ow5v7_48",Wr="_headerLeft_ow5v7_55",qr="_headerIcon_ow5v7_61",Yr="_headerRight_ow5v7_81",Jr="_guestBadge_ow5v7_87",Xr="_statsGrid_ow5v7_101",Zr="_statCard_ow5v7_114",Kr="_statIcon_ow5v7_124",Qr="_statContent_ow5v7_134",eo="_statValue_ow5v7_139",to="_statLabel_ow5v7_146",so="_viewTabs_ow5v7_154",ao="_viewTab_ow5v7_154",no="_activeTab_ow5v7_184",io="_badge_ow5v7_189",ro="_errorBanner_ow5v7_198",oo="_calendarCard_ow5v7_211",co="_calendarHeader_ow5v7_215",lo="_monthDisplay_ow5v7_222",mo="_todayBtn_ow5v7_236",uo="_navBtn_ow5v7_252",ho="_grid_ow5v7_272",po="_dayHeader_ow5v7_278",go="_day_ow5v7_278",xo="_selected_ow5v7_308",_o="_today_ow5v7_236",fo="_dayNumber_ow5v7_314",jo="_dimmed_ow5v7_325",yo="_dots_ow5v7_334",vo="_dot_ow5v7_334",bo="_injectionDot_ow5v7_349",wo="_scheduleDot_ow5v7_353",So="_completedDot_ow5v7_357",No="_moreCount_ow5v7_362",ko="_detailsSection_ow5v7_369",Co="_detailsHeader_ow5v7_373",Io="_todayLabel_ow5v7_391",Do="_actionButtons_ow5v7_402",To="_addBtn_ow5v7_407",Lo="_addBtnPrimary_ow5v7_421",Bo="_addBtnSecondary_ow5v7_431",Ao="_addBtnTertiary_ow5v7_441",Po="_form_ow5v7_452",Eo="_formHeader_ow5v7_475",$o="_closeBtn_ow5v7_488",zo="_inputGroup_ow5v7_504",Ro="_formRow_ow5v7_533",Mo="_autocompleteWrapper_ow5v7_550",Oo="_chevron_ow5v7_554",Vo="_chevronUp_ow5v7_564",Fo="_autocomplete_ow5v7_550",Ho="_autocompleteItem_ow5v7_582",Uo="_siteButtons_ow5v7_603",Go="_siteButton_ow5v7_603",Wo="_siteActive_ow5v7_624",qo="_formSection_ow5v7_631",Yo="_quickProtocols_ow5v7_644",Jo="_quickProtocolBtn_ow5v7_656",Xo="_quickProtocolActive_ow5v7_677",Zo="_protocolEmoji_ow5v7_683",Ko="_daysSelector_ow5v7_688",Qo="_dayBtn_ow5v7_694",ec="_dayBtnActive_ow5v7_714",tc="_dayShort_ow5v7_720",sc="_dayLabel_ow5v7_725",ac="_submitBtn_ow5v7_733",nc="_dayItems_ow5v7_757",ic="_itemSection_ow5v7_763",rc="_sectionLabel_ow5v7_769",oc="_scheduleItem_ow5v7_782",cc="_completedSchedule_ow5v7_797",lc="_completeBtn_ow5v7_803",dc="_injectionItem_ow5v7_819",mc="_completedIcon_ow5v7_834",uc="_itemInfo_ow5v7_839",hc="_itemPeptide_ow5v7_847",pc="_itemDetails_ow5v7_852",gc="_recurringIcon_ow5v7_860",xc="_itemNotes_ow5v7_864",_c="_itemActions_ow5v7_870",fc="_editBtn_ow5v7_888",jc="_deleteBtn_ow5v7_889",yc="_confirmDelete_ow5v7_913",vc="_emptyState_ow5v7_919",bc="_emptyIcon_ow5v7_929",wc="_upcomingSection_ow5v7_947",Sc="_upcomingHeader_ow5v7_951",Nc="_upcomingList_ow5v7_970",kc="_upcomingItem_ow5v7_976",Cc="_todayItem_ow5v7_991",Ic="_completedItem_ow5v7_996",Dc="_upcomingDate_ow5v7_1000",Tc="_upcomingDay_ow5v7_1010",Lc="_upcomingMonth_ow5v7_1017",Bc="_upcomingInfo_ow5v7_1023",Ac="_upcomingPeptide_ow5v7_1030",Pc="_upcomingDetails_ow5v7_1035",Ec="_quickCompleteBtn_ow5v7_1043",$c="_completedBadge_ow5v7_1063",zc="_templatesSection_ow5v7_1076",Rc="_templatesList_ow5v7_1092",Mc="_templateItem_ow5v7_1098",Oc="_templateInfo_ow5v7_1108",Vc="_templateName_ow5v7_1115",Fc="_templateDetails_ow5v7_1120",f={container:Fr,loadingState:Hr,spinner:Ur,pageHeader:Gr,headerLeft:Wr,headerIcon:qr,headerRight:Yr,guestBadge:Jr,statsGrid:Xr,statCard:Zr,statIcon:Kr,statContent:Qr,statValue:eo,statLabel:to,viewTabs:so,viewTab:ao,activeTab:no,badge:io,errorBanner:ro,calendarCard:oo,calendarHeader:co,monthDisplay:lo,todayBtn:mo,navBtn:uo,grid:ho,dayHeader:po,day:go,selected:xo,today:_o,dayNumber:fo,dimmed:jo,dots:yo,dot:vo,injectionDot:bo,scheduleDot:wo,completedDot:So,moreCount:No,detailsSection:ko,detailsHeader:Co,todayLabel:Io,actionButtons:Do,addBtn:To,addBtnPrimary:Lo,addBtnSecondary:Bo,addBtnTertiary:Ao,form:Po,formHeader:Eo,closeBtn:$o,inputGroup:zo,formRow:Ro,autocompleteWrapper:Mo,chevron:Oo,chevronUp:Vo,autocomplete:Fo,autocompleteItem:Ho,siteButtons:Uo,siteButton:Go,siteActive:Wo,formSection:qo,quickProtocols:Yo,quickProtocolBtn:Jo,quickProtocolActive:Xo,protocolEmoji:Zo,daysSelector:Ko,dayBtn:Qo,dayBtnActive:ec,dayShort:tc,dayLabel:sc,submitBtn:ac,dayItems:nc,itemSection:ic,sectionLabel:rc,scheduleItem:oc,completedSchedule:cc,completeBtn:lc,injectionItem:dc,completedIcon:mc,itemInfo:uc,itemPeptide:hc,itemDetails:pc,recurringIcon:gc,itemNotes:xc,itemActions:_c,editBtn:fc,deleteBtn:jc,confirmDelete:yc,emptyState:vc,emptyIcon:bc,upcomingSection:wc,upcomingHeader:Sc,upcomingList:Nc,upcomingItem:kc,todayItem:Cc,completedItem:Ic,upcomingDate:Dc,upcomingDay:Tc,upcomingMonth:Lc,upcomingInfo:Bc,upcomingPeptide:Ac,upcomingDetails:Pc,quickCompleteBtn:Ec,completedBadge:$c,templatesSection:zc,templatesList:Rc,templateItem:Mc,templateInfo:Oc,templateName:Vc,templateDetails:Fc},ys=[{value:0,label:"Sun",short:"S"},{value:1,label:"Mon",short:"M"},{value:2,label:"Tue",short:"T"},{value:3,label:"Wed",short:"W"},{value:4,label:"Thu",short:"T"},{value:5,label:"Fri",short:"F"},{value:6,label:"Sat",short:"S"}],Hc=[{id:"daily",label:"Every Day",days:[0,1,2,3,4,5,6],icon:"📅"},{id:"eod",label:"Every Other Day",days:[1,3,5],icon:"🔄"},{id:"mwf",label:"Mon/Wed/Fri",days:[1,3,5],icon:"💪"},{id:"weekdays",label:"Weekdays",days:[1,2,3,4,5],icon:"📆"},{id:"weekends",label:"Weekends",days:[0,6],icon:"🌴"},{id:"once",label:"Once Weekly",days:[],icon:"1️⃣"}],Uc=()=>{const{injections:t,loading:s,error:a,addInjection:i,updateInjection:o,deleteInjection:d,getStats:c,isUsingLocalStorage:u}=Tt(),{peptides:g}=Vr(),{schedules:h,templates:j,loading:I,addSchedule:D,createRecurringSchedule:z,deleteSchedule:p,toggleComplete:C,deleteTemplate:y,getUpcomingSchedules:x}=Or(),[m,w]=r.useState(new Date),[l,N]=r.useState(new Date),[k,B]=r.useState("calendar"),[F,A]=r.useState(!1),[T,K]=r.useState("log"),[X,n]=r.useState(null),[L,H]=r.useState(!1),[V,v]=r.useState(null),G=r.useRef(null),[P,J]=r.useState({peptide:"",dosage:"",unit:"mg",site:"Abdomen",time:"08:00",notes:"",date:new Date().toISOString().slice(0,16),recurrenceDays:[],duration:28}),ge=s||I,_e=r.useMemo(()=>c(),[c]),ye=m.getFullYear(),be=m.getMonth(),b=r.useMemo(()=>{const _=new Date(ye,be,1),se=new Date(ye,be+1,0),he=[];for(let we=0;we<_.getDay();we++){const yt=new Date(ye,be,-we);he.unshift({date:yt,dimmed:!0})}for(let we=1;we<=se.getDate();we++)he.push({date:new Date(ye,be,we),dimmed:!1});const jt=42-he.length;for(let we=1;we<=jt;we++)he.push({date:new Date(ye,be+1,we),dimmed:!0});return he},[ye,be]),$=r.useCallback(_=>{const se=_.toDateString(),he=t.filter(we=>new Date(we.date).toDateString()===se),jt=h.filter(we=>new Date(we.date).toDateString()===se);return{injections:he,schedules:jt}},[t,h]),xe=r.useMemo(()=>{if(!P.peptide)return g.map(se=>se.name).slice(0,8);const _=P.peptide.toLowerCase();return g.filter(se=>se.name.toLowerCase().includes(_)).map(se=>se.name).slice(0,8)},[P.peptide,g]);r.useEffect(()=>{const _=se=>{G.current&&!G.current.contains(se.target)&&H(!1)};return document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)},[]);const re=()=>w(new Date(ye,be+1,1)),Ue=()=>w(new Date(ye,be-1,1)),Re=()=>{w(new Date),N(new Date)},O=_=>{N(_.date)},ue=_=>{const se=new Date;return _.toDateString()===se.toDateString()},$e=_=>_.toDateString()===l.toDateString(),Lt=_=>{const se=new Date;return se.setHours(0,0,0,0),_<se},Ge=()=>{J({peptide:"",dosage:"",unit:"mg",site:"Abdomen",time:"08:00",notes:"",date:l.toISOString().slice(0,16),recurrenceDays:[],duration:28}),n(null),K("log")},Yt=(_=null)=>{Ge(),J(_?se=>({...se,peptide:_.peptide,dosage:_.dosage?.toString()||"",unit:_.unit||"mg",date:new Date().toISOString().slice(0,16)}):se=>({...se,date:l.toISOString().slice(0,16)})),K("log"),A(!0)},Vs=()=>{Ge(),K("schedule"),A(!0)},ds=()=>{Ge(),K("recurring"),A(!0),B("calendar")},Fs=_=>{J(se=>({...se,recurrenceDays:se.recurrenceDays.includes(_)?se.recurrenceDays.filter(he=>he!==_):[...se.recurrenceDays,_].sort()}))},Hs=_=>{J(se=>({...se,recurrenceDays:_.days}))},Us=_=>{J(se=>({...se,peptide:_})),H(!1)},Gs=async _=>{if(_.preventDefault(),!(!P.peptide||!P.dosage)){if(T==="log"){const se={peptide:P.peptide,dosage:parseFloat(P.dosage),unit:P.unit,site:P.site,notes:P.notes||"",date:new Date(P.date).toISOString()};X?await o(X,se):await i(se)}else if(T==="schedule")await D({date:l.toISOString(),peptide:P.peptide,dosage:parseFloat(P.dosage),unit:P.unit,time:P.time,notes:P.notes});else if(T==="recurring"){if(P.recurrenceDays.length===0)return;const se=new Date;se.setHours(0,0,0,0);const he=new Date;he.setDate(he.getDate()+P.duration),he.setHours(23,59,59,999),await z({peptide:P.peptide,dosage:parseFloat(P.dosage),unit:P.unit,time:P.time,recurrenceDays:P.recurrenceDays,notes:P.notes},se,he)}Ge(),A(!1)}},ms=async _=>{await C(_.id),await i({peptide:_.peptide,dosage:_.dosage,unit:_.unit,site:"Abdomen",notes:"Completed from schedule",date:new Date().toISOString()})},Ws=_=>{J({peptide:_.peptide,dosage:_.dosage.toString(),unit:_.unit,site:_.site||"Abdomen",time:"08:00",notes:_.notes||"",date:new Date(_.date).toISOString().slice(0,16),recurrenceDays:[],duration:28}),n(_.id),K("log"),A(!0)},qs=async _=>{V===_?(await d(_),v(null)):(v(_),setTimeout(()=>v(null),3e3))},Ys=_=>new Date(_).toLocaleTimeString(void 0,{hour:"numeric",minute:"2-digit"}),We=r.useMemo(()=>$(l),[l,$]),Bt=r.useMemo(()=>x(7),[x]);return ge?e.jsxs("div",{className:f.loadingState,children:[e.jsx(_a,{size:32,className:f.spinner}),e.jsx("p",{children:"Loading your injection log..."})]}):e.jsxs("div",{className:f.container,children:[e.jsxs("div",{className:f.pageHeader,children:[e.jsxs("div",{className:f.headerLeft,children:[e.jsx(Oe,{size:28,className:f.headerIcon}),e.jsxs("div",{children:[e.jsx("h1",{children:"Injection Log"}),e.jsx("p",{children:"Track & schedule your peptide protocol"})]})]}),e.jsx("div",{className:f.headerRight,children:u&&e.jsxs("span",{className:f.guestBadge,children:[e.jsx(fa,{size:14}),"Guest Mode"]})})]}),_e&&e.jsxs("div",{className:f.statsGrid,children:[e.jsxs("div",{className:f.statCard,children:[e.jsx("div",{className:f.statIcon,style:{background:"rgba(16, 185, 129, 0.15)"},children:e.jsx(Ee,{size:18,color:"#10b981"})}),e.jsxs("div",{className:f.statContent,children:[e.jsx("span",{className:f.statValue,children:_e.activeLevel}),e.jsx("span",{className:f.statLabel,children:"mg active"})]})]}),e.jsxs("div",{className:f.statCard,children:[e.jsx("div",{className:f.statIcon,style:{background:"rgba(59, 130, 246, 0.15)"},children:e.jsx(it,{size:18,color:"#3b82f6"})}),e.jsxs("div",{className:f.statContent,children:[e.jsx("span",{className:f.statValue,children:_e.weeklyCount}),e.jsx("span",{className:f.statLabel,children:"this week"})]})]}),e.jsxs("div",{className:f.statCard,children:[e.jsx("div",{className:f.statIcon,style:{background:"rgba(139, 92, 246, 0.15)"},children:e.jsx(Oe,{size:18,color:"#8b5cf6"})}),e.jsxs("div",{className:f.statContent,children:[e.jsx("span",{className:f.statValue,children:_e.totalInjections}),e.jsx("span",{className:f.statLabel,children:"total"})]})]})]}),e.jsxs("div",{className:f.viewTabs,children:[e.jsxs("button",{className:`${f.viewTab} ${k==="calendar"?f.activeTab:""}`,onClick:()=>B("calendar"),children:[e.jsx(Ce,{size:18}),"Calendar"]}),e.jsxs("button",{className:`${f.viewTab} ${k==="schedule"?f.activeTab:""}`,onClick:()=>B("schedule"),children:[e.jsx(lt,{size:18}),"Upcoming",Bt.length>0&&e.jsx("span",{className:f.badge,children:Bt.length})]})]}),a&&e.jsxs("div",{className:f.errorBanner,children:[e.jsx(Ve,{size:16}),a]}),k==="calendar"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`card glass-panel ${f.calendarCard}`,children:[e.jsxs("div",{className:f.calendarHeader,children:[e.jsx("button",{className:f.navBtn,onClick:Ue,children:e.jsx(is,{size:20})}),e.jsxs("div",{className:f.monthDisplay,children:[e.jsx("h2",{children:m.toLocaleDateString(void 0,{month:"long",year:"numeric"})}),e.jsx("button",{className:f.todayBtn,onClick:Re,children:"Today"})]}),e.jsx("button",{className:f.navBtn,onClick:re,children:e.jsx(gt,{size:20})})]}),e.jsxs("div",{className:f.grid,children:[["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(_=>e.jsx("div",{className:f.dayHeader,children:_},_)),b.map((_,se)=>{const he=$(_.date),jt=he.injections.length>0;he.schedules.length>0;const we=he.schedules.filter(At=>At.completed).length,yt=he.schedules.filter(At=>!At.completed).length;return e.jsxs("button",{className:`${f.day} ${_.dimmed?f.dimmed:""} ${ue(_.date)?f.today:""} ${$e(_.date)?f.selected:""}`,onClick:()=>O(_),children:[e.jsx("span",{className:f.dayNumber,children:_.date.getDate()}),e.jsxs("div",{className:f.dots,children:[jt&&he.injections.slice(0,2).map((At,Js)=>e.jsx("span",{className:`${f.dot} ${f.injectionDot}`},`inj-${Js}`)),yt>0&&e.jsx("span",{className:`${f.dot} ${f.scheduleDot}`}),we>0&&e.jsx("span",{className:`${f.dot} ${f.completedDot}`}),he.injections.length+he.schedules.length>3&&e.jsxs("span",{className:f.moreCount,children:["+",he.injections.length+he.schedules.length-3]})]})]},se)})]})]}),e.jsxs("div",{className:`card glass-panel ${f.detailsSection}`,children:[e.jsxs("div",{className:f.detailsHeader,children:[e.jsxs("div",{children:[e.jsx("h3",{children:l.toLocaleDateString(void 0,{weekday:"long",month:"long",day:"numeric"})}),ue(l)&&e.jsx("span",{className:f.todayLabel,children:"Today"})]}),e.jsxs("div",{className:f.actionButtons,children:[e.jsxs("button",{className:`${f.addBtn} ${f.addBtnPrimary}`,onClick:()=>Yt(),children:[e.jsx(Ke,{size:18}),"Log Shot"]}),!Lt(l)&&e.jsx("button",{className:`${f.addBtn} ${f.addBtnSecondary}`,onClick:Vs,children:e.jsx(us,{size:18})}),e.jsx("button",{className:`${f.addBtn} ${f.addBtnTertiary}`,onClick:ds,children:e.jsx(lt,{size:18})})]})]}),F&&e.jsxs("form",{className:f.form,onSubmit:Gs,children:[e.jsxs("div",{className:f.formHeader,children:[e.jsxs("h4",{children:[T==="log"&&(X?"Edit Injection":"Log Injection"),T==="schedule"&&"Schedule Injection",T==="recurring"&&"Create Recurring Schedule"]}),e.jsx("button",{type:"button",className:f.closeBtn,onClick:()=>A(!1),children:e.jsx(et,{size:20})})]}),e.jsxs("div",{className:f.inputGroup,ref:G,children:[e.jsx("label",{children:"Peptide Name *"}),e.jsxs("div",{className:f.autocompleteWrapper,children:[e.jsx("input",{type:"text",placeholder:"Type or search peptide...",value:P.peptide,onChange:_=>J({...P,peptide:_.target.value}),onFocus:()=>H(!0),required:!0,autoComplete:"off"}),e.jsx(pt,{size:18,className:`${f.chevron} ${L?f.chevronUp:""}`}),L&&xe.length>0&&e.jsx("div",{className:f.autocomplete,children:xe.map(_=>e.jsx("button",{type:"button",className:f.autocompleteItem,onClick:()=>Us(_),children:_},_))})]})]}),e.jsxs("div",{className:f.formRow,children:[e.jsxs("div",{className:f.inputGroup,children:[e.jsx("label",{children:"Dosage *"}),e.jsx("input",{type:"number",step:"0.001",min:"0",placeholder:"0.25",value:P.dosage,onChange:_=>J({...P,dosage:_.target.value}),required:!0})]}),e.jsxs("div",{className:f.inputGroup,children:[e.jsx("label",{children:"Unit"}),e.jsxs("select",{value:P.unit,onChange:_=>J({...P,unit:_.target.value}),children:[e.jsx("option",{value:"mg",children:"mg"}),e.jsx("option",{value:"mcg",children:"mcg"}),e.jsx("option",{value:"iu",children:"IU"})]})]}),(T==="schedule"||T==="recurring")&&e.jsxs("div",{className:f.inputGroup,children:[e.jsx("label",{children:"Time"}),e.jsx("input",{type:"time",value:P.time,onChange:_=>J({...P,time:_.target.value})})]})]}),T==="log"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:f.inputGroup,children:[e.jsxs("label",{children:[e.jsx(Ce,{size:14,style:{marginRight:6,verticalAlign:"middle"}}),"Date & Time"]}),e.jsx("input",{type:"datetime-local",value:P.date,onChange:_=>J({...P,date:_.target.value}),max:new Date().toISOString().slice(0,16)})]}),e.jsxs("div",{className:f.inputGroup,children:[e.jsx("label",{children:"Injection Site"}),e.jsx("div",{className:f.siteButtons,children:["Abdomen","Thigh","Arm","Glute"].map(_=>e.jsx("button",{type:"button",className:`${f.siteButton} ${P.site===_?f.siteActive:""}`,onClick:()=>J({...P,site:_}),children:_},_))})]})]}),T==="recurring"&&e.jsxs("div",{className:f.formSection,children:[e.jsx("label",{children:"Quick Protocols"}),e.jsx("div",{className:f.quickProtocols,children:Hc.map(_=>e.jsxs("button",{type:"button",className:`${f.quickProtocolBtn} ${JSON.stringify(P.recurrenceDays)===JSON.stringify(_.days)?f.quickProtocolActive:""}`,onClick:()=>Hs(_),children:[e.jsx("span",{className:f.protocolEmoji,children:_.icon}),_.label]},_.id))}),e.jsx("label",{style:{marginTop:"1rem"},children:"Or select specific days"}),e.jsx("div",{className:f.daysSelector,children:ys.map(_=>e.jsxs("button",{type:"button",className:`${f.dayBtn} ${P.recurrenceDays.includes(_.value)?f.dayBtnActive:""}`,onClick:()=>Fs(_.value),children:[e.jsx("span",{className:f.dayShort,children:_.short}),e.jsx("span",{className:f.dayLabel,children:_.label})]},_.value))}),e.jsxs("div",{className:f.inputGroup,children:[e.jsx("label",{children:"Duration (days)"}),e.jsxs("select",{value:P.duration,onChange:_=>J({...P,duration:parseInt(_.target.value)}),children:[e.jsx("option",{value:7,children:"1 Week"}),e.jsx("option",{value:14,children:"2 Weeks"}),e.jsx("option",{value:28,children:"4 Weeks"}),e.jsx("option",{value:56,children:"8 Weeks"}),e.jsx("option",{value:84,children:"12 Weeks"})]})]})]}),e.jsxs("div",{className:f.inputGroup,children:[e.jsx("label",{children:"Notes (optional)"}),e.jsx("input",{type:"text",placeholder:"Optional notes...",value:P.notes,onChange:_=>J({...P,notes:_.target.value})})]}),e.jsxs("button",{type:"submit",className:f.submitBtn,children:[T==="log"&&(X?e.jsxs(e.Fragment,{children:[e.jsx(mt,{size:18})," Update"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ke,{size:18})," Log Injection"]})),T==="schedule"&&e.jsxs(e.Fragment,{children:[e.jsx(us,{size:18})," Add to Schedule"]}),T==="recurring"&&e.jsxs(e.Fragment,{children:[e.jsx(lt,{size:18})," Create Protocol"]})]})]}),e.jsxs("div",{className:f.dayItems,children:[We.schedules.filter(_=>!_.completed).length>0&&e.jsxs("div",{className:f.itemSection,children:[e.jsxs("h5",{className:f.sectionLabel,children:[e.jsx(ze,{size:14}),"Scheduled"]}),We.schedules.filter(_=>!_.completed).map(_=>e.jsxs("div",{className:f.scheduleItem,children:[e.jsx("button",{className:f.completeBtn,onClick:()=>ms(_),title:"Mark as complete (will log injection)",children:e.jsx(ja,{size:22})}),e.jsxs("div",{className:f.itemInfo,children:[e.jsx("span",{className:f.itemPeptide,children:_.peptide}),e.jsxs("span",{className:f.itemDetails,children:[_.dosage,_.unit," · ",_.time,_.isRecurring&&e.jsx(lt,{size:12,className:f.recurringIcon})]})]}),e.jsx("button",{className:f.deleteBtn,onClick:()=>p(_.id),children:e.jsx(Be,{size:16})})]},_.id))]}),We.injections.length>0&&e.jsxs("div",{className:f.itemSection,children:[e.jsxs("h5",{className:f.sectionLabel,children:[e.jsx(je,{size:14}),"Logged"]}),We.injections.map(_=>e.jsxs("div",{className:f.injectionItem,children:[e.jsx("div",{className:f.completedIcon,children:e.jsx(je,{size:22})}),e.jsxs("div",{className:f.itemInfo,children:[e.jsx("span",{className:f.itemPeptide,children:_.peptide}),e.jsxs("span",{className:f.itemDetails,children:[_.dosage,_.unit," · ",_.site," · ",Ys(_.date)]}),_.notes&&e.jsx("span",{className:f.itemNotes,children:_.notes})]}),e.jsxs("div",{className:f.itemActions,children:[e.jsx("button",{className:f.editBtn,onClick:()=>Ws(_),children:e.jsx(Je,{size:16})}),e.jsx("button",{className:`${f.deleteBtn} ${V===_.id?f.confirmDelete:""}`,onClick:()=>qs(_.id),children:V===_.id?e.jsx(mt,{size:16}):e.jsx(Be,{size:16})})]})]},_.id))]}),We.schedules.filter(_=>_.completed).length>0&&e.jsxs("div",{className:f.itemSection,children:[e.jsxs("h5",{className:f.sectionLabel,style:{opacity:.6},children:[e.jsx(mt,{size:14}),"Completed Schedule"]}),We.schedules.filter(_=>_.completed).map(_=>e.jsxs("div",{className:`${f.scheduleItem} ${f.completedSchedule}`,children:[e.jsx("div",{className:f.completedIcon,children:e.jsx(je,{size:22})}),e.jsxs("div",{className:f.itemInfo,children:[e.jsx("span",{className:f.itemPeptide,children:_.peptide}),e.jsxs("span",{className:f.itemDetails,children:[_.dosage,_.unit," · ",_.time]})]})]},_.id))]}),We.injections.length===0&&We.schedules.length===0&&e.jsxs("div",{className:f.emptyState,children:[e.jsx(Oe,{size:40,className:f.emptyIcon}),e.jsx("p",{children:"No injections for this day"}),e.jsx("span",{children:'Tap "Log Shot" to add one'})]})]})]})]}):e.jsxs("div",{className:`card glass-panel ${f.upcomingSection}`,children:[e.jsxs("div",{className:f.upcomingHeader,children:[e.jsxs("h3",{children:[e.jsx(lt,{size:20}),"Upcoming Schedule"]}),e.jsxs("button",{className:f.addBtn,onClick:ds,children:[e.jsx(Ke,{size:18}),"New Protocol"]})]}),Bt.length===0?e.jsxs("div",{className:f.emptyState,children:[e.jsx(Ce,{size:40,className:f.emptyIcon}),e.jsx("p",{children:"No upcoming schedules"}),e.jsx("span",{children:"Create a recurring protocol to get started"})]}):e.jsx("div",{className:f.upcomingList,children:Bt.map(_=>{const se=new Date(_.date),he=ue(se);return e.jsxs("div",{className:`${f.upcomingItem} ${_.completed?f.completedItem:""} ${he?f.todayItem:""}`,children:[e.jsxs("div",{className:f.upcomingDate,children:[e.jsx("span",{className:f.upcomingDay,children:se.getDate()}),e.jsx("span",{className:f.upcomingMonth,children:se.toLocaleDateString(void 0,{weekday:"short"})})]}),e.jsxs("div",{className:f.upcomingInfo,children:[e.jsx("span",{className:f.upcomingPeptide,children:_.peptide}),e.jsxs("span",{className:f.upcomingDetails,children:[_.dosage,_.unit," · ",_.time,_.isRecurring&&e.jsx(lt,{size:12,className:f.recurringIcon})]})]}),!_.completed&&he&&e.jsxs("button",{className:f.quickCompleteBtn,onClick:()=>ms(_),children:[e.jsx(mt,{size:18}),"Log Now"]}),_.completed&&e.jsxs("span",{className:f.completedBadge,children:[e.jsx(je,{size:16}),"Done"]})]},_.id)})}),j.length>0&&e.jsxs("div",{className:f.templatesSection,children:[e.jsxs("h4",{children:[e.jsx(Ls,{size:16}),"Active Protocols"]}),e.jsx("div",{className:f.templatesList,children:j.map(_=>e.jsxs("div",{className:f.templateItem,children:[e.jsxs("div",{className:f.templateInfo,children:[e.jsx("span",{className:f.templateName,children:_.name||_.peptide}),e.jsxs("span",{className:f.templateDetails,children:[_.dosage,_.unit," · ",_.recurrenceDays?.map(se=>ys[se]?.short).join(", ")]})]}),e.jsx("button",{className:f.deleteBtn,onClick:()=>y(_.id,!0),title:"Delete protocol and all scheduled items",children:e.jsx(Be,{size:16})})]},_.id))})]})]})]})},Gc=()=>e.jsx("div",{className:"padding-container",style:{padding:"20px"},children:e.jsx(Uc,{})}),Wc=()=>{const[t,s]=r.useState(""),[a,i]=r.useState(""),[o,d]=r.useState(!1),[c,u]=r.useState(!1),[g,h]=r.useState(!1),[j,I]=r.useState(null),[D,z]=r.useState(!1),[p,C]=r.useState(""),[y,x]=r.useState(null),{signIn:m,signInWithOAuth:w,user:l}=Se(),N=Ut(),B=ct().state?.from?.pathname||"/settings";r.useEffect(()=>{(async()=>{if(l){if(D)return;const{data:L}=await S.auth.mfa.getAuthenticatorAssuranceLevel();if(L&&L.nextLevel==="aal2"&&L.currentLevel==="aal1"){z(!0);const{data:H}=await S.auth.mfa.listFactors(),V=H?.all?.find(v=>v.factor_type==="totp");V?x(V.id):I("2FA required but no factor found. Please contact support.")}else N(B,{replace:!0})}})()},[l,D,N,B]);const F=async n=>{n.preventDefault(),u(!0),I(null);try{await m(t,a)}catch(L){L.message.includes("Invalid login credentials")?I("Invalid email or password. Please try again."):L.message.includes("Email not confirmed")?I("Please check your email and confirm your account before logging in."):I(L.message)}finally{u(!1)}},A=async n=>{n.preventDefault(),u(!0),I(null);try{if(!y)throw new Error("2FA factor ID not found");const L=await S.auth.mfa.challenge({factorId:y});if(L.error)throw L.error;const H=await S.auth.mfa.verify({factorId:y,challengeId:L.data.id,code:p});if(H.error)throw H.error;N(B,{replace:!0})}catch(L){I(L.message)}finally{u(!1)}},T=async()=>{h(!0),I(null);try{await w("google")}catch{I("Failed to sign in with Google. Please try again."),h(!1)}},K={background:"rgba(15, 23, 42, 0.5)",border:"1px solid var(--glass-border)",borderRadius:"var(--radius-md)",padding:"0.75rem 1rem",color:"var(--text-primary)",fontSize:"1rem",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s",width:"100%",boxSizing:"border-box"},X={display:"flex",alignItems:"center",justifyContent:"center",gap:"0.75rem",width:"100%",padding:"0.75rem 1rem",background:"rgba(255, 255, 255, 0.05)",border:"1px solid var(--glass-border)",borderRadius:"var(--radius-md)",color:"var(--text-primary)",fontSize:"0.95rem",fontWeight:"500",cursor:g?"not-allowed":"pointer",opacity:g?.7:1,transition:"all 0.2s"};return e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"80vh"},children:e.jsxs("div",{className:"card glass-panel",style:{width:"100%",maxWidth:"400px",padding:"2rem"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:"2rem"},children:[e.jsx("div",{style:{background:"var(--accent-glow)",padding:"1rem",borderRadius:"50%",marginBottom:"1rem",display:"flex",alignItems:"center",justifyContent:"center"},children:D?e.jsx(Ae,{size:32,color:"var(--accent-primary)"}):e.jsx(St,{size:32,color:"var(--accent-primary)"})}),e.jsx("h2",{style:{margin:0,fontSize:"1.5rem",fontWeight:"600"},children:D?"Two-Factor Authentication":"Welcome Back"}),e.jsx("p",{style:{color:"var(--text-secondary)",marginTop:"0.5rem"},children:D?"Enter the code from your authenticator app":"Sign in to your account"})]}),j&&e.jsxs("div",{style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.2)",color:"#ef4444",padding:"0.75rem",borderRadius:"var(--radius-md)",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem"},children:[e.jsx(Ve,{size:16}),e.jsx("span",{children:j})]}),D?e.jsxs("form",{onSubmit:A,style:{display:"flex",flexDirection:"column",gap:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsx("label",{style:{fontSize:"0.875rem",fontWeight:"500",color:"var(--text-secondary)"},children:"Verification Code"}),e.jsx("input",{type:"text",value:p,onChange:n=>C(n.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"Enter 6-digit code",style:{...K,textAlign:"center",letterSpacing:"0.25rem",fontSize:"1.25rem"},required:!0,autoFocus:!0,maxLength:6})]}),e.jsxs("button",{type:"submit",className:"btn-primary",disabled:c||p.length!==6,style:{marginTop:"0.5rem",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",gap:"0.5rem",opacity:c||p.length!==6?.7:1,cursor:c||p.length!==6?"not-allowed":"pointer"},children:[e.jsx("span",{children:c?"Verifying...":"Verify Code"}),!c&&e.jsx(Ae,{size:18})]}),e.jsx("button",{type:"button",onClick:()=>z(!1),style:{background:"transparent",border:"none",color:"var(--text-tertiary)",cursor:"pointer",fontSize:"0.875rem",textDecoration:"underline"},children:"Cancel and go back"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{marginBottom:"1.5rem"},children:e.jsxs("button",{onClick:T,disabled:g,style:X,onMouseEnter:n=>{g||(n.target.style.background="rgba(255, 255, 255, 0.1)")},onMouseLeave:n=>{n.target.style.background="rgba(255, 255, 255, 0.05)"},children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),g?"Connecting...":"Continue with Google"]})}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx("div",{style:{flex:1,height:"1px",background:"var(--glass-border)"}}),e.jsx("span",{style:{color:"var(--text-tertiary)",fontSize:"0.75rem",textTransform:"uppercase"},children:"or"}),e.jsx("div",{style:{flex:1,height:"1px",background:"var(--glass-border)"}})]}),e.jsxs("form",{onSubmit:F,style:{display:"flex",flexDirection:"column",gap:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsx("label",{style:{fontSize:"0.875rem",fontWeight:"500",color:"var(--text-secondary)"},children:"Email"}),e.jsx("input",{type:"email",value:t,onChange:n=>s(n.target.value),placeholder:"Enter your email",style:K,required:!0,autoComplete:"email"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("label",{style:{fontSize:"0.875rem",fontWeight:"500",color:"var(--text-secondary)"},children:"Password"}),e.jsx(pe,{to:"/forgot-password",style:{fontSize:"0.75rem",color:"var(--accent-primary)",textDecoration:"none"},children:"Forgot password?"})]}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{type:o?"text":"password",value:a,onChange:n=>i(n.target.value),placeholder:"Enter your password",style:{...K,paddingRight:"3rem"},required:!0,autoComplete:"current-password"}),e.jsx("button",{type:"button",onClick:()=>d(!o),style:{position:"absolute",right:"0.75rem",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",cursor:"pointer",padding:"0.25rem",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--text-tertiary)"},tabIndex:-1,children:o?e.jsx(ya,{size:18}):e.jsx(It,{size:18})})]})]}),e.jsxs("button",{type:"submit",className:"btn-primary",disabled:c,style:{marginTop:"0.5rem",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",gap:"0.5rem",opacity:c?.7:1,cursor:c?"not-allowed":"pointer"},children:[e.jsx("span",{children:c?"Signing in...":"Sign In"}),!c&&e.jsx(St,{size:18})]})]})]}),e.jsx("div",{style:{marginTop:"1.5rem",paddingTop:"1.5rem",borderTop:"1px solid var(--glass-border)",textAlign:"center"},children:e.jsxs("p",{style:{color:"var(--text-secondary)",fontSize:"0.875rem"},children:["Don't have an account?"," ",e.jsx(pe,{to:"/signup",style:{color:"var(--accent-primary)",textDecoration:"none",fontWeight:"500"},children:"Create one"})]})})]})})},qc=()=>{const[t,s]=r.useState(""),[a,i]=r.useState(""),[o,d]=r.useState(""),[c,u]=r.useState(""),[g,h]=r.useState(!1),[j,I]=r.useState(null),[D,z]=r.useState(!1),{signUp:p}=Se();Ut();const C=async x=>{if(x.preventDefault(),h(!0),I(null),o!==c){I("Passwords don't match"),h(!1);return}if(o.length<6){I("Password must be at least 6 characters"),h(!1);return}try{await p(a,o,t),z(!0)}catch(m){I(m.message)}finally{h(!1)}},y={background:"rgba(15, 23, 42, 0.5)",border:"1px solid var(--glass-border)",borderRadius:"var(--radius-md)",padding:"0.75rem 1rem",color:"var(--text-primary)",fontSize:"1rem",outline:"none",transition:"border-color 0.2s, box-shadow 0.2s",width:"100%",boxSizing:"border-box"};return D?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"80vh"},children:e.jsxs("div",{className:"card glass-panel",style:{width:"100%",maxWidth:"400px",padding:"2rem",textAlign:"center"},children:[e.jsx("div",{style:{background:"rgba(16, 185, 129, 0.1)",padding:"1rem",borderRadius:"50%",marginBottom:"1.5rem",display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Dt,{size:40,color:"#10b981"})}),e.jsx("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.5rem",fontWeight:"600"},children:"Check Your Email"}),e.jsxs("p",{style:{color:"var(--text-secondary)",marginBottom:"1.5rem",lineHeight:"1.6"},children:["We've sent a confirmation link to ",e.jsx("strong",{style:{color:"var(--text-primary)"},children:a}),". Please click the link to verify your account."]}),e.jsx("p",{style:{color:"var(--text-tertiary)",fontSize:"0.875rem",marginBottom:"1.5rem"},children:"Didn't receive the email? Check your spam folder."}),e.jsx(pe,{to:"/login",className:"btn-primary",style:{display:"inline-block",textDecoration:"none"},children:"Go to Login"})]})}):e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"80vh"},children:e.jsxs("div",{className:"card glass-panel",style:{width:"100%",maxWidth:"400px",padding:"2rem"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:"2rem"},children:[e.jsx("div",{style:{background:"var(--accent-glow)",padding:"1rem",borderRadius:"50%",marginBottom:"1rem",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ts,{size:32,color:"var(--accent-primary)"})}),e.jsx("h2",{style:{margin:0,fontSize:"1.5rem",fontWeight:"600"},children:"Create Account"}),e.jsx("p",{style:{color:"var(--text-secondary)",marginTop:"0.5rem"},children:"Join Peptide Tracker today"})]}),j&&e.jsxs("div",{style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.2)",color:"#ef4444",padding:"0.75rem",borderRadius:"var(--radius-md)",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem"},children:[e.jsx(Ve,{size:16}),e.jsx("span",{children:j})]}),e.jsxs("form",{onSubmit:C,style:{display:"flex",flexDirection:"column",gap:"1.25rem"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsx("label",{style:{fontSize:"0.875rem",fontWeight:"500",color:"var(--text-secondary)"},children:"Full Name"}),e.jsx("input",{type:"text",value:t,onChange:x=>s(x.target.value),placeholder:"Enter your full name",style:y,required:!0})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsx("label",{style:{fontSize:"0.875rem",fontWeight:"500",color:"var(--text-secondary)"},children:"Email"}),e.jsx("input",{type:"email",value:a,onChange:x=>i(x.target.value),placeholder:"Enter your email",style:y,required:!0})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsx("label",{style:{fontSize:"0.875rem",fontWeight:"500",color:"var(--text-secondary)"},children:"Password"}),e.jsx("input",{type:"password",value:o,onChange:x=>d(x.target.value),placeholder:"Create a password (min. 6 characters)",style:y,required:!0,minLength:6})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsx("label",{style:{fontSize:"0.875rem",fontWeight:"500",color:"var(--text-secondary)"},children:"Confirm Password"}),e.jsx("input",{type:"password",value:c,onChange:x=>u(x.target.value),placeholder:"Confirm your password",style:y,required:!0})]}),e.jsxs("button",{type:"submit",className:"btn-primary",disabled:g,style:{marginTop:"0.5rem",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",gap:"0.5rem",opacity:g?.7:1,cursor:g?"not-allowed":"pointer"},children:[e.jsx("span",{children:g?"Creating account...":"Create Account"}),!g&&e.jsx(ts,{size:18})]})]}),e.jsx("div",{style:{marginTop:"1.5rem",paddingTop:"1.5rem",borderTop:"1px solid var(--glass-border)",textAlign:"center"},children:e.jsxs("p",{style:{color:"var(--text-secondary)",fontSize:"0.875rem"},children:["Already have an account?"," ",e.jsx(pe,{to:"/login",style:{color:"var(--accent-primary)",textDecoration:"none",fontWeight:"500"},children:"Sign in"})]})}),e.jsxs("p",{style:{color:"var(--text-tertiary)",fontSize:"0.75rem",textAlign:"center",marginTop:"1rem",lineHeight:"1.5"},children:["By creating an account, you agree to our"," ",e.jsx(pe,{to:"/terms",style:{color:"var(--text-secondary)"},children:"Terms of Service"})," ","and"," ",e.jsx(pe,{to:"/privacy",style:{color:"var(--text-secondary)"},children:"Privacy Policy"})]})]})})},Yc=()=>{const[t,s]=r.useState(""),[a,i]=r.useState(!1),[o,d]=r.useState(null),[c,u]=r.useState(!1),{resetPassword:g}=Se(),h=async I=>{I.preventDefault(),i(!0),d(null);try{await g(t),u(!0)}catch(D){d(D.message)}finally{i(!1)}},j={background:"rgba(15, 23, 42, 0.5)",border:"1px solid var(--glass-border)",borderRadius:"var(--radius-md)",padding:"0.75rem 1rem",color:"var(--text-primary)",fontSize:"1rem",outline:"none",transition:"border-color 0.2s",width:"100%",boxSizing:"border-box"};return c?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"80vh"},children:e.jsxs("div",{className:"card glass-panel",style:{width:"100%",maxWidth:"400px",padding:"2rem",textAlign:"center"},children:[e.jsx("div",{style:{background:"rgba(16, 185, 129, 0.1)",padding:"1rem",borderRadius:"50%",marginBottom:"1.5rem",display:"inline-flex",alignItems:"center",justifyContent:"center"},children:e.jsx(je,{size:40,color:"#10b981"})}),e.jsx("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.5rem",fontWeight:"600"},children:"Check Your Email"}),e.jsxs("p",{style:{color:"var(--text-secondary)",marginBottom:"1.5rem",lineHeight:"1.6"},children:["We've sent password reset instructions to ",e.jsx("strong",{style:{color:"var(--text-primary)"},children:t})]}),e.jsx("p",{style:{color:"var(--text-tertiary)",fontSize:"0.875rem",marginBottom:"1.5rem"},children:"Didn't receive the email? Check your spam folder or try again."}),e.jsxs(pe,{to:"/login",className:"btn-primary",style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",textDecoration:"none"},children:[e.jsx(Rt,{size:18}),"Back to Login"]})]})}):e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"80vh"},children:e.jsxs("div",{className:"card glass-panel",style:{width:"100%",maxWidth:"400px",padding:"2rem"},children:[e.jsxs(pe,{to:"/login",style:{display:"inline-flex",alignItems:"center",gap:"0.25rem",color:"var(--text-secondary)",textDecoration:"none",fontSize:"0.875rem",marginBottom:"1.5rem"},children:[e.jsx(Rt,{size:16}),"Back to login"]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:"2rem"},children:[e.jsx("div",{style:{background:"var(--accent-glow)",padding:"1rem",borderRadius:"50%",marginBottom:"1rem",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Dt,{size:32,color:"var(--accent-primary)"})}),e.jsx("h2",{style:{margin:0,fontSize:"1.5rem",fontWeight:"600"},children:"Reset Password"}),e.jsx("p",{style:{color:"var(--text-secondary)",marginTop:"0.5rem",textAlign:"center"},children:"Enter your email and we'll send you a link to reset your password"})]}),o&&e.jsxs("div",{style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.2)",color:"#ef4444",padding:"0.75rem",borderRadius:"var(--radius-md)",marginBottom:"1.5rem",display:"flex",alignItems:"center",gap:"0.5rem",fontSize:"0.875rem"},children:[e.jsx(Ve,{size:16}),e.jsx("span",{children:o})]}),e.jsxs("form",{onSubmit:h,style:{display:"flex",flexDirection:"column",gap:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[e.jsx("label",{style:{fontSize:"0.875rem",fontWeight:"500",color:"var(--text-secondary)"},children:"Email Address"}),e.jsx("input",{type:"email",value:t,onChange:I=>s(I.target.value),placeholder:"Enter your email",style:j,required:!0,autoComplete:"email"})]}),e.jsx("button",{type:"submit",className:"btn-primary",disabled:a,style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center",gap:"0.5rem",opacity:a?.7:1,cursor:a?"not-allowed":"pointer"},children:e.jsx("span",{children:a?"Sending...":"Send Reset Link"})})]})]})})},Jc={async requestPasswordReset(t){try{const{error:s}=await S.auth.resetPasswordForEmail(t,{redirectTo:`${window.location.origin}/reset-password`});if(s)throw s;return{success:!0}}catch(s){return console.error("[Email Service] Password reset failed:",s),{success:!1,error:s.message}}},async sendMagicLink(t){try{const{error:s}=await S.auth.signInWithOtp({email:t,options:{emailRedirectTo:`${window.location.origin}/`}});if(s)throw s;return{success:!0}}catch(s){return console.error("[Email Service] Magic link failed:",s),{success:!1,error:s.message}}},async resendConfirmation(t){try{const{error:s}=await S.auth.resend({type:"signup",email:t,options:{emailRedirectTo:`${window.location.origin}/`}});if(s)throw s;return{success:!0}}catch(s){return console.error("[Email Service] Resend confirmation failed:",s),{success:!1,error:s.message}}},async sendCustomEmail(t,s,a={}){try{const{data:i,error:o}=await S.functions.invoke("send-email",{body:{type:t,email:s,data:a}});if(o)throw o;return{success:!0,data:i}}catch(i){return console.warn(`[Email Service] Custom email (${t}) failed:`,i.message),i.message?.includes("not found")||i.status===404?(console.log(`[Email Service] Edge Function not deployed. Email type: ${t}, To: ${s}`),{success:!0,simulated:!0}):{success:!1,error:i.message}}},async sendWelcomeEmail(t,s){return this.sendCustomEmail("welcome",t,{name:s})},async sendInjectionReminder(t,s,a){return this.sendCustomEmail("injection_reminder",t,{peptideName:s,scheduledTime:a})},async sendTicketUpdate(t,s,a){return this.sendCustomEmail("ticket_update",t,{ticketSubject:s,status:a})},async updateNotificationPreferences(t,s){try{const{error:a}=await S.from("profiles").update({email_notifications:s.email??!0,push_notifications:s.push??!0,reminder_time:s.reminderTime??null}).eq("id",t);if(a)throw a;return{success:!0}}catch(a){return console.error("[Email Service] Update preferences failed:",a),{success:!1,error:a.message}}},async getNotificationPreferences(t){try{const{data:s,error:a}=await S.from("profiles").select("email_notifications, push_notifications, reminder_time").eq("id",t).single();if(a)throw a;return{success:!0,preferences:{email:s.email_notifications??!0,push:s.push_notifications??!0,reminderTime:s.reminder_time}}}catch(s){return console.error("[Email Service] Get preferences failed:",s),{success:!1,error:s.message}}}},Xc={toCSV:(t,s="injection_history")=>{if(!t||t.length===0)throw new Error("No data to export");const a=["Date","Time","Peptide","Dosage","Unit","Injection Site","Notes"],i=t.map(g=>{const h=new Date(g.injection_date||g.date);return[ve(h,"yyyy-MM-dd"),ve(h,"HH:mm"),g.peptide_name||g.peptide||"",g.dosage_value||g.dosage_mcg||g.dosage||"",g.dosage_unit||g.unit||"mcg",g.injection_site||g.site||"",(g.notes||"").replace(/"/g,'""')]}),o=[a.join(","),...i.map(g=>g.map(h=>`"${h}"`).join(","))].join(`
`),d=new Blob([o],{type:"text/csv;charset=utf-8;"}),c=URL.createObjectURL(d),u=document.createElement("a");return u.href=c,u.download=`${s}_${ve(new Date,"yyyy-MM-dd")}.csv`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(c),!0},toPDF:(t,s={})=>{if(!t||t.length===0)throw new Error("No data to export");const{filename:a="injection_history",title:i="Injection History Report"}=s,o=new na;o.setFontSize(20),o.setTextColor(59,130,246),o.text("Peptide Tracker",14,20),o.setFontSize(14),o.setTextColor(31,41,55),o.text(i,14,30),o.setFontSize(10),o.setTextColor(107,114,128),o.text(`Generated on ${ve(new Date,"MMMM d, yyyy")}`,14,38),o.text(`Total Records: ${t.length}`,14,44);const d=t.map(j=>{const I=new Date(j.injection_date||j.date);return[ve(I,"MMM d, yyyy"),ve(I,"h:mm a"),j.peptide_name||j.peptide||"",`${j.dosage_value||j.dosage_mcg||j.dosage||""} ${j.dosage_unit||j.unit||"mcg"}`,j.injection_site||j.site||"",(j.notes||"").substring(0,30)+(j.notes?.length>30?"...":"")]});o.autoTable({startY:52,head:[["Date","Time","Peptide","Dosage","Site","Notes"]],body:d,theme:"striped",headStyles:{fillColor:[59,130,246],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[249,250,251]},styles:{fontSize:9,cellPadding:4},columnStyles:{0:{cellWidth:25},1:{cellWidth:20},2:{cellWidth:35},3:{cellWidth:25},4:{cellWidth:25},5:{cellWidth:"auto"}}});const c=o.lastAutoTable.finalY+15,u={};t.forEach(j=>{const I=j.peptide_name||j.peptide;u[I]=(u[I]||0)+1});const g=Object.entries(u).sort((j,I)=>I[1]-j[1]).slice(0,5);c<250&&(o.setFontSize(12),o.setTextColor(31,41,55),o.text("Summary by Peptide",14,c),o.autoTable({startY:c+5,head:[["Peptide","Count","Percentage"]],body:g.map(([j,I])=>[j,I,`${(I/t.length*100).toFixed(1)}%`]),theme:"plain",headStyles:{fillColor:[243,244,246],textColor:[55,65,81],fontStyle:"bold"},styles:{fontSize:9}}));const h=o.internal.getNumberOfPages();for(let j=1;j<=h;j++)o.setPage(j),o.setFontSize(8),o.setTextColor(156,163,175),o.text(`Page ${j} of ${h} | Peptide Tracker`,o.internal.pageSize.width/2,o.internal.pageSize.height-10,{align:"center"});return o.save(`${a}_${ve(new Date,"yyyy-MM-dd")}.pdf`),!0},schedulesToCSV:(t,s="schedule_export")=>{if(!t||t.length===0)throw new Error("No schedules to export");const a=["Date","Time","Peptide","Dosage","Unit","Completed","Notes"],i=t.map(g=>[g.scheduled_date||ve(new Date(g.date),"yyyy-MM-dd"),g.scheduled_time||g.time||"",g.peptide_name||g.peptide||"",g.dosage||"",g.unit||"mg",g.completed?"Yes":"No",(g.notes||"").replace(/"/g,'""')]),o=[a.join(","),...i.map(g=>g.map(h=>`"${h}"`).join(","))].join(`
`),d=new Blob([o],{type:"text/csv;charset=utf-8;"}),c=URL.createObjectURL(d),u=document.createElement("a");return u.href=c,u.download=`${s}_${ve(new Date,"yyyy-MM-dd")}.csv`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(c),!0}},$j=async t=>{try{let{data:s,error:a}=await S.from("reviews_with_profiles").select("*").eq("peptide_name",t).order("created_at",{ascending:!1});if(a&&a.code==="PGRST200"){const i=await S.from("reviews").select("*").eq("peptide_name",t).order("created_at",{ascending:!1});s=i.data,a=i.error}if(a)throw a;return(s||[]).map(i=>({...i,user_name:i.full_name||"Anonymous"}))}catch(s){return console.warn("Error fetching reviews:",s),[]}},Zc=async t=>{try{const{data:s,error:a}=await S.from("reviews").select("*").eq("user_id",t).order("created_at",{ascending:!1});if(a)throw a;return s||[]}catch(s){return console.warn("Error fetching user reviews:",s),[]}},Kc=async t=>{try{const{error:s}=await S.from("reviews").delete().eq("id",t);if(s)throw s;return!0}catch(s){return console.warn("Error deleting review:",s),!1}},zj=async(t,s,a,i)=>{try{const{data:o,error:d}=await S.from("reviews").insert([{peptide_name:t,rating:s,comment:a,user_id:i}]).select();if(d)throw d;return o[0]}catch(o){throw console.warn("Error submitting review:",o),o}},Qc=()=>{const[t,s]=r.useState(!1),[a,i]=r.useState(!1),[o,d]=r.useState(""),[c,u]=r.useState(""),[g,h]=r.useState(null),[j,I]=r.useState(null),[D,z]=r.useState(!0);r.useEffect(()=>{p()},[]);const p=async()=>{try{z(!0);const{data:w,error:l}=await S.auth.mfa.listFactors();if(l)throw l;const N=w.all.find(k=>k.factor_type==="totp"&&k.status==="verified");N?(s(!0),h(N.id)):(s(!1),h(null))}catch(w){console.error("Error checking 2FA status:",w),I(w.message)}finally{z(!1)}};return{isEnabled:t,isEnrolling:a,isLoading:D,qrCodeUrl:o,secret:c,error:j,startEnrollment:async()=>{try{I(null);const{data:w,error:l}=await S.auth.mfa.enroll({factorType:"totp"});if(l)throw l;h(w.id),u(w.totp.secret);const N=await Qs.toDataURL(w.totp.uri);d(N),i(!0)}catch(w){console.error("Error starting enrollment:",w),I(w.message)}},verifyAndEnable:async w=>{try{I(null);const l=await S.auth.mfa.challenge({factorId:g});if(l.error)throw l.error;const N=await S.auth.mfa.verify({factorId:g,challengeId:l.data.id,code:w});if(N.error)throw N.error;return s(!0),i(!1),d(""),u(""),!0}catch(l){return console.error("Error verifying code:",l),I(l.message),!1}},disableTwoFactor:async()=>{try{if(I(null),g){const{error:w}=await S.auth.mfa.unenroll({factorId:g});if(w)throw w}else{const{data:w}=await S.auth.mfa.listFactors(),l=w.all.find(k=>k.factor_type==="totp");if(!l)throw new Error("No active 2FA found");const{error:N}=await S.auth.mfa.unenroll({factorId:l.id});if(N)throw N}return s(!1),h(null),!0}catch(w){return console.error("Error disabling 2FA:",w),I(w.message),!1}},cancelEnrollment:async()=>{g&&a&&await S.auth.mfa.unenroll({factorId:g}),i(!1),d(""),u(""),h(null)}}},el="_overlay_kjoru_1",tl="_modal_kjoru_13",sl="_header_kjoru_23",al="_title_kjoru_31",nl="_closeButton_kjoru_41",il="_content_kjoru_60",rl="_previewContainer_kjoru_64",ol="_progressCard_kjoru_69",cl="_cardHeader_kjoru_76",ll="_cardLogo_kjoru_83",dl="_cardDate_kjoru_89",ml="_cardStats_kjoru_94",ul="_cardStatItem_kjoru_101",hl="_cardStatIcon_kjoru_108",pl="_cardStatValue_kjoru_115",gl="_cardStatLabel_kjoru_123",xl="_cardFooter_kjoru_130",_l="_topPeptide_kjoru_138",fl="_watermark_kjoru_144",jl="_actions_kjoru_150",yl="_generateButton_kjoru_155",vl="_actionButton_kjoru_178",de={overlay:el,modal:tl,header:sl,title:al,closeButton:nl,content:il,previewContainer:rl,progressCard:ol,cardHeader:cl,cardLogo:ll,cardDate:dl,cardStats:ml,cardStatItem:ul,cardStatIcon:hl,cardStatValue:pl,cardStatLabel:gl,cardFooter:xl,topPeptide:_l,watermark:fl,actions:jl,generateButton:yl,actionButton:vl},bl=({onClose:t})=>{const{injections:s}=Tt(),[a,i]=r.useState(!1),[o,d]=r.useState(!1),[c,u]=r.useState(null),g=r.useRef(null),h=s.filter(m=>new Date(m.injection_date||m.date)>=nt(new Date,30)),j={total:h.length,streak:I(s),topPeptide:D(h),compliance:z(h)};function I(m){if(m.length===0)return 0;let w=0,l=new Date;l.setHours(0,0,0,0);for(let N=0;N<365;N++){const k=ve(l,"yyyy-MM-dd");if(m.some(F=>ve(new Date(F.injection_date||F.date),"yyyy-MM-dd")===k))w++,l=nt(l,1);else if(N===0)l=nt(l,1);else break}return w}function D(m){const w={};m.forEach(N=>{const k=N.peptide_name||N.peptide;w[k]=(w[k]||0)+1});const l=Object.entries(w).sort((N,k)=>k[1]-N[1]);return l[0]?l[0][0]:"None"}function z(m){const w=new Set(m.map(l=>ve(new Date(l.injection_date||l.date),"yyyy-MM-dd")));return Math.min(100,Math.round(w.size/30*100))}const p=async()=>{if(g.current){i(!0);try{const w=(await ea(g.current,{backgroundColor:"#0a0e1a",scale:2,logging:!1,useCORS:!0})).toDataURL("image/png");u(w)}catch(m){console.error("Error generating image:",m)}finally{i(!1)}}},C=()=>{if(!c)return;const m=document.createElement("a");m.download=`peptide-progress-${ve(new Date,"yyyy-MM-dd")}.png`,m.href=c,m.click()},y=async()=>{if(c)try{const w=await(await fetch(c)).blob();await navigator.clipboard.write([new ClipboardItem({"image/png":w})]),d(!0),setTimeout(()=>d(!1),2e3)}catch(m){console.error("Error copying to clipboard:",m)}},x=async()=>{if(!(!c||!navigator.share))try{const w=await(await fetch(c)).blob(),l=new File([w],"peptide-progress.png",{type:"image/png"});await navigator.share({title:"My Peptide Progress",text:"Check out my peptide tracking progress!",files:[l]})}catch(m){console.error("Error sharing:",m)}};return e.jsx("div",{className:de.overlay,children:e.jsxs("div",{className:de.modal,children:[e.jsxs("div",{className:de.header,children:[e.jsxs("h2",{className:de.title,children:[e.jsx(Mt,{size:20}),"Share Progress"]}),e.jsx("button",{className:de.closeButton,onClick:t,children:e.jsx(et,{size:20})})]}),e.jsxs("div",{className:de.content,children:[e.jsx("div",{className:de.previewContainer,children:e.jsxs("div",{ref:g,className:de.progressCard,children:[e.jsxs("div",{className:de.cardHeader,children:[e.jsx("div",{className:de.cardLogo,children:"💉 Peptide Tracker"}),e.jsx("div",{className:de.cardDate,children:ve(new Date,"MMMM yyyy")})]}),e.jsxs("div",{className:de.cardStats,children:[e.jsxs("div",{className:de.cardStatItem,children:[e.jsx("div",{className:de.cardStatIcon,children:e.jsx(Nt,{size:24})}),e.jsx("div",{className:de.cardStatValue,children:j.total}),e.jsx("div",{className:de.cardStatLabel,children:"Injections (30d)"})]}),e.jsxs("div",{className:de.cardStatItem,children:[e.jsx("div",{className:de.cardStatIcon,children:e.jsx(it,{size:24})}),e.jsx("div",{className:de.cardStatValue,children:j.streak}),e.jsx("div",{className:de.cardStatLabel,children:"Day Streak"})]}),e.jsxs("div",{className:de.cardStatItem,children:[e.jsx("div",{className:de.cardStatIcon,children:e.jsx(Ce,{size:24})}),e.jsxs("div",{className:de.cardStatValue,children:[j.compliance,"%"]}),e.jsx("div",{className:de.cardStatLabel,children:"Compliance"})]})]}),e.jsxs("div",{className:de.cardFooter,children:[e.jsxs("span",{className:de.topPeptide,children:["Top: ",j.topPeptide]}),e.jsx("span",{className:de.watermark,children:"peptidetracker.app"})]})]})}),e.jsx("div",{className:de.actions,children:c?e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:de.actionButton,onClick:C,children:[e.jsx(Wt,{size:18}),"Download"]}),e.jsxs("button",{className:de.actionButton,onClick:y,children:[o?e.jsx(mt,{size:18}):e.jsx(Bs,{size:18}),o?"Copied!":"Copy"]}),navigator.share&&e.jsxs("button",{className:de.actionButton,onClick:x,children:[e.jsx(Mt,{size:18}),"Share"]})]}):e.jsx("button",{className:de.generateButton,onClick:p,disabled:a,children:a?"Generating...":"Generate Image"})})]})]})})},tt={async exportUserData(t){try{const[s,a,i,o,d]=await Promise.all([S.from("profiles").select("*").eq("id",t).single(),S.from("injections").select("*").eq("user_id",t).order("date",{ascending:!1}),S.from("schedules").select("*").eq("user_id",t),S.from("inventory").select("*").eq("user_id",t),S.from("reviews").select("*").eq("user_id",t)]);return{success:!0,data:{exportDate:new Date().toISOString(),exportVersion:"1.0",user:{profile:s.data,statistics:{totalInjections:a.data?.length||0,totalSchedules:i.data?.length||0,totalInventoryItems:o.data?.length||0,totalReviews:d.data?.length||0}},data:{injections:a.data||[],schedules:i.data||[],inventory:o.data||[],reviews:d.data||[]}},filename:`peptide-tracker-export-${new Date().toISOString().split("T")[0]}.json`}}catch(s){return console.error("[Backup Service] Export failed:",s),{success:!1,error:s.message}}},async exportAsCSV(t){try{const[s,a,i]=await Promise.all([S.from("injections").select("*").eq("user_id",t).order("date",{ascending:!1}),S.from("schedules").select("*").eq("user_id",t),S.from("inventory").select("*").eq("user_id",t)]),o={};return s.data?.length&&(o.injections=this._arrayToCSV(s.data,["date","peptide_name","dose_amount","dose_unit","injection_site","notes"])),a.data?.length&&(o.schedules=this._arrayToCSV(a.data,["peptide_name","dose_amount","dose_unit","frequency","time","notes"])),i.data?.length&&(o.inventory=this._arrayToCSV(i.data,["peptide_name","quantity","vial_size","expiration_date","notes"])),{success:!0,files:o}}catch(s){return console.error("[Backup Service] CSV export failed:",s),{success:!1,error:s.message}}},_arrayToCSV(t,s){if(!t||!t.length)return"";const a=s.join(","),i=t.map(o=>s.map(d=>{const c=o[d];return c==null?"":typeof c=="string"&&(c.includes(",")||c.includes('"'))?`"${c.replace(/"/g,'""')}"`:c}).join(","));return[a,...i].join(`
`)},downloadJSON(t,s){const a=new Blob([JSON.stringify(t,null,2)],{type:"application/json"});this._triggerDownload(a,s)},downloadCSV(t,s){const a=new Blob([t],{type:"text/csv;charset=utf-8;"});this._triggerDownload(a,s)},_triggerDownload(t,s){const a=URL.createObjectURL(t),i=document.createElement("a");i.href=a,i.download=s,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(a)},async importUserData(t,s){try{const a=typeof s=="string"?JSON.parse(s):s;if(!a.exportVersion||!a.data)throw new Error("Invalid backup file format");const i={injections:0,schedules:0,errors:[]};if(a.data.injections?.length)for(const o of a.data.injections){const{error:d}=await S.from("injections").insert({user_id:t,peptide_name:o.peptide_name,date:o.date,dose_amount:o.dose_amount,dose_unit:o.dose_unit,injection_site:o.injection_site,notes:o.notes});d?i.errors.push(`Injection: ${d.message}`):i.injections++}if(a.data.schedules?.length)for(const o of a.data.schedules){const{error:d}=await S.from("schedules").insert({user_id:t,peptide_name:o.peptide_name,dose_amount:o.dose_amount,dose_unit:o.dose_unit,frequency:o.frequency,time:o.time,notes:o.notes});d?i.errors.push(`Schedule: ${d.message}`):i.schedules++}return{success:!0,imported:i,message:`Imported ${i.injections} injections and ${i.schedules} schedules`}}catch(a){return console.error("[Backup Service] Import failed:",a),{success:!1,error:a.message}}},async deleteAllUserData(t){try{return await Promise.all([S.from("reviews").delete().eq("user_id",t),S.from("injections").delete().eq("user_id",t),S.from("schedules").delete().eq("user_id",t),S.from("inventory").delete().eq("user_id",t),S.from("ticket_messages").delete().match({user_id:t}),S.from("support_tickets").delete().eq("user_id",t)]),{success:!0,message:"All user data has been deleted"}}catch(s){return console.error("[Backup Service] Delete failed:",s),{success:!1,error:s.message}}},getBackupInfo(){return{provider:"Supabase",features:["Automatic daily database backups","Encrypted at rest and in transit","Point-in-time recovery available","Geo-redundant storage"],userExportFormats:["JSON","CSV"],gdprCompliant:!0,documentation:"https://supabase.com/docs/guides/platform/backups"}}},wl="_container_if0li_1",Sl="_infoCard_if0li_8",Nl="_infoHeader_if0li_15",kl="_featureList_if0li_34",Cl="_message_if0li_57",Il="_success_if0li_66",Dl="_error_if0li_72",Tl="_section_if0li_79",Ll="_exportButtons_if0li_102",Bl="_exportBtn_if0li_108",Al="_importLabel_if0li_132",Pl="_dangerZone_if0li_155",El="_deleteBtn_if0li_177",$l="_deleteConfirm_if0li_192",zl="_confirmButtons_if0li_213",Rl="_cancelBtn_if0li_218",Ml="_confirmDeleteBtn_if0li_227",Ol="_spin_if0li_242",fe={container:wl,infoCard:Sl,infoHeader:Nl,featureList:kl,message:Cl,success:Il,error:Dl,section:Tl,exportButtons:Ll,exportBtn:Bl,importLabel:Al,dangerZone:Pl,deleteBtn:El,deleteConfirm:$l,confirmButtons:zl,cancelBtn:Rl,confirmDeleteBtn:Ml,spin:Ol},Vl=()=>{const{user:t}=Se(),[s,a]=r.useState(!1),[i,o]=r.useState(null),[d,c]=r.useState(!1),[u,g]=r.useState(""),h=async()=>{if(t){a(!0),o(null);try{const p=await tt.exportUserData(t.id);if(p.success)tt.downloadJSON(p.data,p.filename),o({type:"success",text:"Data exported successfully!"});else throw new Error(p.error)}catch(p){o({type:"error",text:"Export failed: "+p.message})}finally{a(!1)}}},j=async()=>{if(t){a(!0),o(null);try{const p=await tt.exportAsCSV(t.id);if(p.success)Object.entries(p.files).forEach(([C,y])=>{y&&tt.downloadCSV(y,`peptide-tracker-${C}.csv`)}),o({type:"success",text:"CSV files exported successfully!"});else throw new Error(p.error)}catch(p){o({type:"error",text:"Export failed: "+p.message})}finally{a(!1)}}},I=async p=>{const C=p.target.files?.[0];if(!(!C||!t)){a(!0),o(null);try{const y=await C.text(),x=await tt.importUserData(t.id,y);if(x.success)o({type:"success",text:x.message});else throw new Error(x.error)}catch(y){o({type:"error",text:"Import failed: "+y.message})}finally{a(!1),p.target.value=""}}},D=async()=>{if(!(!t||u!=="DELETE")){a(!0),o(null);try{const p=await tt.deleteAllUserData(t.id);if(p.success)o({type:"success",text:p.message}),c(!1),g("");else throw new Error(p.error)}catch(p){o({type:"error",text:"Delete failed: "+p.message})}finally{a(!1)}}},z=tt.getBackupInfo();return e.jsxs("div",{className:fe.container,children:[e.jsxs("div",{className:fe.infoCard,children:[e.jsxs("div",{className:fe.infoHeader,children:[e.jsx(Ae,{size:24}),e.jsxs("div",{children:[e.jsx("h3",{children:"Your Data is Secure"}),e.jsxs("p",{children:["Backed by ",z.provider,"'s enterprise-grade infrastructure"]})]})]}),e.jsx("ul",{className:fe.featureList,children:z.features.map((p,C)=>e.jsxs("li",{children:[e.jsx(je,{size:16}),p]},C))})]}),i&&e.jsxs("div",{className:`${fe.message} ${fe[i.type]}`,children:[i.type==="success"?e.jsx(je,{size:18}):e.jsx(rt,{size:18}),i.text]}),e.jsxs("div",{className:fe.section,children:[e.jsxs("h3",{children:[e.jsx(Wt,{size:20})," Export Your Data"]}),e.jsx("p",{children:"Download a complete copy of all your data."}),e.jsxs("div",{className:fe.exportButtons,children:[e.jsxs("button",{onClick:h,disabled:s,className:fe.exportBtn,children:[s?e.jsx(ut,{size:18,className:fe.spin}):e.jsx(va,{size:18}),"Export as JSON"]}),e.jsxs("button",{onClick:j,disabled:s,className:fe.exportBtn,children:[s?e.jsx(ut,{size:18,className:fe.spin}):e.jsx(Ct,{size:18}),"Export as CSV"]})]})]}),e.jsxs("div",{className:fe.section,children:[e.jsxs("h3",{children:[e.jsx(hs,{size:20})," Import Data"]}),e.jsx("p",{children:"Restore from a previous JSON backup file."}),e.jsxs("label",{className:fe.importLabel,children:[e.jsx("input",{type:"file",accept:".json",onChange:I,disabled:s}),e.jsx(hs,{size:18}),"Choose JSON File"]})]}),e.jsxs("div",{className:fe.dangerZone,children:[e.jsxs("h3",{children:[e.jsx(Be,{size:20})," Danger Zone"]}),e.jsx("p",{children:"Permanently delete all your tracking data. This cannot be undone."}),d?e.jsxs("div",{className:fe.deleteConfirm,children:[e.jsxs("p",{children:["Type ",e.jsx("strong",{children:"DELETE"})," to confirm:"]}),e.jsx("input",{type:"text",value:u,onChange:p=>g(p.target.value),placeholder:"Type DELETE"}),e.jsxs("div",{className:fe.confirmButtons,children:[e.jsx("button",{onClick:()=>{c(!1),g("")},className:fe.cancelBtn,children:"Cancel"}),e.jsx("button",{onClick:D,disabled:u!=="DELETE"||s,className:fe.confirmDeleteBtn,children:s?e.jsx(ut,{size:18,className:fe.spin}):"Permanently Delete"})]})]}):e.jsx("button",{onClick:()=>c(!0),className:fe.deleteBtn,children:"Delete All My Data"})]})]})},Fl="_container_p86kk_1",Hl="_header_p86kk_8",Ul="_subtitle_p86kk_22",Gl="_layout_p86kk_28",Wl="_sidebar_p86kk_34",ql="_tabBtn_p86kk_40",Yl="_active_p86kk_62",Jl="_content_p86kk_69",Xl="_section_p86kk_76",Zl="_formGroup_p86kk_90",Kl="_hint_p86kk_107",Ql="_inputWithIcon_p86kk_114",ed="_disabledInput_p86kk_136",td="_infoCard_p86kk_142",sd="_statusActive_p86kk_172",ad="_statusInactive_p86kk_178",nd="_secondaryBtn_p86kk_184",id="_dangerBtn_p86kk_205",rd="_divider_p86kk_223",od="_sessionCard_p86kk_229",cd="_timestamp_p86kk_247",ld="_toggleGroup_p86kk_253",dd="_toggleItem_p86kk_259",md="_toggle_p86kk_253",ud="_slider_p86kk_301",hd="_description_p86kk_335",pd="_linkGroup_p86kk_341",gd="_link_p86kk_341",xd="_dangerZone_p86kk_360",_d="_dangerCard_p86kk_364",E={container:Fl,header:Hl,subtitle:Ul,layout:Gl,sidebar:Wl,tabBtn:ql,active:Yl,content:Jl,section:Xl,formGroup:Zl,hint:Kl,inputWithIcon:Ql,disabledInput:ed,infoCard:td,statusActive:sd,statusInactive:ad,secondaryBtn:nd,dangerBtn:id,divider:rd,sessionCard:od,timestamp:cd,toggleGroup:ld,toggleItem:dd,toggle:md,slider:ud,description:hd,linkGroup:pd,link:gd,dangerZone:xd,dangerCard:_d},fd=()=>{const{user:t,signOut:s}=Se(),{theme:a,toggleTheme:i,setThemeMode:o}=Os(),{t:d,i18n:c}=ta(),{injections:u}=Tt(),{isEnabled:g,isEnrolling:h,isLoading:j,qrCodeUrl:I,secret:D,startEnrollment:z,verifyAndEnable:p,disableTwoFactor:C,cancelEnrollment:y,error:x}=Qc(),[m,w]=r.useState(""),[l,N]=r.useState(!0),[k,B]=r.useState(!1),[F,A]=r.useState(null),[T,K]=r.useState("profile"),[X,n]=r.useState({full_name:"",email:"",age:"",gender:"prefer-not-to-say",weight_goal:"weight-loss"}),[L,H]=r.useState(a==="dark"),[V,v]=r.useState(!1),[G,P]=r.useState(!1),[J,ge]=r.useState({injectionReminders:!0,expirationAlerts:!0,weeklyReports:!0,priceAlerts:!1}),[_e,ye]=r.useState([]),[be,b]=r.useState(!1);r.useEffect(()=>{t&&(re(),$())},[t]);const $=async()=>{if(t){b(!0);try{const O=await Zc(t.id);ye(O)}catch(O){console.error("Error fetching reviews:",O)}finally{b(!1)}}},xe=async O=>{if(!confirm("Are you sure you want to delete this review?"))return;await Kc(O)&&ye(_e.filter($e=>$e.id!==O))},re=async()=>{try{N(!0);const{data:O,error:ue}=await S.from("profiles").select("*").eq("id",t.id).single();if(ue&&ue.code!=="PGRST116")throw ue;n(O?{full_name:O.full_name||"",email:t.email,age:O.age||"",gender:O.gender||"prefer-not-to-say",weight_goal:O.weight_goal||"weight-loss"}:$e=>({...$e,email:t.email}))}catch(O){console.error("Error fetching profile:",O)}finally{N(!1)}},Ue=async()=>{try{B(!0),A(null);const O={id:t.id,full_name:X.full_name,updated_at:new Date().toISOString()},{error:ue}=await S.from("profiles").upsert(O);if(ue)throw ue;A({type:"success",text:"Settings saved successfully"})}catch(O){console.error("Error updating profile:",O),A({type:"error",text:"Failed to save settings"})}finally{B(!1)}},Re=[{id:"profile",label:"Profile",icon:ot},{id:"activity",label:"Activity",icon:Ee},{id:"security",label:"Security",icon:Ot},{id:"notifications",label:"Notifications",icon:rs},{id:"data",label:"Data & Backup",icon:Qe},{id:"privacy",label:"Privacy",icon:Ae}];return l?e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(ut,{className:"animate-spin",size:32})}):e.jsxs("div",{className:E.container,children:[e.jsxs("div",{className:E.header,children:[e.jsx("h1",{children:"Settings"}),e.jsx("p",{className:E.subtitle,children:"Manage your account and preferences"})]}),e.jsxs("div",{className:E.layout,children:[e.jsx("div",{className:E.sidebar,children:Re.map(O=>{const ue=O.icon;return e.jsxs("button",{className:`${E.tabBtn} ${T===O.id?E.active:""}`,onClick:()=>K(O.id),children:[e.jsx(ue,{size:20}),e.jsx("span",{children:O.label})]},O.id)})}),e.jsxs("div",{className:E.content,children:[T==="profile"&&e.jsxs("div",{className:E.section,children:[e.jsx("h2",{children:"Profile Information"}),e.jsxs("div",{className:E.formGroup,children:[e.jsx("label",{children:"Full Name"}),e.jsx("input",{type:"text",placeholder:"John Doe",value:X.full_name,onChange:O=>n({...X,full_name:O.target.value})})]}),e.jsxs("div",{className:E.formGroup,children:[e.jsx("label",{children:"Email Address"}),e.jsxs("div",{className:E.inputWithIcon,children:[e.jsx(Dt,{size:18}),e.jsx("input",{type:"email",value:X.email,disabled:!0,className:E.disabledInput,style:{paddingLeft:"48px"}})]})]}),e.jsxs("div",{className:E.formGroup,children:[e.jsx("label",{children:"Age (Optional)"}),e.jsx("input",{type:"number",placeholder:"30",value:X.age,onChange:O=>n({...X,age:O.target.value})}),e.jsx("span",{className:E.hint,children:"Used for personalized recommendations"})]}),e.jsxs("div",{className:E.formGroup,children:[e.jsx("label",{children:"Gender (Optional)"}),e.jsxs("select",{value:X.gender,onChange:O=>n({...X,gender:O.target.value}),children:[e.jsx("option",{value:"prefer-not-to-say",children:"Prefer not to say"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{className:E.formGroup,children:[e.jsx("label",{children:"Weight Goal"}),e.jsxs("select",{value:X.weight_goal,onChange:O=>n({...X,weight_goal:O.target.value}),children:[e.jsx("option",{value:"weight-loss",children:"Weight Loss"}),e.jsx("option",{value:"muscle-gain",children:"Muscle Gain"}),e.jsx("option",{value:"recovery",children:"Recovery & Healing"}),e.jsx("option",{value:"anti-aging",children:"Anti-Aging"}),e.jsx("option",{value:"performance",children:"Performance Enhancement"}),e.jsx("option",{value:"other",children:"Other"})]})]}),F&&e.jsx("div",{className:`alert ${F.type==="error"?"alert-error":"alert-success"}`,style:{marginBottom:"1rem",padding:"10px",borderRadius:"8px",background:F.type==="error"?"rgba(255,0,0,0.1)":"rgba(0,255,0,0.1)",color:F.type==="error"?"#ff4d4d":"#4dff4d"},children:F.text}),e.jsx("button",{className:"btn-primary",onClick:Ue,disabled:k,children:k?"Saving...":"Save Changes"})]}),T==="activity"&&e.jsxs("div",{className:E.section,children:[e.jsx("h2",{children:"Your Activity"}),e.jsx("p",{className:E.subtitle,style:{marginBottom:"1.5rem"},children:"View your reviews, ratings, and contributions"}),e.jsxs("div",{style:{marginBottom:"2rem"},children:[e.jsxs("h3",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx(Ze,{size:20,color:"var(--accent-primary)"}),"Your Reviews (",_e.length,")"]}),be?e.jsxs("div",{style:{textAlign:"center",padding:"2rem"},children:[e.jsx(ut,{className:"animate-spin",size:24}),e.jsx("p",{style:{color:"var(--text-secondary)",marginTop:"0.5rem"},children:"Loading reviews..."})]}):_e.length===0?e.jsxs("div",{style:{padding:"2rem",textAlign:"center",background:"rgba(15, 23, 42, 0.3)",borderRadius:"12px",border:"1px solid var(--glass-border)"},children:[e.jsx(Ze,{size:32,color:"var(--text-tertiary)",style:{marginBottom:"0.5rem"}}),e.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"0.5rem"},children:"No reviews yet"}),e.jsx("p",{style:{color:"var(--text-tertiary)",fontSize:"0.875rem"},children:"Share your experience with peptides by leaving reviews on their detail pages."}),e.jsx(pe,{to:"/encyclopedia",className:"btn-primary",style:{marginTop:"1rem",display:"inline-block"},children:"Browse Peptides"})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:_e.map(O=>e.jsxs("div",{className:"card glass-panel",style:{padding:"1.25rem",display:"flex",flexDirection:"column",gap:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsxs(pe,{to:`/encyclopedia/${encodeURIComponent(O.peptide_name)}`,style:{fontSize:"1.1rem",fontWeight:"600",color:"var(--accent-primary)",textDecoration:"none",display:"flex",alignItems:"center",gap:"0.5rem"},children:[O.peptide_name,e.jsx(os,{size:14})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginTop:"0.25rem"},children:[e.jsx("div",{style:{display:"flex",gap:"2px"},children:[1,2,3,4,5].map(ue=>e.jsx(He,{size:14,fill:ue<=O.rating?"#fbbf24":"none",color:ue<=O.rating?"#fbbf24":"#4b5563"},ue))}),e.jsx("span",{style:{color:"var(--text-tertiary)",fontSize:"0.75rem"},children:new Date(O.created_at).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})]})]}),e.jsx("button",{onClick:()=>xe(O.id),style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.2)",borderRadius:"6px",padding:"0.5rem",cursor:"pointer",color:"#ef4444",display:"flex",alignItems:"center",justifyContent:"center"},title:"Delete review",children:e.jsx(Be,{size:16})})]}),O.comment&&e.jsxs("p",{style:{color:"var(--text-secondary)",fontSize:"0.9rem",lineHeight:"1.5",margin:0},children:['"',O.comment,'"']})]},O.id))})]}),e.jsx("div",{className:E.divider}),e.jsx("h3",{style:{marginBottom:"1rem"},children:"Activity Summary"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem"},children:[e.jsxs("div",{className:"card glass-panel",style:{padding:"1.25rem",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"2rem",fontWeight:"700",color:"var(--accent-primary)"},children:_e.length}),e.jsx("div",{style:{color:"var(--text-secondary)",fontSize:"0.875rem"},children:"Reviews Written"})]}),e.jsxs("div",{className:"card glass-panel",style:{padding:"1.25rem",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"2rem",fontWeight:"700",color:"#fbbf24"},children:_e.length>0?(_e.reduce((O,ue)=>O+ue.rating,0)/_e.length).toFixed(1):"—"}),e.jsx("div",{style:{color:"var(--text-secondary)",fontSize:"0.875rem"},children:"Avg Rating Given"})]}),e.jsxs("div",{className:"card glass-panel",style:{padding:"1.25rem",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"2rem",fontWeight:"700",color:"var(--success)"},children:new Set(_e.map(O=>O.peptide_name)).size}),e.jsx("div",{style:{color:"var(--text-secondary)",fontSize:"0.875rem"},children:"Peptides Reviewed"})]})]})]}),T==="security"&&e.jsxs("div",{className:E.section,children:[e.jsx("h2",{children:"Security Settings"}),e.jsxs("div",{className:`card ${E.infoCard}`,children:[e.jsx(Ot,{size:24}),e.jsxs("div",{children:[e.jsx("h3",{children:"Password"}),e.jsx("p",{children:"Last changed 30 days ago"})]}),e.jsx("button",{className:E.secondaryBtn,children:"Change Password"})]}),e.jsxs("div",{className:E.formGroup,children:[e.jsx("label",{children:"Current Password"}),e.jsx("input",{type:"password",placeholder:"Enter current password"})]}),e.jsxs("div",{className:E.formGroup,children:[e.jsx("label",{children:"New Password"}),e.jsx("input",{type:"password",placeholder:"Enter new password"})]}),e.jsxs("div",{className:E.formGroup,children:[e.jsx("label",{children:"Confirm New Password"}),e.jsx("input",{type:"password",placeholder:"Confirm new password"})]}),e.jsx("div",{className:E.divider}),e.jsx("h3",{children:"Two-Factor Authentication"}),e.jsxs("div",{className:`card ${E.infoCard}`,children:[e.jsx(Ae,{size:24}),e.jsxs("div",{children:[e.jsx("h3",{children:"2FA Status"}),j?e.jsx("p",{className:E.statusInactive,children:"Loading..."}):g?e.jsx("p",{className:E.statusActive,children:"Enabled"}):e.jsx("p",{className:E.statusInactive,children:"Not Enabled"})]}),!g&&!h&&!j&&e.jsx("button",{className:E.secondaryBtn,onClick:z,children:"Enable 2FA"}),g&&e.jsx("button",{className:E.dangerBtn,onClick:C,children:"Disable 2FA"})]}),x&&e.jsx("div",{className:"alert alert-error",style:{marginBottom:"1rem",padding:"10px",borderRadius:"8px",background:"rgba(255,0,0,0.1)",color:"#ff4d4d"},children:x}),h&&e.jsxs("div",{className:"card glass-panel",style:{padding:"1.5rem",marginBottom:"1.5rem"},children:[e.jsx("h4",{style:{marginTop:0,color:"var(--text-primary)"},children:"Setup 2FA"}),e.jsx("p",{style:{color:"var(--text-secondary)",marginBottom:"1rem"},children:"Scan this QR code with your authenticator app (like Google Authenticator or Authy)."}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:"1.5rem"},children:[I&&e.jsx("div",{style:{background:"white",padding:"10px",borderRadius:"8px",marginBottom:"1rem"},children:e.jsx("img",{src:I,alt:"2FA QR Code",width:"180",height:"180"})}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("p",{style:{fontSize:"0.8rem",color:"var(--text-tertiary)",marginBottom:"0.25rem"},children:"Manual Entry Code:"}),e.jsx("code",{style:{display:"block",background:"var(--bg-input)",padding:"0.5rem 1rem",borderRadius:"4px",fontFamily:"monospace",letterSpacing:"1px",color:"var(--accent-primary)",border:"1px solid var(--glass-border)"},children:D})]})]}),e.jsxs("div",{className:E.formGroup,children:[e.jsx("label",{children:"Verification Code"}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("input",{type:"text",placeholder:"Enter 6-digit code",value:m,onChange:O=>w(O.target.value.replace(/\D/g,"").slice(0,6)),style:{flex:1}}),e.jsx("button",{className:"btn-primary",onClick:()=>p(m),disabled:m.length!==6,children:"Verify"})]})]}),e.jsx("button",{className:E.secondaryBtn,onClick:()=>{y(),w("")},style:{width:"100%",marginTop:"0.5rem",justifyContent:"center"},children:"Cancel Setup"})]}),e.jsx("div",{className:E.divider}),e.jsx("h3",{children:"Active Sessions"}),e.jsx("div",{className:`card ${E.sessionCard}`,children:e.jsxs("div",{children:[e.jsx("h4",{children:"Current Device"}),e.jsx("p",{children:"MacBook Pro • Chrome • San Francisco, CA"}),e.jsx("span",{className:E.timestamp,children:"Active now"})]})}),e.jsx("button",{className:E.dangerBtn,onClick:s,children:"Sign Out All Devices"})]}),T==="notifications"&&e.jsxs("div",{className:E.section,children:[e.jsx("h2",{children:"Notification Preferences"}),e.jsxs("div",{className:E.toggleGroup,children:[e.jsxs("div",{className:E.settingItem,children:[e.jsxs("div",{className:E.settingInfo,children:[e.jsx("span",{className:E.settingLabel,children:"Injection Reminders"}),e.jsx("span",{className:E.settingDescription,children:"Get notified when it's time for your next dose"})]}),e.jsxs("label",{className:E.toggle,children:[e.jsx("input",{type:"checkbox",checked:J.email_reminders,onChange:async O=>{O.target.checked?await as.requestPermission()?(ge({...J,email_reminders:!0}),as.sendNotification("Reminders Enabled",{body:"You will now receive injection reminders."})):alert("Please enable notifications in your browser settings."):ge({...J,email_reminders:!1})}}),e.jsx("span",{className:E.slider})]})]}),e.jsxs("div",{className:E.toggleItem,children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Expiration Alerts"}),e.jsx("p",{children:"Warnings when reconstituted peptides are expiring"})]}),e.jsxs("label",{className:E.toggle,children:[e.jsx("input",{type:"checkbox",checked:J.expirationAlerts,onChange:O=>ge({...J,expirationAlerts:O.target.checked})}),e.jsx("span",{className:E.slider})]})]}),e.jsxs("div",{className:E.toggleItem,children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Weekly Reports"}),e.jsx("p",{children:"Summary of your progress and insights"})]}),e.jsxs("label",{className:E.toggle,children:[e.jsx("input",{type:"checkbox",checked:J.weeklyReports,onChange:O=>ge({...J,weeklyReports:O.target.checked})}),e.jsx("span",{className:E.slider})]})]}),e.jsxs("div",{className:E.toggleItem,children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Price Alerts"}),e.jsx("p",{children:"Notify when peptide prices drop significantly"})]}),e.jsxs("label",{className:E.toggle,children:[e.jsx("input",{type:"checkbox",checked:J.priceAlerts,onChange:O=>ge({...J,priceAlerts:O.target.checked})}),e.jsx("span",{className:E.slider})]})]})]}),e.jsx("div",{className:E.divider}),e.jsx("h3",{children:"Appearance"}),e.jsxs("div",{className:E.toggleItem,children:[e.jsxs("div",{children:[e.jsxs("h3",{children:[a==="dark"?e.jsx(ba,{size:18}):e.jsx(wa,{size:18})," Theme"]}),e.jsx("p",{children:"Switch between dark and light mode"})]}),e.jsxs("label",{className:E.toggle,children:[e.jsx("input",{type:"checkbox",checked:a==="dark",onChange:()=>i()}),e.jsx("span",{className:E.slider})]})]}),e.jsxs("div",{className:E.toggleItem,children:[e.jsxs("div",{children:[e.jsxs("h3",{children:[e.jsx(Sa,{size:18})," Language"]}),e.jsx("p",{children:"Select your preferred language"})]}),e.jsxs("select",{value:c.language,onChange:O=>{c.changeLanguage(O.target.value),localStorage.setItem("peptide_language",O.target.value)},style:{background:"var(--glass-bg)",border:"1px solid var(--glass-border)",borderRadius:"8px",padding:"8px 12px",color:"var(--text-primary)",cursor:"pointer"},children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"es",children:"Español"})]})]}),e.jsx("div",{className:E.divider}),e.jsxs("h3",{children:[e.jsx(Mt,{size:18})," Share Progress"]}),e.jsx("p",{className:E.description,children:"Generate a shareable image of your progress stats"}),e.jsxs("button",{className:E.secondaryBtn,onClick:()=>v(!0),children:[e.jsx(Mt,{size:18}),"Create Share Image"]}),e.jsx("div",{style:{marginTop:"1.5rem"},children:e.jsx("button",{className:E.secondaryBtn,style:{fontSize:"0.8rem",padding:"0.5rem 1rem"},onClick:async()=>{confirm("Send a test reminder email to "+t.email+"?")&&(await Jc.sendTestReminder(t.email),alert("Test email sent! (Check console for simulation)"))},children:"Send Test Email"})}),e.jsx("button",{className:"btn-primary",style:{marginTop:"1.5rem"},children:"Save Preferences"})]}),T==="data"&&e.jsxs("div",{className:E.section,children:[e.jsx("h2",{children:"Data & Backup"}),e.jsx("p",{className:E.subtitle,style:{marginBottom:"1.5rem"},children:"Export, import, and manage your personal data"}),e.jsx(Vl,{})]}),T==="privacy"&&e.jsxs("div",{className:E.section,children:[e.jsx("h2",{children:"Privacy & Data Management"}),e.jsxs("div",{className:`card ${E.infoCard}`,children:[e.jsx(Ae,{size:24}),e.jsxs("div",{children:[e.jsx("h3",{children:"Data Encryption"}),e.jsx("p",{children:"All your data is encrypted end-to-end"})]}),e.jsx("span",{className:E.statusActive,children:"Active"})]}),e.jsx("div",{className:E.divider}),e.jsxs("h3",{children:[e.jsx(Wt,{size:18})," Export Your Data"]}),e.jsx("p",{className:E.description,children:"Download your injection history and data. Choose your preferred format."}),e.jsxs("div",{style:{display:"flex",gap:"12px",flexWrap:"wrap"},children:[e.jsxs("button",{className:E.secondaryBtn,disabled:G||u.length===0,onClick:async()=>{P(!0);try{Xc.toCSV(u),A({type:"success",text:"CSV exported successfully!"})}catch(O){A({type:"error",text:O.message})}finally{P(!1)}},children:[e.jsx(Ct,{size:18}),"Export as CSV"]}),e.jsxs("button",{className:E.secondaryBtn,style:{background:"linear-gradient(135deg, #4f46e5 0%, #3b82f6 100%)",color:"white",border:"none",boxShadow:"0 4px 6px rgba(79, 70, 229, 0.2)"},disabled:G||u.length===0,onClick:async()=>{P(!0);try{const{generatePDFReport:O}=await le(async()=>{const{generatePDFReport:ue}=await import("./pdfService-B2mUxKie.js");return{generatePDFReport:ue}},__vite__mapDeps([3,2,0,1]));O(u,t),A({type:"success",text:"PDF Report downloaded!"})}catch(O){console.error(O),A({type:"error",text:"Failed to generate PDF"})}finally{P(!1)}},children:[e.jsx(Ct,{size:18}),"Generate Medical Report (PDF)"]})]}),u.length===0&&e.jsx("p",{style:{color:"var(--text-muted)",fontSize:"0.875rem",marginTop:"8px"},children:"No injection data to export yet."}),e.jsx("div",{className:E.divider}),e.jsx("h3",{children:"Privacy Settings"}),e.jsxs("div",{className:E.toggleGroup,children:[e.jsxs("div",{className:E.toggleItem,children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Anonymous Analytics"}),e.jsx("p",{children:"Help us improve by sharing anonymized usage data"})]}),e.jsxs("label",{className:E.toggle,children:[e.jsx("input",{type:"checkbox",defaultChecked:!0}),e.jsx("span",{className:E.slider})]})]}),e.jsxs("div",{className:E.toggleItem,children:[e.jsxs("div",{children:[e.jsx("h3",{children:"Marketing Emails"}),e.jsx("p",{children:"Receive updates about new features and tips"})]}),e.jsxs("label",{className:E.toggle,children:[e.jsx("input",{type:"checkbox"}),e.jsx("span",{className:E.slider})]})]})]}),e.jsx("div",{className:E.divider}),e.jsx("h3",{children:"Legal Documents"}),e.jsxs("div",{className:E.linkGroup,children:[e.jsx("a",{href:"/terms",className:E.link,children:"Terms of Service"}),e.jsx("a",{href:"/privacy",className:E.link,children:"Privacy Policy"}),e.jsx("a",{href:"/disclaimer",className:E.link,children:"Medical Disclaimer"})]}),e.jsx("div",{className:E.divider}),e.jsx("h3",{className:E.dangerZone,children:"Danger Zone"}),e.jsxs("div",{className:`card ${E.dangerCard}`,children:[e.jsx(Be,{size:24}),e.jsxs("div",{children:[e.jsx("h3",{children:"Delete Account"}),e.jsx("p",{children:"Permanently delete your account and all associated data. This action cannot be undone."})]}),e.jsx("button",{className:E.dangerBtn,children:"Delete Account"})]})]})]})]}),V&&e.jsx(bl,{onClose:()=>v(!1)})]})},jd="_container_o3gd5_1",yd="_header_o3gd5_8",vd="_lastUpdated_o3gd5_28",bd="_content_o3gd5_33",wd="_warning_o3gd5_79",Sd="_highlight_o3gd5_97",Nd="_acknowledgment_o3gd5_111",Le={container:jd,header:yd,lastUpdated:vd,content:bd,warning:wd,highlight:Sd,acknowledgment:Nd},kd=()=>e.jsxs("div",{className:Le.container,children:[e.jsxs("div",{className:Le.header,children:[e.jsx(Ct,{size:32}),e.jsx("h1",{children:"Terms of Service"}),e.jsx("p",{className:Le.lastUpdated,children:"Last Updated: November 24, 2025"})]}),e.jsxs("div",{className:`card ${Le.content}`,children:[e.jsxs("section",{children:[e.jsx("h2",{children:"1. Acceptance of Terms"}),e.jsx("p",{children:'By accessing and using Peptide Tracker ("the Service"), you accept and agree to be bound by the terms and provision of this agreement. If you do not agree to these terms, please do not use the Service.'})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"2. Description of Service"}),e.jsx("p",{children:"Peptide Tracker is a personal tracking and informational tool designed to help users:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Track peptide injections and dosages"}),e.jsx("li",{children:"Calculate reconstitution measurements"}),e.jsx("li",{children:"Monitor peptide half-life decay"}),e.jsx("li",{children:"Compare vendor pricing"}),e.jsx("li",{children:"Schedule and plan peptide protocols"})]}),e.jsx("p",{children:e.jsx("strong",{children:"The Service is NOT a medical device, healthcare provider, or medical advice platform."})})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"3. Medical Disclaimer"}),e.jsxs("div",{className:Le.warning,children:[e.jsx("p",{children:e.jsx("strong",{children:"IMPORTANT: READ CAREFULLY"})}),e.jsxs("ul",{children:[e.jsx("li",{children:"This Service is for informational and tracking purposes only"}),e.jsx("li",{children:"It does NOT provide medical advice, diagnosis, or treatment"}),e.jsx("li",{children:"Always consult with a qualified healthcare provider before starting any peptide protocol"}),e.jsx("li",{children:"Never disregard professional medical advice or delay seeking it because of information from this Service"}),e.jsx("li",{children:"The Service is not a substitute for professional medical care"}),e.jsx("li",{children:"In case of medical emergency, call 911 or your local emergency services immediately"})]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"4. User Responsibilities"}),e.jsx("p",{children:"You agree to:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Provide accurate information when using the Service"}),e.jsx("li",{children:"Use the Service only for lawful purposes"}),e.jsx("li",{children:"Not share your account credentials with others"}),e.jsx("li",{children:"Maintain the security of your account"}),e.jsx("li",{children:"Comply with all applicable laws and regulations"}),e.jsx("li",{children:"Use peptides only under proper medical supervision"}),e.jsx("li",{children:"Verify all calculations and information independently"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"5. Prohibited Uses"}),e.jsx("p",{children:"You may NOT use the Service to:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Violate any laws or regulations"}),e.jsx("li",{children:"Distribute controlled substances illegally"}),e.jsx("li",{children:"Provide medical advice to others"}),e.jsx("li",{children:"Impersonate any person or entity"}),e.jsx("li",{children:"Transmit viruses or malicious code"}),e.jsx("li",{children:"Attempt to gain unauthorized access to the Service"}),e.jsx("li",{children:"Scrape or harvest data from the Service"}),e.jsx("li",{children:"Use the Service for commercial purposes without authorization"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"6. Accuracy of Information"}),e.jsx("p",{children:"While we strive to provide accurate information, we make no warranties or guarantees about:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"The accuracy of calculations"}),e.jsx("li",{children:"The completeness of peptide information"}),e.jsx("li",{children:"The reliability of vendor pricing data"}),e.jsx("li",{children:"The effectiveness of suggested protocols"})]}),e.jsx("p",{children:e.jsx("strong",{children:"Always verify all information with qualified healthcare professionals and trusted sources."})})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"7. Limitation of Liability"}),e.jsx("p",{children:"TO THE MAXIMUM EXTENT PERMITTED BY LAW, PEPTIDE TRACKER AND ITS OPERATORS SHALL NOT BE LIABLE FOR:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Any health issues or adverse reactions from peptide use"}),e.jsx("li",{children:"Errors or inaccuracies in calculations or information"}),e.jsx("li",{children:"Loss of data or service interruptions"}),e.jsx("li",{children:"Any indirect, incidental, or consequential damages"}),e.jsx("li",{children:"Decisions made based on information from the Service"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"8. Data and Privacy"}),e.jsx("p",{children:"Your use of the Service is also governed by our Privacy Policy. By using the Service, you consent to:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Collection and storage of your health tracking data"}),e.jsx("li",{children:"Use of cookies and similar technologies"}),e.jsx("li",{children:"Data processing as described in our Privacy Policy"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"9. Intellectual Property"}),e.jsx("p",{children:"All content, features, and functionality of the Service are owned by Peptide Tracker and are protected by copyright, trademark, and other intellectual property laws."})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"10. Third-Party Links and Services"}),e.jsx("p",{children:"The Service may contain links to third-party websites or services (such as peptide vendors). We are not responsible for:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"The content or practices of third-party sites"}),e.jsx("li",{children:"Product quality from vendors"}),e.jsx("li",{children:"Transactions with third parties"}),e.jsx("li",{children:"Accuracy of third-party pricing information"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"11. Account Termination"}),e.jsx("p",{children:"We reserve the right to suspend or terminate your account at any time for:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Violation of these Terms"}),e.jsx("li",{children:"Fraudulent or illegal activity"}),e.jsx("li",{children:"Abuse of the Service"}),e.jsx("li",{children:"Any reason at our sole discretion"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"12. Changes to Terms"}),e.jsx("p",{children:"We may modify these Terms at any time. Continued use of the Service after changes constitutes acceptance of the new Terms. We will notify users of significant changes via email or in-app notification."})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"13. Governing Law"}),e.jsx("p",{children:"These Terms shall be governed by and construed in accordance with the laws of [Your Jurisdiction], without regard to its conflict of law provisions."})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"14. Contact Information"}),e.jsx("p",{children:"For questions about these Terms, please contact us at:"}),e.jsxs("p",{children:["Email: legal@peptidetracker.com",e.jsx("br",{}),"Address: [Your Business Address]"]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"15. Severability"}),e.jsx("p",{children:"If any provision of these Terms is found to be unenforceable or invalid, that provision shall be limited or eliminated to the minimum extent necessary so that these Terms shall otherwise remain in full force and effect."})]}),e.jsx("div",{className:Le.acknowledgment,children:e.jsx("p",{children:e.jsx("strong",{children:"BY USING THIS SERVICE, YOU ACKNOWLEDGE THAT YOU HAVE READ, UNDERSTOOD, AND AGREE TO BE BOUND BY THESE TERMS."})})})]})]}),Cd=()=>e.jsxs("div",{className:Le.container,children:[e.jsxs("div",{className:Le.header,children:[e.jsx(Ae,{size:32}),e.jsx("h1",{children:"Privacy Policy"}),e.jsx("p",{className:Le.lastUpdated,children:"Last Updated: November 24, 2025"})]}),e.jsxs("div",{className:`card ${Le.content}`,children:[e.jsxs("section",{children:[e.jsx("h2",{children:"1. Introduction"}),e.jsx("p",{children:'Peptide Tracker ("we," "our," or "us") is committed to protecting your privacy. This Privacy Policy explains how we collect, use, disclose, and safeguard your information when you use our Service.'}),e.jsx("p",{children:e.jsx("strong",{children:"Please read this privacy policy carefully. If you do not agree with the terms of this privacy policy, please do not access the Service."})})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"2. Information We Collect"}),e.jsx("h3",{children:"2.1 Personal Information"}),e.jsx("p",{children:"We may collect personal information that you voluntarily provide, including:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Name and email address"}),e.jsx("li",{children:"Account credentials (username, password)"}),e.jsx("li",{children:"Profile information (age, gender, optional)"}),e.jsx("li",{children:"Payment information (processed by third-party payment processors)"})]}),e.jsx("h3",{children:"2.2 Health Information"}),e.jsx("p",{children:"As a health tracking application, we collect sensitive health data, including:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Peptide injection records (type, dosage, date, time)"}),e.jsx("li",{children:"Body measurements and weight"}),e.jsx("li",{children:"Side effects and notes"}),e.jsx("li",{children:"Photos (if you choose to upload them)"}),e.jsx("li",{children:"Lab results (if you choose to upload them)"}),e.jsx("li",{children:"Health goals and preferences"})]}),e.jsxs("p",{className:Le.warning,children:[e.jsx("strong",{children:"Important:"})," This is Protected Health Information (PHI) under HIPAA. We take extensive measures to protect this data."]}),e.jsx("h3",{children:"2.3 Usage Data"}),e.jsx("p",{children:"We automatically collect certain information when you use the Service:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Device information (type, operating system, browser)"}),e.jsx("li",{children:"IP address and location data"}),e.jsx("li",{children:"Usage patterns and feature interactions"}),e.jsx("li",{children:"Log data and error reports"}),e.jsx("li",{children:"Cookies and similar tracking technologies"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"3. How We Use Your Information"}),e.jsx("p",{children:"We use the collected information to:"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Provide the Service:"})," Track injections, calculate dosages, generate reports"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Improve the Service:"})," Analyze usage patterns, fix bugs, develop new features"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Personalize Experience:"})," Customize recommendations and content"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Communicate:"})," Send notifications, updates, and support messages"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Security:"})," Detect and prevent fraud, abuse, and security incidents"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Legal Compliance:"})," Comply with legal obligations and enforce our Terms"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Analytics:"})," Understand user behavior and improve our Service (anonymized data)"]})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"4. Data Sharing and Disclosure"}),e.jsx("h3",{children:"4.1 We DO NOT Sell Your Data"}),e.jsx("p",{className:Le.highlight,children:e.jsx("strong",{children:"We will never sell your personal or health information to third parties."})}),e.jsx("h3",{children:"4.2 When We May Share Data"}),e.jsx("p",{children:"We may share your information only in the following circumstances:"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"With Your Consent:"})," When you explicitly authorize us to share your data"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Service Providers:"})," Third-party vendors who help us operate the Service (hosting, analytics, payment processing)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Healthcare Providers:"})," If you use our telehealth features and authorize sharing"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Legal Requirements:"})," When required by law, court order, or government request"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Business Transfers:"})," In connection with a merger, acquisition, or sale of assets"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Safety and Security:"})," To protect the rights, property, or safety of us, our users, or others"]})]}),e.jsx("h3",{children:"4.3 Anonymized Data"}),e.jsx("p",{children:"We may use and share aggregated, anonymized data that cannot identify you personally for research, analytics, and improving the Service."})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"5. Data Security"}),e.jsx("p",{children:"We implement industry-standard security measures to protect your data:"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Encryption:"})," All data is encrypted in transit (SSL/TLS) and at rest (AES-256)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Access Controls:"})," Strict authentication and authorization mechanisms"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Regular Audits:"})," Security assessments and penetration testing"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Employee Training:"})," Staff trained on data protection and privacy"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Secure Infrastructure:"})," Hosted on secure, compliant cloud platforms"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Backup and Recovery:"})," Regular backups with disaster recovery procedures"]})]}),e.jsxs("p",{className:Le.warning,children:[e.jsx("strong",{children:"Note:"})," While we use reasonable security measures, no method of transmission over the Internet or electronic storage is 100% secure. We cannot guarantee absolute security."]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"6. Your Privacy Rights"}),e.jsx("p",{children:"Depending on your location, you may have the following rights:"}),e.jsx("h3",{children:"6.1 Access and Portability"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Request a copy of your personal data"}),e.jsx("li",{children:"Export your data in a machine-readable format"})]}),e.jsx("h3",{children:"6.2 Correction and Update"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Update or correct inaccurate information"}),e.jsx("li",{children:"Complete incomplete data"})]}),e.jsx("h3",{children:"6.3 Deletion"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Request deletion of your account and data"}),e.jsx("li",{children:"Right to be forgotten (subject to legal requirements)"})]}),e.jsx("h3",{children:"6.4 Restriction and Objection"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Restrict processing of your data"}),e.jsx("li",{children:"Object to certain uses of your data"})]}),e.jsx("h3",{children:"6.5 Withdraw Consent"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Withdraw consent for data processing at any time"}),e.jsx("li",{children:"Opt-out of marketing communications"})]}),e.jsx("p",{children:"To exercise these rights, contact us at privacy@peptidetracker.com"})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"7. Data Retention"}),e.jsx("p",{children:"We retain your data for as long as:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Your account is active"}),e.jsx("li",{children:"Needed to provide the Service"}),e.jsx("li",{children:"Required by law or regulation"}),e.jsx("li",{children:"Necessary for legitimate business purposes"})]}),e.jsx("p",{children:"When you delete your account, we will delete or anonymize your personal data within 30 days, except where we are legally required to retain it."})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"8. Cookies and Tracking Technologies"}),e.jsx("p",{children:"We use cookies and similar technologies to:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Remember your preferences and settings"}),e.jsx("li",{children:"Authenticate your account"}),e.jsx("li",{children:"Analyze usage and improve the Service"}),e.jsx("li",{children:"Provide personalized content"})]}),e.jsx("p",{children:"You can control cookies through your browser settings. Note that disabling cookies may limit functionality of the Service."})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"9. Third-Party Services"}),e.jsx("p",{children:"Our Service may integrate with third-party services:"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Payment Processors:"})," Stripe, PayPal (we do not store credit card information)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Analytics:"})," Google Analytics (anonymized)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Cloud Hosting:"})," AWS, Google Cloud, or similar"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Email Services:"})," SendGrid, Mailgun, or similar"]})]}),e.jsx("p",{children:"These third parties have their own privacy policies. We encourage you to review them."})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"10. Children's Privacy"}),e.jsx("p",{children:"The Service is not intended for individuals under 18 years of age. We do not knowingly collect personal information from children. If you believe we have collected information from a child, please contact us immediately."})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"11. International Data Transfers"}),e.jsx("p",{children:"Your information may be transferred to and processed in countries other than your own. We ensure appropriate safeguards are in place to protect your data in accordance with this Privacy Policy."})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"12. California Privacy Rights (CCPA)"}),e.jsx("p",{children:"If you are a California resident, you have additional rights under the California Consumer Privacy Act:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Right to know what personal information is collected"}),e.jsx("li",{children:"Right to know if personal information is sold or disclosed"}),e.jsx("li",{children:"Right to say no to the sale of personal information"}),e.jsx("li",{children:"Right to access your personal information"}),e.jsx("li",{children:"Right to equal service and price"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"13. GDPR Compliance (European Users)"}),e.jsx("p",{children:"If you are in the European Economic Area (EEA), you have rights under the General Data Protection Regulation:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Legal basis for processing (consent, contract, legitimate interest)"}),e.jsx("li",{children:"Right to lodge a complaint with supervisory authority"}),e.jsx("li",{children:"Right to data portability"}),e.jsx("li",{children:"Automated decision-making protections"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"14. Changes to This Privacy Policy"}),e.jsx("p",{children:"We may update this Privacy Policy from time to time. We will notify you of significant changes by:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Posting the new Privacy Policy on this page"}),e.jsx("li",{children:'Updating the "Last Updated" date'}),e.jsx("li",{children:"Sending an email notification (for material changes)"}),e.jsx("li",{children:"In-app notification"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{children:"15. Contact Us"}),e.jsx("p",{children:"For questions or concerns about this Privacy Policy or our data practices:"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," privacy@peptidetracker.com",e.jsx("br",{}),e.jsx("strong",{children:"Data Protection Officer:"})," dpo@peptidetracker.com",e.jsx("br",{}),e.jsx("strong",{children:"Address:"})," [Your Business Address]"]})]}),e.jsx("div",{className:Le.acknowledgment,children:e.jsx("p",{children:e.jsx("strong",{children:"BY USING THIS SERVICE, YOU ACKNOWLEDGE THAT YOU HAVE READ AND UNDERSTOOD THIS PRIVACY POLICY."})})})]})]}),vs="G-2V2TNJFR16",Id=()=>{const t=[/bot/i,/crawl/i,/spider/i,/slurp/i,/mediapartners/i,/googlebot/i,/bingbot/i,/yandex/i,/baiduspider/i,/facebookexternalhit/i,/twitterbot/i,/rogerbot/i,/linkedinbot/i,/embedly/i,/quora link preview/i,/showyoubot/i,/outbrain/i,/pinterest/i,/slackbot/i,/vkShare/i,/W3C_Validator/i,/whatsapp/i,/applebot/i,/headless/i,/phantom/i,/selenium/i,/puppeteer/i,/lighthouse/i,/pagespeed/i,/gtmetrix/i],s=navigator.userAgent||"";return!!(t.some(a=>a.test(s))||navigator.webdriver||!navigator.languages||navigator.languages.length===0)};let bt=null;const ls=()=>(bt!==null||(bt=!Id(),bt||console.log("[Analytics] Bot detected, analytics disabled")),bt),Dd=()=>{if(!ls()){console.log("[Analytics] Skipping init for bot");return}if(console.log("Analytics initialized"),!document.querySelector('script[src*="googletagmanager"]')){let s=function(){window.dataLayer.push(arguments)};const t=document.createElement("script");t.async=!0,t.src=`https://www.googletagmanager.com/gtag/js?id=${vs}`,document.head.appendChild(t),window.dataLayer=window.dataLayer||[],window.gtag=s,s("js",new Date),s("config",vs)}},Td=(t,s,a=null,i=null)=>{ls()&&(console.log(`[Analytics] Event: ${t} - ${s}`,{label:a,value:i}),window.gtag&&window.gtag("event",s,{event_category:t,event_label:a,value:i}))},Ld=(t,s)=>{ls()&&(console.error("[Analytics] Error tracked:",t),window.gtag&&window.gtag("event","exception",{description:t.message,fatal:!1}))},bs=()=>{const t=ct();return r.useEffect(()=>{Td("error","404_not_found",t.pathname)},[t]),e.jsxs("div",{style:{padding:"40px",textAlign:"center"},children:[e.jsx("h1",{children:"404"}),e.jsx("p",{children:"We couldn't find that page."}),e.jsxs("p",{style:{marginTop:"10px",fontSize:"0.9em",opacity:.7},children:["Requested: ",t.pathname]}),e.jsx(pe,{to:"/",style:{color:"var(--accent-primary)",marginTop:"20px",display:"inline-block"},children:"Return Home"})]})};class Bd extends ns.Component{constructor(s){super(s),this.state={hasError:!1}}static getDerivedStateFromError(s){return{hasError:!0}}componentDidCatch(s,a){if(console.error("ErrorBoundary caught",s,a),Ld(s),s.message&&(s.message.includes("Failed to fetch dynamically imported module")||s.message.includes("Importing a module script failed")||s.name==="ChunkLoadError")){const o=sessionStorage.getItem("chunk_reload_time");if(!o||Date.now()-parseInt(o)>1e4){console.log("Chunk load error detected, reloading page..."),sessionStorage.setItem("chunk_reload_time",Date.now().toString()),window.location.reload();return}}}render(){return this.state.hasError?e.jsxs("div",{style:{padding:"24px",textAlign:"center"},children:[e.jsx("h1",{children:"Something went wrong."}),e.jsx("p",{children:"Please refresh or return home."}),e.jsx("a",{href:"/",style:{color:"var(--accent-primary)"},children:"Go Home"})]}):this.props.children}}const Ad="_container_vnkoo_3",Pd="_sidebar_vnkoo_11",Ed="_headerTitle_vnkoo_26",$d="_nav_vnkoo_38",zd="_navLink_vnkoo_46",Rd="_activeNavLink_vnkoo_62",Md="_signOutBtn_vnkoo_67",Od="_mainContent_vnkoo_86",Vd="_mobileHeader_vnkoo_93",Fd="_menuBtn_vnkoo_105",Hd="_overlay_vnkoo_113",Ud="_open_vnkoo_138",Ie={container:Ad,sidebar:Pd,headerTitle:Ed,nav:$d,navLink:zd,activeNavLink:Rd,signOutBtn:Md,mainContent:Od,mobileHeader:Vd,menuBtn:Fd,overlay:Hd,open:Ud},Gd=()=>{const{signOut:t}=Se(),s=Ut(),[a,i]=r.useState(!1),o=ct(),d=async()=>{await t(),s("/login")},c=()=>i(!a),u=()=>i(!1);ns.useEffect(()=>{u()},[o.pathname]);const g=[{path:"/admin",icon:Ds,label:"Dashboard",end:!0},{path:"/admin/peptides",icon:Qe,label:"Peptides"},{path:"/admin/users",icon:xt,label:"Users"},{path:"/admin/forum",icon:Ze,label:"Forum"},{path:"/admin/reviews",icon:He,label:"Reviews"},{path:"/admin/prices",icon:Vt,label:"Prices"},{path:"/admin/tickets",icon:ke,label:"Support Tickets"},{path:"/admin/audit-logs",icon:Ee,label:"Audit Logs"},{path:"/admin/monitoring",icon:Ee,label:"Monitoring"},{path:"/admin/security",icon:Ae,label:"Security Audit"}];return e.jsxs("div",{className:Ie.container,children:[e.jsxs("div",{className:Ie.mobileHeader,children:[e.jsx("button",{onClick:c,className:Ie.menuBtn,children:e.jsx(Na,{size:24})}),e.jsx("div",{className:Ie.headerTitle,children:e.jsx("h2",{children:"Admin Panel"})}),e.jsx("div",{style:{width:24}})," "]}),e.jsx("div",{className:`${Ie.overlay} ${a?Ie.open:""}`,onClick:u}),e.jsxs("div",{className:`${Ie.sidebar} ${a?Ie.open:""}`,children:[e.jsxs("div",{className:Ie.headerTitle,style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("h2",{children:"Admin Panel"}),e.jsx("button",{onClick:u,className:Ie.menuBtn,style:{display:window.innerWidth<=768?"block":"none"},children:e.jsx(et,{size:20})})]}),e.jsx("nav",{className:Ie.nav,children:g.map(h=>e.jsxs(Fe,{to:h.path,end:h.end,className:({isActive:j})=>`${Ie.navLink} ${j?Ie.activeNavLink:""}`,children:[e.jsx(h.icon,{size:20}),h.label]},h.path))}),e.jsxs("button",{onClick:d,className:Ie.signOutBtn,children:[e.jsx(As,{size:20}),"Sign Out"]})]}),e.jsx("div",{className:Ie.mainContent,children:e.jsx(Is,{})})]})},Xe={async logAction(t,s,a=null,i=null){try{const{data:{user:o}}=await S.auth.getUser();if(!o)return null;const{data:d,error:c}=await S.from("audit_logs").insert({user_id:o.id,action:t,entity_type:s,entity_id:a,metadata:i,user_agent:navigator.userAgent}).select().single();return c?(console.warn("Failed to log action:",c),null):d}catch(o){return console.warn("Audit log error:",o),null}},async getMyLogs(t=50){const{data:s,error:a}=await S.from("audit_logs").select("*").order("created_at",{ascending:!1}).limit(t);if(a&&(console.warn("Error fetching my logs:",a),a.code!=="PGRST116"))throw a;return s||[]},async getAllLogs({limit:t=100,offset:s=0,action:a=null,entityType:i=null,userId:o=null,startDate:d=null,endDate:c=null}={}){let u=S.from("audit_logs").select("*",{count:"exact"}).order("created_at",{ascending:!1}).range(s,s+t-1);a&&(u=u.eq("action",a)),i&&(u=u.eq("entity_type",i)),o&&(u=u.eq("user_id",o)),d&&(u=u.gte("created_at",d)),c&&(u=u.lte("created_at",c));const{data:g,error:h,count:j}=await u;if(h&&(console.warn("Error fetching audit logs:",h),h.code!=="PGRST116"))throw h;const I=[...new Set((g||[]).map(p=>p.user_id).filter(Boolean))];let D={};if(I.length>0){const{data:p}=await S.from("profiles").select("id, email, full_name").in("id",I);D=Object.fromEntries((p||[]).map(C=>[C.id,C]))}return{data:(g||[]).map(p=>({...p,profiles:D[p.user_id]||null})),count:j||0}},async getActionTypes(){const{data:t,error:s}=await S.from("audit_logs").select("action").limit(1e3);if(s)throw s;return[...new Set(t.map(i=>i.action))].sort()},async getEntityTypes(){const{data:t,error:s}=await S.from("audit_logs").select("entity_type").limit(1e3);if(s)throw s;return[...new Set(t.map(i=>i.entity_type))].sort()},async getStats(t=7){const s=new Date;s.setDate(s.getDate()-t);const{data:a,error:i}=await S.from("audit_logs").select("action, created_at").gte("created_at",s.toISOString());if(i)throw i;const o=a.reduce((c,u)=>(c[u.action]=(c[u.action]||0)+1,c),{}),d=a.reduce((c,u)=>{const g=new Date(u.created_at).toLocaleDateString();return c[g]=(c[g]||0)+1,c},{});return{total:a.length,byAction:o,byDay:d}},formatAction(t){return t.replace(/_/g," ").replace(/\b\w/g,s=>s.toUpperCase())},getActionStyle(t){return{profile_updated:{color:"#3b82f6",icon:"User"},injection_created:{color:"#10b981",icon:"Plus"},injection_updated:{color:"#f59e0b",icon:"Edit"},injection_deleted:{color:"#ef4444",icon:"Trash"},login:{color:"#8b5cf6",icon:"LogIn"},logout:{color:"#6b7280",icon:"LogOut"},schedule_created:{color:"#10b981",icon:"Calendar"},review_created:{color:"#06b6d4",icon:"Star"}}[t]||{color:"#6b7280",icon:"Activity"}}},Ne={async getMyTickets(){const{data:t,error:s}=await S.from("support_tickets").select(`
        *,
        ticket_messages (
          id,
          message,
          is_admin_reply,
          created_at
        )
      `).order("updated_at",{ascending:!1});if(s&&(console.warn("Error fetching my tickets:",s),s.code!=="PGRST116"))throw s;return t||[]},async getTicket(t){const{data:s,error:a}=await S.from("support_tickets").select(`
        *,
        ticket_messages (
          id,
          message,
          is_admin_reply,
          created_at,
          user_id
        )
      `).eq("id",t).single();if(a)throw a;return s},async createTicket({subject:t,description:s,category:a="general",priority:i="normal"}){const{data:{user:o}}=await S.auth.getUser();if(!o)throw new Error("Must be logged in to create a ticket");const{data:d,error:c}=await S.from("support_tickets").insert({user_id:o.id,subject:t,description:s,category:a,priority:i}).select().single();if(c)throw c;return d},async addMessage(t,s,a=!1){const{data:{user:i}}=await S.auth.getUser();if(!i)throw new Error("Must be logged in to send a message");const{data:o,error:d}=await S.from("ticket_messages").insert({ticket_id:t,user_id:i.id,message:s,is_admin_reply:a}).select().single();if(d)throw d;return o},async getAllTickets(t=null){let s=S.from("support_tickets").select(`
        *,
        ticket_messages (
          id
        )
      `).order("updated_at",{ascending:!1});t&&(s=s.eq("status",t));const{data:a,error:i}=await s;if(i&&(console.warn("Error fetching tickets:",i),i.code!=="PGRST116"))throw i;const o=[...new Set((a||[]).map(u=>u.user_id).filter(Boolean))];let d={};if(o.length>0){const{data:u}=await S.from("profiles").select("id, email, full_name").in("id",o);d=Object.fromEntries((u||[]).map(g=>[g.id,g]))}return(a||[]).map(u=>({...u,profiles:d[u.user_id]||null}))},async updateTicketStatus(t,s){const{data:{user:a}}=await S.auth.getUser(),i={status:s};s==="resolved"&&(i.resolved_at=new Date().toISOString(),i.resolved_by=a.id);const{data:o,error:d}=await S.from("support_tickets").update(i).eq("id",t).select().single();if(d)throw d;return o},getCategories(){return[{id:"general",label:"General Inquiry"},{id:"bug",label:"Bug Report"},{id:"feature",label:"Feature Request"},{id:"account",label:"Account Issue"},{id:"billing",label:"Billing"},{id:"other",label:"Other"}]},getPriorities(){return[{id:"low",label:"Low",color:"#10b981"},{id:"normal",label:"Normal",color:"#3b82f6"},{id:"high",label:"High",color:"#f59e0b"},{id:"urgent",label:"Urgent",color:"#ef4444"}]},getStatuses(){return[{id:"open",label:"Open",color:"#3b82f6"},{id:"in_progress",label:"In Progress",color:"#f59e0b"},{id:"waiting",label:"Waiting for User",color:"#8b5cf6"},{id:"resolved",label:"Resolved",color:"#10b981"},{id:"closed",label:"Closed",color:"#6b7280"}]}},Wd="_container_2l4ry_1",qd="_header_2l4ry_7",Yd="_refreshBtn_2l4ry_30",Jd="_spin_2l4ry_54",Xd="_statsGrid_2l4ry_69",Zd="_statCard_2l4ry_76",Kd="_statIcon_2l4ry_92",Qd="_statInfo_2l4ry_101",em="_statLabel_2l4ry_106",tm="_statValue_2l4ry_112",sm="_trend_2l4ry_118",am="_trendUp_2l4ry_126",nm="_trendDown_2l4ry_130",im="_trendWarning_2l4ry_134",rm="_twoColumn_2l4ry_144",om="_panel_2l4ry_158",cm="_panelHeader_2l4ry_165",lm="_viewAll_2l4ry_183",dm="_activityList_2l4ry_197",mm="_activityItem_2l4ry_203",um="_activityDot_2l4ry_215",hm="_activityInfo_2l4ry_223",pm="_activityAction_2l4ry_229",gm="_activityMeta_2l4ry_234",xm="_ticketList_2l4ry_240",_m="_ticketItem_2l4ry_246",fm="_ticketInfo_2l4ry_259",jm="_ticketSubject_2l4ry_265",ym="_ticketMeta_2l4ry_270",vm="_ticketStatus_2l4ry_275",bm="_emptyState_2l4ry_284",wm="_quickActions_2l4ry_291",Sm="_actionButtons_2l4ry_304",Nm="_actionBtn_2l4ry_310",q={container:Wd,header:qd,refreshBtn:Yd,spin:Jd,statsGrid:Xd,statCard:Zd,statIcon:Kd,statInfo:Qd,statLabel:em,statValue:tm,trend:sm,trendUp:am,trendDown:nm,trendWarning:im,twoColumn:rm,panel:om,panelHeader:cm,viewAll:lm,activityList:dm,activityItem:mm,activityDot:um,activityInfo:hm,activityAction:pm,activityMeta:gm,ticketList:xm,ticketItem:_m,ticketInfo:fm,ticketSubject:jm,ticketMeta:ym,ticketStatus:vm,emptyState:bm,quickActions:wm,actionButtons:Sm,actionBtn:Nm},km=()=>{const[t,s]=r.useState({users:0,injections:0,peptides:0,reviews:0,schedules:0,openTickets:0}),[a,i]=r.useState([]),[o,d]=r.useState([]),[c,u]=r.useState(!0),[g,h]=r.useState({count:0,direction:"up"});r.useEffect(()=>{j()},[]);const j=async()=>{u(!0),await Promise.all([I(),D(),z(),p()]),u(!1)},I=async()=>{try{const[x,m,w,l,N,k]=await Promise.all([S.from("profiles").select("*",{count:"exact",head:!0}),S.from("injections").select("*",{count:"exact",head:!0}),S.from("peptides").select("*",{count:"exact",head:!0}),S.from("reviews").select("*",{count:"exact",head:!0}),S.from("schedules").select("*",{count:"exact",head:!0}),S.from("support_tickets").select("*",{count:"exact",head:!0}).eq("status","open")]);x.error&&console.error("Error fetching users count:",x.error),m.error&&console.error("Error fetching injections count:",m.error),w.error&&console.error("Error fetching peptides count:",w.error),l.error&&console.error("Error fetching reviews count:",l.error),N.error&&console.error("Error fetching schedules count:",N.error),k.error&&console.error("Error fetching tickets count:",k.error),s({users:x.count||0,injections:m.count||0,peptides:w.count||0,reviews:l.count||0,schedules:N.count||0,openTickets:k.count||0})}catch(x){console.error("Error fetching stats:",x)}},D=async()=>{try{const{data:x}=await Xe.getAllLogs({limit:10});i(x||[])}catch(x){console.error("Error fetching activity:",x)}},z=async()=>{try{const x=await Ne.getAllTickets();d((x||[]).slice(0,5))}catch(x){console.error("Error fetching tickets:",x)}},p=async()=>{try{const x=new Date,m=new Date(x.getTime()-10080*60*1e3),w=new Date(x.getTime()-336*60*60*1e3),[l,N]=await Promise.all([S.from("injections").select("*",{count:"exact",head:!0}).gte("created_at",m.toISOString()),S.from("injections").select("*",{count:"exact",head:!0}).gte("created_at",w.toISOString()).lt("created_at",m.toISOString())]),k=(l.count||0)-(N.count||0);h({count:l.count||0,direction:k>=0?"up":"down",percentage:N.count?Math.abs(Math.round(k/N.count*100)):0})}catch(x){console.error("Error fetching trend:",x)}},C=x=>{const m=Math.floor((new Date-new Date(x))/1e3);return m<60?"just now":m<3600?`${Math.floor(m/60)}m ago`:m<86400?`${Math.floor(m/3600)}h ago`:`${Math.floor(m/86400)}d ago`},y=x=>({open:"#3b82f6",in_progress:"#f59e0b",resolved:"#10b981",closed:"#6b7280"})[x]||"#6b7280";return e.jsxs("div",{className:q.container,children:[e.jsxs("div",{className:q.header,children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Dashboard Overview"}),e.jsx("p",{children:"Welcome back, here's what's happening today"})]}),e.jsxs("button",{className:q.refreshBtn,onClick:j,disabled:c,children:[e.jsx(Pe,{size:18,className:c?q.spin:""}),"Refresh"]})]}),e.jsxs("div",{className:q.statsGrid,children:[e.jsxs("div",{className:q.statCard,children:[e.jsx("div",{className:q.statIcon,style:{background:"#3b82f620",color:"#3b82f6"},children:e.jsx(xt,{size:24})}),e.jsxs("div",{className:q.statInfo,children:[e.jsx("span",{className:q.statLabel,children:"Total Users"}),e.jsx("span",{className:q.statValue,children:c?"...":t.users})]})]}),e.jsxs("div",{className:q.statCard,children:[e.jsx("div",{className:q.statIcon,style:{background:"#10b98120",color:"#10b981"},children:e.jsx(Oe,{size:24})}),e.jsxs("div",{className:q.statInfo,children:[e.jsx("span",{className:q.statLabel,children:"Total Injections"}),e.jsx("span",{className:q.statValue,children:c?"...":t.injections}),!c&&g.percentage>0&&e.jsxs("span",{className:`${q.trend} ${g.direction==="up"?q.trendUp:q.trendDown}`,children:[g.direction==="up"?e.jsx(Jt,{size:14}):e.jsx(ka,{size:14}),g.percentage,"% this week"]})]})]}),e.jsxs("div",{className:q.statCard,children:[e.jsx("div",{className:q.statIcon,style:{background:"#8b5cf620",color:"#8b5cf6"},children:e.jsx(Qe,{size:24})}),e.jsxs("div",{className:q.statInfo,children:[e.jsx("span",{className:q.statLabel,children:"Peptides in DB"}),e.jsx("span",{className:q.statValue,children:c?"...":t.peptides})]})]}),e.jsxs("div",{className:q.statCard,children:[e.jsx("div",{className:q.statIcon,style:{background:"#f59e0b20",color:"#f59e0b"},children:e.jsx(ke,{size:24})}),e.jsxs("div",{className:q.statInfo,children:[e.jsx("span",{className:q.statLabel,children:"Open Tickets"}),e.jsx("span",{className:q.statValue,children:c?"...":t.openTickets}),!c&&t.openTickets>0&&e.jsxs("span",{className:q.trendWarning,children:[e.jsx(Ve,{size:14})," Needs attention"]})]})]}),e.jsxs("div",{className:q.statCard,children:[e.jsx("div",{className:q.statIcon,style:{background:"#06b6d420",color:"#06b6d4"},children:e.jsx(it,{size:24})}),e.jsxs("div",{className:q.statInfo,children:[e.jsx("span",{className:q.statLabel,children:"Reviews"}),e.jsx("span",{className:q.statValue,children:c?"...":t.reviews})]})]}),e.jsxs("div",{className:q.statCard,children:[e.jsx("div",{className:q.statIcon,style:{background:"#ec489920",color:"#ec4899"},children:e.jsx(Ce,{size:24})}),e.jsxs("div",{className:q.statInfo,children:[e.jsx("span",{className:q.statLabel,children:"Scheduled Doses"}),e.jsx("span",{className:q.statValue,children:c?"...":t.schedules})]})]})]}),e.jsxs("div",{className:q.twoColumn,children:[e.jsxs("div",{className:q.panel,children:[e.jsxs("div",{className:q.panelHeader,children:[e.jsxs("h3",{children:[e.jsx(Ee,{size:20})," Recent Activity"]}),e.jsxs(pe,{to:"/admin/audit-logs",className:q.viewAll,children:["View All ",e.jsx(Jt,{size:14})]})]}),e.jsx("div",{className:q.activityList,children:c?e.jsx("p",{className:q.emptyState,children:"Loading..."}):a.length===0?e.jsx("p",{className:q.emptyState,children:"No recent activity"}):a.map(x=>e.jsxs("div",{className:q.activityItem,children:[e.jsx("div",{className:q.activityDot,style:{background:Xe.getActionStyle(x.action).color}}),e.jsxs("div",{className:q.activityInfo,children:[e.jsx("span",{className:q.activityAction,children:Xe.formatAction(x.action)}),e.jsxs("span",{className:q.activityMeta,children:[x.profiles?.email?.split("@")[0]||"User"," • ",C(x.created_at)]})]})]},x.id))})]}),e.jsxs("div",{className:q.panel,children:[e.jsxs("div",{className:q.panelHeader,children:[e.jsxs("h3",{children:[e.jsx(ke,{size:20})," Recent Tickets"]}),e.jsxs(pe,{to:"/admin/tickets",className:q.viewAll,children:["View All ",e.jsx(Jt,{size:14})]})]}),e.jsx("div",{className:q.ticketList,children:c?e.jsx("p",{className:q.emptyState,children:"Loading..."}):o.length===0?e.jsx("p",{className:q.emptyState,children:"No tickets yet"}):o.map(x=>e.jsxs(pe,{to:"/admin/tickets",className:q.ticketItem,children:[e.jsxs("div",{className:q.ticketInfo,children:[e.jsx("span",{className:q.ticketSubject,children:x.subject}),e.jsxs("span",{className:q.ticketMeta,children:[x.profiles?.email?.split("@")[0]||"User"," • ",C(x.created_at)]})]}),e.jsxs("span",{className:q.ticketStatus,style:{color:y(x.status)},children:[x.status==="open"?e.jsx(Ve,{size:14}):e.jsx(je,{size:14}),x.status.replace("_"," ")]})]},x.id))})]})]}),e.jsxs("div",{className:q.quickActions,children:[e.jsx("h3",{children:"Quick Actions"}),e.jsxs("div",{className:q.actionButtons,children:[e.jsxs(pe,{to:"/admin/peptides",className:q.actionBtn,children:[e.jsx(Qe,{size:20}),"Manage Peptides"]}),e.jsxs(pe,{to:"/admin/tickets",className:q.actionBtn,children:[e.jsx(ke,{size:20}),"View Tickets"]}),e.jsxs(pe,{to:"/admin/audit-logs",className:q.actionBtn,children:[e.jsx(Ee,{size:20}),"Audit Logs"]}),e.jsxs(pe,{to:"/encyclopedia",className:q.actionBtn,children:[e.jsx(It,{size:20}),"View Encyclopedia"]})]})]})]})},Cm="_container_1016c_1",Im="_header_1016c_7",Dm="_addBtn_1016c_33",Tm="_successBanner_1016c_53",Lm="_filters_1016c_79",Bm="_searchBox_1016c_86",Am="_filterSelect_1016c_108",Pm="_loading_1016c_119",Em="_emptyState_1016c_120",$m="_peptideList_1016c_141",zm="_peptideCard_1016c_147",Rm="_peptideHeader_1016c_159",Mm="_peptideInfo_1016c_172",Om="_tags_1016c_178",Vm="_categoryTag_1016c_184",Fm="_halfLifeTag_1016c_193",Hm="_warningTag_1016c_204",Um="_peptideActions_1016c_215",Gm="_viewBtn_1016c_222",Wm="_duplicateBtn_1016c_223",qm="_editBtn_1016c_224",Ym="_deleteBtn_1016c_225",Jm="_peptideDetails_1016c_275",Xm="_detailSection_1016c_293",Zm="_sideEffectsList_1016c_320",Km="_modalOverlay_1016c_335",Qm="_modal_1016c_335",eu="_modalHeader_1016c_359",tu="_closeBtn_1016c_373",su="_form_1016c_386",au="_formRow_1016c_395",nu="_formGroup_1016c_407",iu="_codeInput_1016c_444",ru="_formActions_1016c_449",ou="_cancelBtn_1016c_457",cu="_saveBtn_1016c_471",Q={container:Cm,header:Im,addBtn:Dm,successBanner:Tm,filters:Lm,searchBox:Bm,filterSelect:Am,loading:Pm,emptyState:Em,peptideList:$m,peptideCard:zm,peptideHeader:Rm,peptideInfo:Mm,tags:Om,categoryTag:Vm,halfLifeTag:Fm,warningTag:Hm,peptideActions:Um,viewBtn:Gm,duplicateBtn:Wm,editBtn:qm,deleteBtn:Ym,peptideDetails:Jm,detailSection:Xm,sideEffectsList:Zm,modalOverlay:Km,modal:Qm,modalHeader:eu,closeBtn:tu,form:su,formRow:au,formGroup:nu,codeInput:iu,formActions:ru,cancelBtn:ou,saveBtn:cu},ws=["Weight Loss","Muscle Building","Recovery","Anti-Aging","Cognitive","Immunity","Sexual Health","Other"],lu=()=>{const[t,s]=r.useState([]),[a,i]=r.useState(!0),[o,d]=r.useState(""),[c,u]=r.useState(""),[g,h]=r.useState(!1),[j,I]=r.useState(null),[D,z]=r.useState(!1),[p,C]=r.useState(null),[y,x]=r.useState(""),[m,w]=r.useState({name:"",category:"Weight Loss",half_life_hours:"",description:"",benefits:"",side_effects:"",warnings:"",dosage_protocols:"",common_dosage:"",research_links:""});r.useEffect(()=>{l()},[]);const l=async()=>{try{i(!0);const{data:n,error:L}=await S.from("peptides").select("*").order("name");if(L)throw L;s(n||[])}catch(n){console.error("Error fetching peptides:",n)}finally{i(!1)}},N=n=>{I(n.id),w({name:n.name,category:n.category,half_life_hours:n.half_life_hours||"",description:n.description||"",benefits:(n.benefits||[]).join(`
`),side_effects:(n.side_effects||[]).join(`
`),warnings:(n.warnings||[]).join(`
`),dosage_protocols:n.dosage_protocols?JSON.stringify(n.dosage_protocols,null,2):"",common_dosage:n.common_dosage||"",research_links:(n.research_links||[]).join(`
`)}),h(!0)},k=()=>{I(null),w({name:"",category:"Weight Loss",half_life_hours:"",description:"",benefits:"",side_effects:"",warnings:"",dosage_protocols:"",common_dosage:"",research_links:""}),h(!0)},B=n=>{I(null),w({name:n.name+" (Copy)",category:n.category,half_life_hours:n.half_life_hours||"",description:n.description||"",benefits:(n.benefits||[]).join(`
`),side_effects:(n.side_effects||[]).join(`
`),warnings:(n.warnings||[]).join(`
`),dosage_protocols:n.dosage_protocols?JSON.stringify(n.dosage_protocols,null,2):"",common_dosage:n.common_dosage||"",research_links:(n.research_links||[]).join(`
`)}),h(!0)},F=async(n,L)=>{if(window.confirm(`Are you sure you want to delete "${L}"? This cannot be undone.`))try{const{error:H}=await S.from("peptides").delete().eq("id",n);if(H)throw H;T(`${L} deleted successfully`),l()}catch(H){console.error("Error deleting peptide:",H),alert("Failed to delete peptide")}},A=async n=>{n.preventDefault(),z(!0);let L=null;if(m.dosage_protocols.trim())try{L=JSON.parse(m.dosage_protocols)}catch{alert("Invalid JSON in dosage protocols. Please check the format."),z(!1);return}const H={name:m.name.trim(),category:m.category,half_life_hours:m.half_life_hours?parseFloat(m.half_life_hours):null,description:m.description.trim(),benefits:m.benefits.split(`
`).map(V=>V.trim()).filter(Boolean),side_effects:m.side_effects.split(`
`).map(V=>V.trim()).filter(Boolean),warnings:m.warnings.split(`
`).map(V=>V.trim()).filter(Boolean),dosage_protocols:L,common_dosage:m.common_dosage.trim(),research_links:m.research_links.split(`
`).map(V=>V.trim()).filter(Boolean)};try{if(j){const{error:V}=await S.from("peptides").update(H).eq("id",j);if(V)throw V;T(`${H.name} updated successfully`)}else{const{error:V}=await S.from("peptides").insert([H]);if(V)throw V;T(`${H.name} created successfully`)}h(!1),l()}catch(V){console.error("Error saving peptide:",V),alert("Failed to save peptide: "+V.message)}finally{z(!1)}},T=n=>{x(n),setTimeout(()=>x(""),3e3)},K=t.filter(n=>{const L=n.name.toLowerCase().includes(o.toLowerCase())||n.category.toLowerCase().includes(o.toLowerCase()),H=!c||n.category===c;return L&&H}),X=n=>t.filter(L=>L.category===n).length;return e.jsxs("div",{className:Q.container,children:[e.jsxs("div",{className:Q.header,children:[e.jsxs("div",{children:[e.jsxs("h1",{children:[e.jsx(Qe,{size:28})," Manage Peptides"]}),e.jsxs("p",{children:[t.length," peptides in database"]})]}),e.jsxs("button",{className:Q.addBtn,onClick:k,children:[e.jsx(Ke,{size:20}),"Add Peptide"]})]}),y&&e.jsxs("div",{className:Q.successBanner,children:[e.jsx(je,{size:18}),y]}),e.jsxs("div",{className:Q.filters,children:[e.jsxs("div",{className:Q.searchBox,children:[e.jsx(qt,{size:20}),e.jsx("input",{type:"text",placeholder:"Search peptides...",value:o,onChange:n=>d(n.target.value)})]}),e.jsxs("select",{value:c,onChange:n=>u(n.target.value),className:Q.filterSelect,children:[e.jsx("option",{value:"",children:"All Categories"}),ws.map(n=>e.jsxs("option",{value:n,children:[n," (",X(n),")"]},n))]})]}),a?e.jsx("div",{className:Q.loading,children:"Loading peptides..."}):K.length===0?e.jsxs("div",{className:Q.emptyState,children:[e.jsx(Qe,{size:48}),e.jsx("h3",{children:"No peptides found"}),e.jsx("p",{children:"Try adjusting your search or add a new peptide."})]}):e.jsx("div",{className:Q.peptideList,children:K.map(n=>e.jsxs("div",{className:Q.peptideCard,children:[e.jsxs("div",{className:Q.peptideHeader,onClick:()=>C(p===n.id?null:n.id),children:[e.jsxs("div",{className:Q.peptideInfo,children:[e.jsx("h3",{children:n.name}),e.jsxs("div",{className:Q.tags,children:[e.jsx("span",{className:Q.categoryTag,children:n.category}),n.half_life_hours&&e.jsxs("span",{className:Q.halfLifeTag,children:[e.jsx(ze,{size:12}),n.half_life_hours,"h half-life"]}),n.warnings?.length>0&&e.jsxs("span",{className:Q.warningTag,children:[e.jsx(rt,{size:12}),n.warnings.length," warnings"]})]})]}),e.jsxs("div",{className:Q.peptideActions,children:[e.jsx(pe,{to:`/encyclopedia/${encodeURIComponent(n.name)}`,className:Q.viewBtn,onClick:L=>L.stopPropagation(),title:"View in Encyclopedia",children:e.jsx(It,{size:16})}),e.jsx("button",{onClick:L=>{L.stopPropagation(),B(n)},className:Q.duplicateBtn,title:"Duplicate",children:e.jsx(Bs,{size:16})}),e.jsx("button",{onClick:L=>{L.stopPropagation(),N(n)},className:Q.editBtn,title:"Edit",children:e.jsx(Je,{size:16})}),e.jsx("button",{onClick:L=>{L.stopPropagation(),F(n.id,n.name)},className:Q.deleteBtn,title:"Delete",children:e.jsx(Be,{size:16})}),p===n.id?e.jsx(Ft,{size:20}):e.jsx(pt,{size:20})]})]}),p===n.id&&e.jsxs("div",{className:Q.peptideDetails,children:[n.description&&e.jsxs("div",{className:Q.detailSection,children:[e.jsx("h4",{children:"Description"}),e.jsx("p",{children:n.description})]}),n.benefits?.length>0&&e.jsxs("div",{className:Q.detailSection,children:[e.jsx("h4",{children:"Benefits"}),e.jsx("ul",{children:n.benefits.map((L,H)=>e.jsx("li",{children:L},H))})]}),n.side_effects?.length>0&&e.jsxs("div",{className:Q.detailSection,children:[e.jsx("h4",{children:"Side Effects"}),e.jsx("ul",{className:Q.sideEffectsList,children:n.side_effects.map((L,H)=>e.jsx("li",{children:L},H))})]}),n.dosage_protocols&&e.jsxs("div",{className:Q.detailSection,children:[e.jsx("h4",{children:"Dosage Protocols"}),e.jsx("pre",{children:JSON.stringify(n.dosage_protocols,null,2)})]})]})]},n.id))}),g&&e.jsx("div",{className:Q.modalOverlay,onClick:()=>h(!1),children:e.jsxs("div",{className:Q.modal,onClick:n=>n.stopPropagation(),children:[e.jsxs("div",{className:Q.modalHeader,children:[e.jsx("h2",{children:j?"Edit Peptide":"New Peptide"}),e.jsx("button",{onClick:()=>h(!1),className:Q.closeBtn,children:e.jsx(et,{size:24})})]}),e.jsxs("form",{onSubmit:A,className:Q.form,children:[e.jsxs("div",{className:Q.formRow,children:[e.jsxs("div",{className:Q.formGroup,children:[e.jsx("label",{children:"Name *"}),e.jsx("input",{type:"text",value:m.name,onChange:n=>w({...m,name:n.target.value}),required:!0,placeholder:"e.g., Semaglutide"})]}),e.jsxs("div",{className:Q.formGroup,children:[e.jsx("label",{children:"Category *"}),e.jsx("select",{value:m.category,onChange:n=>w({...m,category:n.target.value}),children:ws.map(n=>e.jsx("option",{value:n,children:n},n))})]})]}),e.jsxs("div",{className:Q.formGroup,children:[e.jsx("label",{children:"Half Life (hours)"}),e.jsx("input",{type:"number",step:"0.1",value:m.half_life_hours,onChange:n=>w({...m,half_life_hours:n.target.value}),placeholder:"e.g., 168"})]}),e.jsxs("div",{className:Q.formGroup,children:[e.jsx("label",{children:"Common Dosage"}),e.jsx("input",{type:"text",value:m.common_dosage,onChange:n=>w({...m,common_dosage:n.target.value}),placeholder:"e.g., 0.25mg - 2.4mg weekly"})]}),e.jsxs("div",{className:Q.formGroup,children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{value:m.description,onChange:n=>w({...m,description:n.target.value}),rows:3,placeholder:"Brief description of the peptide..."})]}),e.jsxs("div",{className:Q.formGroup,children:[e.jsx("label",{children:"Benefits (one per line)"}),e.jsx("textarea",{value:m.benefits,onChange:n=>w({...m,benefits:n.target.value}),rows:4,placeholder:`Weight loss
Improved insulin sensitivity
Reduced appetite`})]}),e.jsxs("div",{className:Q.formGroup,children:[e.jsx("label",{children:"Side Effects (one per line)"}),e.jsx("textarea",{value:m.side_effects,onChange:n=>w({...m,side_effects:n.target.value}),rows:4,placeholder:`Nausea
Headache
Injection site reactions`})]}),e.jsxs("div",{className:Q.formGroup,children:[e.jsx("label",{children:"Warnings (one per line)"}),e.jsx("textarea",{value:m.warnings,onChange:n=>w({...m,warnings:n.target.value}),rows:3,placeholder:`Not for pregnant women
Consult doctor before use`})]}),e.jsxs("div",{className:Q.formGroup,children:[e.jsx("label",{children:"Research Links (one per line)"}),e.jsx("textarea",{value:m.research_links,onChange:n=>w({...m,research_links:n.target.value}),rows:3,placeholder:"https://pubmed.ncbi.nlm.nih.gov/..."})]}),e.jsxs("div",{className:Q.formGroup,children:[e.jsx("label",{children:"Dosage Protocols (JSON format, optional)"}),e.jsx("textarea",{value:m.dosage_protocols,onChange:n=>w({...m,dosage_protocols:n.target.value}),rows:6,placeholder:'[{"name": "Standard Protocol", "dose": "0.25mg", "frequency": "weekly"}]',className:Q.codeInput})]}),e.jsxs("div",{className:Q.formActions,children:[e.jsx("button",{type:"button",onClick:()=>h(!1),className:Q.cancelBtn,children:"Cancel"}),e.jsxs("button",{type:"submit",className:Q.saveBtn,disabled:D,children:[e.jsx(Ps,{size:18}),D?"Saving...":j?"Update Peptide":"Create Peptide"]})]})]})]})})]})},du="_container_wkvpx_1",mu="_header_wkvpx_7",uu="_refreshBtn_wkvpx_27",hu="_spin_wkvpx_50",pu="_successBanner_wkvpx_65",gu="_errorBanner_wkvpx_66",xu="_statsGrid_wkvpx_89",_u="_statCard_wkvpx_96",fu="_statIcon_wkvpx_106",ju="_statInfo_wkvpx_115",yu="_statValue_wkvpx_120",vu="_statLabel_wkvpx_125",bu="_filters_wkvpx_131",wu="_searchBox_wkvpx_137",Su="_filterSelect_wkvpx_165",Nu="_loading_wkvpx_177",ku="_emptyState_wkvpx_178",Cu="_userList_wkvpx_198",Iu="_userCard_wkvpx_204",Du="_userHeader_wkvpx_216",Tu="_userAvatar_wkvpx_224",Lu="_adminBadge_wkvpx_245",Bu="_userInfo_wkvpx_259",Au="_userName_wkvpx_264",Pu="_youBadge_wkvpx_271",Eu="_userEmail_wkvpx_279",$u="_userMeta_wkvpx_288",zu="_metaItem_wkvpx_296",Ru="_userActions_wkvpx_302",Mu="_promoteBtn_wkvpx_308",Ou="_demoteBtn_wkvpx_309",Vu="_userDetails_wkvpx_349",Fu="_detailsGrid_wkvpx_355",Hu="_detailCard_wkvpx_362",Uu="_detailValue_wkvpx_381",Gu="_detailLabel_wkvpx_386",Wu="_detailsInfo_wkvpx_391",qu="_infoRow_wkvpx_397",Yu="_infoLabel_wkvpx_403",Ju="_infoValue_wkvpx_408",Xu="_resultsCount_wkvpx_421",R={container:du,header:mu,refreshBtn:uu,spin:hu,successBanner:pu,errorBanner:gu,statsGrid:xu,statCard:_u,statIcon:fu,statInfo:ju,statValue:yu,statLabel:vu,filters:bu,searchBox:wu,filterSelect:Su,loading:Nu,emptyState:ku,userList:Cu,userCard:Iu,userHeader:Du,userAvatar:Tu,adminBadge:Lu,userInfo:Bu,userName:Au,youBadge:Pu,userEmail:Eu,userMeta:$u,metaItem:zu,userActions:Ru,promoteBtn:Mu,demoteBtn:Ou,userDetails:Vu,detailsGrid:Fu,detailCard:Hu,detailValue:Uu,detailLabel:Gu,detailsInfo:Wu,infoRow:qu,infoLabel:Yu,infoValue:Ju,resultsCount:Xu},Zu=()=>{const{user:t}=Se(),[s,a]=r.useState([]),[i,o]=r.useState(!0),[d,c]=r.useState(""),[u,g]=r.useState("all"),[h,j]=r.useState(null),[I,D]=r.useState({}),[z,p]=r.useState(""),[C,y]=r.useState(""),[x,m]=r.useState({total:0,admins:0,newThisWeek:0,activeToday:0});r.useEffect(()=>{w()},[]);const w=async()=>{try{o(!0),y("");const{data:n,error:L}=await S.from("profiles").select("*").order("updated_at",{ascending:!1});if(L)throw L;a(n||[]);const H=new Date,V=new Date(H.getTime()-10080*60*1e3),v=new Date(H.setHours(0,0,0,0));m({total:n?.length||0,admins:n?.filter(G=>G.is_admin).length||0,newThisWeek:n?.filter(G=>G.updated_at&&new Date(G.updated_at)>=V).length||0,activeToday:n?.filter(G=>G.last_sign_in&&new Date(G.last_sign_in)>=v).length||0})}catch(n){console.error("Error fetching users:",n),n.code==="PGRST301"||n.message?.includes("permission denied")?y("Access denied. Make sure your account has admin privileges and RLS policies are configured correctly. Check the browser console for details."):n.code==="42501"?y("Database permission error. The RLS policies may need to be updated. Run the FIX_ADMIN_PANEL_NOW.sql script in Supabase Dashboard."):y(`Failed to load users: ${n.message||"Unknown error"}. Check browser console for details.`)}finally{o(!1)}},l=async n=>{if(!I[n])try{const[L,H,V]=await Promise.all([S.from("injections").select("*",{count:"exact",head:!0}).eq("user_id",n),S.from("schedules").select("*",{count:"exact",head:!0}).eq("user_id",n),S.from("reviews").select("*",{count:"exact",head:!0}).eq("user_id",n)]);D(v=>({...v,[n]:{injections:L.count||0,schedules:H.count||0,reviews:V.count||0}}))}catch(L){console.error("Error fetching user stats:",L)}},N=async(n,L,H)=>{const V=!L,v=V?"grant":"revoke";if(window.confirm(`Are you sure you want to ${v} market access for ${H}?`))try{const{error:G}=await S.from("profiles").update({has_market_access:V}).eq("id",n);if(G)throw G;a(P=>P.map(J=>J.id===n?{...J,has_market_access:V}:J)),B(`Market access ${V?"granted to":"revoked from"} ${H}.`)}catch(G){console.error("Error updating market access:",G),y("Failed to update market access. "+(G.message||"")),setTimeout(()=>y(""),5e3)}},k=async(n,L,H)=>{if(n===t?.id){y("You cannot change your own admin status."),setTimeout(()=>y(""),3e3);return}const V=!L,v=V?"promote":"demote";if(window.confirm(`Are you sure you want to ${v} ${H} ${V?"to":"from"} admin?`))try{const{error:G}=await S.from("profiles").update({is_admin:V}).eq("id",n);if(G)throw G;a(P=>P.map(J=>J.id===n?{...J,is_admin:V}:J)),B(`${H} has been ${V?"promoted to":"removed from"} admin.`),m(P=>({...P,admins:V?P.admins+1:P.admins-1}))}catch(G){console.error("Error updating admin status:",G),y("Failed to update admin status. "+(G.message||"")),setTimeout(()=>y(""),5e3)}},B=n=>{p(n),setTimeout(()=>p(""),3e3)},F=n=>{h===n?j(null):(j(n),l(n))},A=n=>n?new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never",T=n=>{if(!n)return"Never";const L=Math.floor((new Date-new Date(n))/1e3);return L<60?"just now":L<3600?`${Math.floor(L/60)}m ago`:L<86400?`${Math.floor(L/3600)}h ago`:L<604800?`${Math.floor(L/86400)}d ago`:A(n)},K=(n,L)=>L?L.split(" ").map(H=>H[0]).join("").toUpperCase().slice(0,2):n?n.substring(0,2).toUpperCase():"??",X=s.filter(n=>{const L=(n.email?.toLowerCase()||"").includes(d.toLowerCase())||(n.full_name?.toLowerCase()||"").includes(d.toLowerCase()),H=u==="all"||u==="admin"&&n.is_admin||u==="user"&&!n.is_admin;return L&&H});return e.jsxs("div",{className:R.container,children:[e.jsxs("div",{className:R.header,children:[e.jsxs("div",{children:[e.jsxs("h1",{children:[e.jsx(xt,{size:28})," User Management"]}),e.jsx("p",{children:"Manage user accounts and permissions"})]}),e.jsxs("button",{className:R.refreshBtn,onClick:w,disabled:i,children:[e.jsx(Pe,{size:18,className:i?R.spin:""}),"Refresh"]})]}),z&&e.jsxs("div",{className:R.successBanner,children:[e.jsx(je,{size:18}),z]}),C&&e.jsxs("div",{className:R.errorBanner,children:[e.jsx(ft,{size:18}),C]}),e.jsxs("div",{className:R.statsGrid,children:[e.jsxs("div",{className:R.statCard,children:[e.jsx("div",{className:R.statIcon,style:{background:"#3b82f620",color:"#3b82f6"},children:e.jsx(xt,{size:24})}),e.jsxs("div",{className:R.statInfo,children:[e.jsx("span",{className:R.statValue,children:x.total}),e.jsx("span",{className:R.statLabel,children:"Total Users"})]})]}),e.jsxs("div",{className:R.statCard,children:[e.jsx("div",{className:R.statIcon,style:{background:"#8b5cf620",color:"#8b5cf6"},children:e.jsx(Ae,{size:24})}),e.jsxs("div",{className:R.statInfo,children:[e.jsx("span",{className:R.statValue,children:x.admins}),e.jsx("span",{className:R.statLabel,children:"Administrators"})]})]}),e.jsxs("div",{className:R.statCard,children:[e.jsx("div",{className:R.statIcon,style:{background:"#10b98120",color:"#10b981"},children:e.jsx(Ce,{size:24})}),e.jsxs("div",{className:R.statInfo,children:[e.jsx("span",{className:R.statValue,children:x.newThisWeek}),e.jsx("span",{className:R.statLabel,children:"New This Week"})]})]}),e.jsxs("div",{className:R.statCard,children:[e.jsx("div",{className:R.statIcon,style:{background:"#f59e0b20",color:"#f59e0b"},children:e.jsx(Ee,{size:24})}),e.jsxs("div",{className:R.statInfo,children:[e.jsx("span",{className:R.statValue,children:x.activeToday}),e.jsx("span",{className:R.statLabel,children:"Active Today"})]})]})]}),e.jsxs("div",{className:R.filters,children:[e.jsxs("div",{className:R.searchBox,children:[e.jsx(qt,{size:20}),e.jsx("input",{type:"text",placeholder:"Search by email or name...",value:d,onChange:n=>c(n.target.value)})]}),e.jsxs("select",{value:u,onChange:n=>g(n.target.value),className:R.filterSelect,children:[e.jsx("option",{value:"all",children:"All Users"}),e.jsx("option",{value:"admin",children:"Admins Only"}),e.jsx("option",{value:"user",children:"Regular Users"})]})]}),i?e.jsxs("div",{className:R.loading,children:[e.jsx(Pe,{size:24,className:R.spin}),"Loading users..."]}):X.length===0?e.jsxs("div",{className:R.emptyState,children:[e.jsx(Ca,{size:48}),e.jsx("h3",{children:"No users found"}),e.jsx("p",{children:"Try adjusting your search or filters."})]}):e.jsx("div",{className:R.userList,children:X.map(n=>e.jsxs("div",{className:R.userCard,children:[e.jsxs("div",{className:R.userHeader,onClick:()=>F(n.id),children:[e.jsxs("div",{className:R.userAvatar,children:[n.avatar_url?e.jsx("img",{src:n.avatar_url,alt:n.email}):e.jsx("span",{children:K(n.email,n.full_name)}),n.is_admin&&e.jsx("div",{className:R.adminBadge,title:"Administrator",children:e.jsx(Ae,{size:10})})]}),e.jsxs("div",{className:R.userInfo,children:[e.jsxs("div",{className:R.userName,children:[n.full_name||"No name set",n.id===t?.id&&e.jsx("span",{className:R.youBadge,children:"You"})]}),e.jsxs("div",{className:R.userEmail,children:[e.jsx(Dt,{size:14}),n.email||"No email"]})]}),e.jsxs("div",{className:R.userMeta,children:[e.jsxs("div",{className:R.metaItem,children:[e.jsx(Ce,{size:14}),"Joined ",T(n.updated_at)]}),n.last_sign_in&&e.jsxs("div",{className:R.metaItem,children:[e.jsx(ze,{size:14}),"Last active ",T(n.last_sign_in)]})]}),e.jsxs("div",{className:R.userActions,children:[e.jsxs("button",{onClick:L=>{L.stopPropagation(),N(n.id,n.has_market_access,n.email)},className:R.promoteBtn,style:{background:n.has_market_access?"rgba(16, 185, 129, 0.15)":"rgba(255, 255, 255, 0.05)",color:n.has_market_access?"#10b981":"var(--text-secondary)",border:n.has_market_access?"1px solid #10b981":"1px solid var(--glass-border)",marginRight:"8px"},title:n.has_market_access?"Revoke Market Access":"Grant Market Access",children:[e.jsx(Vt,{size:16}),n.has_market_access?"Market: ON":"Market: OFF"]}),e.jsxs("button",{onClick:L=>{L.stopPropagation(),k(n.id,n.is_admin,n.email)},className:n.is_admin?R.demoteBtn:R.promoteBtn,disabled:n.id===t?.id,title:n.id===t?.id?"Cannot change own status":n.is_admin?"Remove admin":"Make admin",children:[n.is_admin?e.jsx(Ia,{size:16}):e.jsx(Ae,{size:16}),n.is_admin?"Demote":"Promote"]}),h===n.id?e.jsx(Ft,{size:20}):e.jsx(pt,{size:20})]})]}),h===n.id&&e.jsxs("div",{className:R.userDetails,children:[e.jsxs("div",{className:R.detailsGrid,children:[e.jsxs("div",{className:R.detailCard,children:[e.jsx(Oe,{size:20}),e.jsxs("div",{children:[e.jsx("span",{className:R.detailValue,children:I[n.id]?.injections??"..."}),e.jsx("span",{className:R.detailLabel,children:"Injections"})]})]}),e.jsxs("div",{className:R.detailCard,children:[e.jsx(Ce,{size:20}),e.jsxs("div",{children:[e.jsx("span",{className:R.detailValue,children:I[n.id]?.schedules??"..."}),e.jsx("span",{className:R.detailLabel,children:"Schedules"})]})]}),e.jsxs("div",{className:R.detailCard,children:[e.jsx(He,{size:20}),e.jsxs("div",{children:[e.jsx("span",{className:R.detailValue,children:I[n.id]?.reviews??"..."}),e.jsx("span",{className:R.detailLabel,children:"Reviews"})]})]}),e.jsxs("div",{className:R.detailCard,children:[e.jsx(kt,{size:20}),e.jsxs("div",{children:[e.jsx("span",{className:R.detailValue,children:n.is_admin?"Admin":"User"}),e.jsx("span",{className:R.detailLabel,children:"Role"})]})]})]}),e.jsxs("div",{className:R.detailsInfo,children:[e.jsxs("div",{className:R.infoRow,children:[e.jsx("span",{className:R.infoLabel,children:"User ID:"}),e.jsx("code",{className:R.infoValue,children:n.id})]}),e.jsxs("div",{className:R.infoRow,children:[e.jsx("span",{className:R.infoLabel,children:"Registered:"}),e.jsx("span",{className:R.infoValue,children:A(n.updated_at)})]}),e.jsxs("div",{className:R.infoRow,children:[e.jsx("span",{className:R.infoLabel,children:"Last Sign In:"}),e.jsx("span",{className:R.infoValue,children:A(n.last_sign_in)})]}),n.weight_lbs&&e.jsxs("div",{className:R.infoRow,children:[e.jsx("span",{className:R.infoLabel,children:"Weight:"}),e.jsxs("span",{className:R.infoValue,children:[n.weight_lbs," lbs"]})]})]})]})]},n.id))}),!i&&X.length>0&&e.jsxs("div",{className:R.resultsCount,children:["Showing ",X.length," of ",s.length," users"]})]})},Ku="_container_1ej4a_1",Qu="_header_1ej4a_7",eh="_refreshBtn_1ej4a_27",th="_spin_1ej4a_48",sh="_successBanner_1ej4a_63",ah="_errorBanner_1ej4a_64",nh="_statsGrid_1ej4a_87",ih="_statCard_1ej4a_94",rh="_statValue_1ej4a_113",oh="_statLabel_1ej4a_118",ch="_tabs_1ej4a_124",lh="_tab_1ej4a_124",dh="_active_1ej4a_147",mh="_filters_1ej4a_154",uh="_searchBox_1ej4a_160",hh="_filterSelect_1ej4a_184",ph="_loading_1ej4a_195",gh="_emptyState_1ej4a_196",xh="_list_1ej4a_212",_h="_item_1ej4a_218",fh="_itemContent_1ej4a_234",jh="_itemHeader_1ej4a_239",yh="_badges_1ej4a_252",vh="_pinnedBadge_1ej4a_257",bh="_lockedBadge_1ej4a_258",wh="_postContent_1ej4a_275",Sh="_itemMeta_1ej4a_282",Nh="_categoryBadge_1ej4a_296",kh="_itemActions_1ej4a_304",Ch="_pinBtn_1ej4a_310",Ih="_unpinBtn_1ej4a_311",Dh="_lockBtn_1ej4a_312",Th="_unlockBtn_1ej4a_313",Lh="_deleteBtn_1ej4a_314",Bh="_resultsCount_1ej4a_377",Z={container:Ku,header:Qu,refreshBtn:eh,spin:th,successBanner:sh,errorBanner:ah,statsGrid:nh,statCard:ih,statValue:rh,statLabel:oh,tabs:ch,tab:lh,active:dh,filters:mh,searchBox:uh,filterSelect:hh,loading:ph,emptyState:gh,list:xh,item:_h,itemContent:fh,itemHeader:jh,badges:yh,pinnedBadge:vh,lockedBadge:bh,postContent:wh,itemMeta:Sh,categoryBadge:Nh,itemActions:kh,pinBtn:Ch,unpinBtn:Ih,lockBtn:Dh,unlockBtn:Th,deleteBtn:Lh,resultsCount:Bh},Ah=()=>{const[t,s]=r.useState("topics"),[a,i]=r.useState([]),[o,d]=r.useState([]),[c,u]=r.useState(!0),[g,h]=r.useState(""),[j,I]=r.useState(""),[D,z]=r.useState([]),[p,C]=r.useState(""),[y,x]=r.useState(""),[m,w]=r.useState({totalTopics:0,totalPosts:0,activeToday:0});r.useEffect(()=>{l(),N()},[t]);const l=async()=>{try{const{data:v}=await S.from("forum_categories").select("*").order("name");z(v||[])}catch(v){console.error("Error fetching categories:",v)}},N=async()=>{u(!0),x("");try{t==="topics"?await k():await B()}catch(v){console.error("Error fetching data:",v),v.code==="42501"||v.message?.includes("permission denied")?x("Access denied. Run the FIX_ADMIN_PANEL_NOW.sql script in Supabase Dashboard."):x(`Failed to load data: ${v.message||"Unknown error"}`)}u(!1)},k=async()=>{const{data:v,error:G}=await S.from("forum_topics").select("*").order("created_at",{ascending:!1});if(G&&(console.warn("Error fetching topics:",G),G.code!=="PGRST116"))throw G;const P=[...new Set((v||[]).map(re=>re.user_id).filter(Boolean))],J=[...new Set((v||[]).map(re=>re.category_id).filter(Boolean))],{data:ge}=P.length>0?await S.from("profiles").select("id, email, full_name").in("id",P):{data:[]},{data:_e}=J.length>0?await S.from("forum_categories").select("id, name, slug").in("id",J):{data:[]},ye=Object.fromEntries((ge||[]).map(re=>[re.id,re])),be=Object.fromEntries((_e||[]).map(re=>[re.id,re])),b=(v||[]).map(re=>({...re,profiles:ye[re.user_id]||null,forum_categories:be[re.category_id]||null}));i(b);const $=new Date;$.setHours(0,0,0,0);const xe=b.filter(re=>new Date(re.created_at)>=$).length;w(re=>({...re,totalTopics:b.length,activeToday:xe}))},B=async()=>{const{data:v,error:G}=await S.from("forum_posts").select("*").order("created_at",{ascending:!1}).limit(100);if(G&&(console.warn("Error fetching posts:",G),G.code!=="PGRST116"))throw G;const P=[...new Set((v||[]).map($=>$.user_id).filter(Boolean))],J=[...new Set((v||[]).map($=>$.topic_id).filter(Boolean))],{data:ge}=P.length>0?await S.from("profiles").select("id, email, full_name").in("id",P):{data:[]},{data:_e}=J.length>0?await S.from("forum_topics").select("id, title").in("id",J):{data:[]},ye=Object.fromEntries((ge||[]).map($=>[$.id,$])),be=Object.fromEntries((_e||[]).map($=>[$.id,$])),b=(v||[]).map($=>({...$,profiles:ye[$.user_id]||null,forum_topics:be[$.topic_id]||null}));d(b),w($=>({...$,totalPosts:b.length}))},F=async(v,G)=>{if(window.confirm(`Delete topic "${G}" and all its posts? This cannot be undone.`))try{await S.from("forum_posts").delete().eq("topic_id",v);const{error:P}=await S.from("forum_topics").delete().eq("id",v);if(P)throw P;i(J=>J.filter(ge=>ge.id!==v)),X(`Topic "${G}" deleted`)}catch(P){console.error("Error deleting topic:",P),x("Failed to delete topic")}},A=async v=>{if(window.confirm("Delete this post? This cannot be undone."))try{const{error:G}=await S.from("forum_posts").delete().eq("id",v);if(G)throw G;d(P=>P.filter(J=>J.id!==v)),X("Post deleted")}catch(G){console.error("Error deleting post:",G),x("Failed to delete post")}},T=async(v,G)=>{try{const{error:P}=await S.from("forum_topics").update({is_pinned:!G}).eq("id",v);if(P)throw P;i(J=>J.map(ge=>ge.id===v?{...ge,is_pinned:!G}:ge)),X(G?"Topic unpinned":"Topic pinned")}catch(P){console.error("Error updating topic:",P)}},K=async(v,G)=>{try{const{error:P}=await S.from("forum_topics").update({is_locked:!G}).eq("id",v);if(P)throw P;i(J=>J.map(ge=>ge.id===v?{...ge,is_locked:!G}:ge)),X(G?"Topic unlocked":"Topic locked")}catch(P){console.error("Error updating topic:",P)}},X=v=>{C(v),setTimeout(()=>C(""),3e3)},n=v=>new Date(v).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),L=(v,G=100)=>v?v.length>G?v.substring(0,G)+"...":v:"",H=a.filter(v=>{const G=v.title?.toLowerCase().includes(g.toLowerCase()),P=!j||v.category_id===j;return G&&P}),V=o.filter(v=>v.content?.toLowerCase().includes(g.toLowerCase()));return e.jsxs("div",{className:Z.container,children:[e.jsxs("div",{className:Z.header,children:[e.jsxs("div",{children:[e.jsxs("h1",{children:[e.jsx(Ze,{size:28})," Forum Moderation"]}),e.jsx("p",{children:"Manage forum topics and posts"})]}),e.jsxs("button",{className:Z.refreshBtn,onClick:N,disabled:c,children:[e.jsx(Pe,{size:18,className:c?Z.spin:""}),"Refresh"]})]}),p&&e.jsxs("div",{className:Z.successBanner,children:[e.jsx(je,{size:18})," ",p]}),y&&e.jsxs("div",{className:Z.errorBanner,children:[e.jsx(ft,{size:18})," ",y]}),e.jsxs("div",{className:Z.statsGrid,children:[e.jsxs("div",{className:Z.statCard,children:[e.jsx(Ze,{size:24}),e.jsxs("div",{children:[e.jsx("span",{className:Z.statValue,children:m.totalTopics}),e.jsx("span",{className:Z.statLabel,children:"Topics"})]})]}),e.jsxs("div",{className:Z.statCard,children:[e.jsx(ke,{size:24}),e.jsxs("div",{children:[e.jsx("span",{className:Z.statValue,children:m.totalPosts}),e.jsx("span",{className:Z.statLabel,children:"Posts"})]})]}),e.jsxs("div",{className:Z.statCard,children:[e.jsx(Ce,{size:24}),e.jsxs("div",{children:[e.jsx("span",{className:Z.statValue,children:m.activeToday}),e.jsx("span",{className:Z.statLabel,children:"New Today"})]})]})]}),e.jsxs("div",{className:Z.tabs,children:[e.jsxs("button",{className:`${Z.tab} ${t==="topics"?Z.active:""}`,onClick:()=>s("topics"),children:[e.jsx(Ze,{size:18})," Topics"]}),e.jsxs("button",{className:`${Z.tab} ${t==="posts"?Z.active:""}`,onClick:()=>s("posts"),children:[e.jsx(ke,{size:18})," Posts"]})]}),e.jsxs("div",{className:Z.filters,children:[e.jsxs("div",{className:Z.searchBox,children:[e.jsx(qt,{size:20}),e.jsx("input",{type:"text",placeholder:t==="topics"?"Search topics...":"Search posts...",value:g,onChange:v=>h(v.target.value)})]}),t==="topics"&&D.length>0&&e.jsxs("select",{value:j,onChange:v=>I(v.target.value),className:Z.filterSelect,children:[e.jsx("option",{value:"",children:"All Categories"}),D.map(v=>e.jsx("option",{value:v.id,children:v.name},v.id))]})]}),c?e.jsxs("div",{className:Z.loading,children:[e.jsx(Pe,{size:24,className:Z.spin}),"Loading..."]}):t==="topics"?e.jsx("div",{className:Z.list,children:H.length===0?e.jsxs("div",{className:Z.emptyState,children:[e.jsx(Ze,{size:48}),e.jsx("h3",{children:"No topics found"})]}):H.map(v=>e.jsxs("div",{className:Z.item,children:[e.jsxs("div",{className:Z.itemContent,children:[e.jsxs("div",{className:Z.itemHeader,children:[e.jsx("h3",{children:v.title}),e.jsxs("div",{className:Z.badges,children:[v.is_pinned&&e.jsx("span",{className:Z.pinnedBadge,children:"Pinned"}),v.is_locked&&e.jsx("span",{className:Z.lockedBadge,children:"Locked"})]})]}),e.jsxs("div",{className:Z.itemMeta,children:[e.jsxs("span",{children:[e.jsx(ot,{size:14})," ",v.profiles?.full_name||v.profiles?.email?.split("@")[0]||"Unknown"]}),e.jsxs("span",{children:[e.jsx(Ce,{size:14})," ",n(v.created_at)]}),v.forum_categories&&e.jsx("span",{className:Z.categoryBadge,children:v.forum_categories.name}),e.jsxs("span",{children:[e.jsx(ss,{size:14})," ",v.likes_count||0]}),e.jsxs("span",{children:[e.jsx(ke,{size:14})," ",v.replies_count||0," replies"]})]})]}),e.jsxs("div",{className:Z.itemActions,children:[e.jsx("button",{onClick:()=>T(v.id,v.is_pinned),className:v.is_pinned?Z.unpinBtn:Z.pinBtn,title:v.is_pinned?"Unpin":"Pin",children:v.is_pinned?"Unpin":"Pin"}),e.jsx("button",{onClick:()=>K(v.id,v.is_locked),className:v.is_locked?Z.unlockBtn:Z.lockBtn,title:v.is_locked?"Unlock":"Lock",children:v.is_locked?"Unlock":"Lock"}),e.jsx("button",{onClick:()=>F(v.id,v.title),className:Z.deleteBtn,title:"Delete",children:e.jsx(Be,{size:16})})]})]},v.id))}):e.jsx("div",{className:Z.list,children:V.length===0?e.jsxs("div",{className:Z.emptyState,children:[e.jsx(ke,{size:48}),e.jsx("h3",{children:"No posts found"})]}):V.map(v=>e.jsxs("div",{className:Z.item,children:[e.jsxs("div",{className:Z.itemContent,children:[e.jsx("div",{className:Z.itemHeader,children:e.jsx("h4",{children:v.forum_topics?.title||"Unknown Topic"})}),e.jsx("p",{className:Z.postContent,children:L(v.content,200)}),e.jsxs("div",{className:Z.itemMeta,children:[e.jsxs("span",{children:[e.jsx(ot,{size:14})," ",v.profiles?.full_name||v.profiles?.email?.split("@")[0]||"Unknown"]}),e.jsxs("span",{children:[e.jsx(Ce,{size:14})," ",n(v.created_at)]}),e.jsxs("span",{children:[e.jsx(ss,{size:14})," ",v.likes_count||0]})]})]}),e.jsx("div",{className:Z.itemActions,children:e.jsx("button",{onClick:()=>A(v.id),className:Z.deleteBtn,title:"Delete",children:e.jsx(Be,{size:16})})})]},v.id))}),!c&&e.jsxs("div",{className:Z.resultsCount,children:["Showing ",t==="topics"?H.length:V.length," items"]})]})},Ph="_container_1e7ao_1",Eh="_header_1e7ao_7",$h="_refreshBtn_1e7ao_27",zh="_spin_1e7ao_48",Rh="_successBanner_1e7ao_63",Mh="_errorBanner_1e7ao_64",Oh="_statsGrid_1e7ao_87",Vh="_statCard_1e7ao_94",Fh="_statValue_1e7ao_109",Hh="_statLabel_1e7ao_114",Uh="_avgRating_1e7ao_119",Gh="_filters_1e7ao_133",Wh="_searchBox_1e7ao_139",qh="_filterSelect_1e7ao_163",Yh="_loading_1e7ao_174",Jh="_emptyState_1e7ao_175",Xh="_list_1e7ao_195",Zh="_reviewCard_1e7ao_201",Kh="_reviewHeader_1e7ao_213",Qh="_peptideInfo_1e7ao_221",ep="_peptideLink_1e7ao_227",tp="_stars_1e7ao_238",sp="_reviewComment_1e7ao_243",ap="_reviewMeta_1e7ao_250",np="_deleteBtn_1e7ao_263",ip="_resultsCount_1e7ao_283",ce={container:Ph,header:Eh,refreshBtn:$h,spin:zh,successBanner:Rh,errorBanner:Mh,statsGrid:Oh,statCard:Vh,statValue:Fh,statLabel:Hh,avgRating:Uh,filters:Gh,searchBox:Wh,filterSelect:qh,loading:Yh,emptyState:Jh,list:Xh,reviewCard:Zh,reviewHeader:Kh,peptideInfo:Qh,peptideLink:ep,stars:tp,reviewComment:sp,reviewMeta:ap,deleteBtn:np,resultsCount:ip},rp=()=>{const[t,s]=r.useState([]),[a,i]=r.useState(!0),[o,d]=r.useState(""),[c,u]=r.useState(""),[g,h]=r.useState(""),[j,I]=r.useState(""),[D,z]=r.useState({total:0,averageRating:0,fiveStar:0,oneStar:0});r.useEffect(()=>{p()},[]);const p=async()=>{i(!0);try{const{data:l,error:N}=await S.from("reviews").select("*").order("created_at",{ascending:!1});if(N)throw N;const k=[...new Set(l?.map(v=>v.user_id).filter(Boolean))],B=[...new Set(l?.map(v=>v.peptide_name).filter(Boolean))],{data:F}=k.length>0?await S.from("profiles").select("id, email, full_name").in("id",k):{data:[]},{data:A}=B.length>0?await S.from("peptides").select("id, name").in("name",B):{data:[]},T=Object.fromEntries((F||[]).map(v=>[v.id,v])),K=Object.fromEntries((A||[]).map(v=>[v.name,v])),X=(l||[]).map(v=>({...v,profiles:T[v.user_id]||null,peptides:K[v.peptide_name]||{name:v.peptide_name}}));s(X);const n=X?.length||0,L=n>0?(X.reduce((v,G)=>v+(G.rating||0),0)/n).toFixed(1):0,H=X?.filter(v=>v.rating===5).length||0,V=X?.filter(v=>v.rating===1).length||0;z({total:n,averageRating:L,fiveStar:H,oneStar:V})}catch(l){console.error("Error fetching reviews:",l),l.code==="PGRST301"||l.message?.includes("permission denied")?I("Access denied. RLS policies may need to be configured. Check browser console for details."):l.code==="42501"?I("Database permission error. Run the FIX_ADMIN_PANEL_NOW.sql script in Supabase Dashboard."):I(`Failed to load reviews: ${l.message||"Unknown error"}`)}i(!1)},C=async(l,N)=>{if(window.confirm(`Delete this review for "${N}"? This cannot be undone.`))try{const{error:k}=await S.from("reviews").delete().eq("id",l);if(k)throw k;s(B=>B.filter(F=>F.id!==l)),y("Review deleted successfully")}catch(k){console.error("Error deleting review:",k),I("Failed to delete review")}},y=l=>{h(l),setTimeout(()=>h(""),3e3)},x=l=>new Date(l).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),m=l=>e.jsx("div",{className:ce.stars,children:[1,2,3,4,5].map(N=>e.jsx(He,{size:16,fill:N<=l?"#f59e0b":"transparent",color:N<=l?"#f59e0b":"#6b7280"},N))}),w=t.filter(l=>{const N=l.comment?.toLowerCase().includes(o.toLowerCase())||l.peptides?.name?.toLowerCase().includes(o.toLowerCase())||l.profiles?.email?.toLowerCase().includes(o.toLowerCase()),k=!c||l.rating===parseInt(c);return N&&k});return e.jsxs("div",{className:ce.container,children:[e.jsxs("div",{className:ce.header,children:[e.jsxs("div",{children:[e.jsxs("h1",{children:[e.jsx(He,{size:28})," Review Moderation"]}),e.jsx("p",{children:"Manage peptide reviews"})]}),e.jsxs("button",{className:ce.refreshBtn,onClick:p,disabled:a,children:[e.jsx(Pe,{size:18,className:a?ce.spin:""}),"Refresh"]})]}),g&&e.jsxs("div",{className:ce.successBanner,children:[e.jsx(je,{size:18})," ",g]}),j&&e.jsxs("div",{className:ce.errorBanner,children:[e.jsx(ft,{size:18})," ",j]}),e.jsxs("div",{className:ce.statsGrid,children:[e.jsxs("div",{className:ce.statCard,children:[e.jsx(He,{size:24,style:{color:"#f59e0b"}}),e.jsxs("div",{children:[e.jsx("span",{className:ce.statValue,children:D.total}),e.jsx("span",{className:ce.statLabel,children:"Total Reviews"})]})]}),e.jsxs("div",{className:ce.statCard,children:[e.jsx("div",{className:ce.avgRating,children:e.jsx("span",{children:D.averageRating})}),e.jsxs("div",{children:[e.jsx("span",{className:ce.statValue,children:"Avg Rating"}),e.jsx("span",{className:ce.statLabel,children:"out of 5"})]})]}),e.jsxs("div",{className:ce.statCard,children:[e.jsx(ss,{size:24,style:{color:"#10b981"}}),e.jsxs("div",{children:[e.jsx("span",{className:ce.statValue,children:D.fiveStar}),e.jsx("span",{className:ce.statLabel,children:"5-Star Reviews"})]})]}),e.jsxs("div",{className:ce.statCard,children:[e.jsx(Da,{size:24,style:{color:"#ef4444"}}),e.jsxs("div",{children:[e.jsx("span",{className:ce.statValue,children:D.oneStar}),e.jsx("span",{className:ce.statLabel,children:"1-Star Reviews"})]})]})]}),e.jsxs("div",{className:ce.filters,children:[e.jsxs("div",{className:ce.searchBox,children:[e.jsx(qt,{size:20}),e.jsx("input",{type:"text",placeholder:"Search reviews by content, peptide, or user...",value:o,onChange:l=>d(l.target.value)})]}),e.jsxs("select",{value:c,onChange:l=>u(l.target.value),className:ce.filterSelect,children:[e.jsx("option",{value:"",children:"All Ratings"}),e.jsx("option",{value:"5",children:"5 Stars"}),e.jsx("option",{value:"4",children:"4 Stars"}),e.jsx("option",{value:"3",children:"3 Stars"}),e.jsx("option",{value:"2",children:"2 Stars"}),e.jsx("option",{value:"1",children:"1 Star"})]})]}),a?e.jsxs("div",{className:ce.loading,children:[e.jsx(Pe,{size:24,className:ce.spin}),"Loading reviews..."]}):w.length===0?e.jsxs("div",{className:ce.emptyState,children:[e.jsx(He,{size:48}),e.jsx("h3",{children:"No reviews found"}),e.jsx("p",{children:"Try adjusting your search or filters"})]}):e.jsx("div",{className:ce.list,children:w.map(l=>e.jsxs("div",{className:ce.reviewCard,children:[e.jsxs("div",{className:ce.reviewHeader,children:[e.jsxs("div",{className:ce.peptideInfo,children:[e.jsx(pe,{to:`/encyclopedia/${encodeURIComponent(l.peptides?.name||"")}`,className:ce.peptideLink,children:l.peptides?.name||"Unknown Peptide"}),m(l.rating)]}),e.jsxs("button",{onClick:()=>C(l.id,l.peptides?.name),className:ce.deleteBtn,title:"Delete review",children:[e.jsx(Be,{size:16}),"Delete"]})]}),l.comment&&e.jsx("p",{className:ce.reviewComment,children:l.comment}),e.jsxs("div",{className:ce.reviewMeta,children:[e.jsxs("span",{children:[e.jsx(ot,{size:14}),l.profiles?.full_name||l.profiles?.email?.split("@")[0]||"Anonymous"]}),e.jsxs("span",{children:[e.jsx(Ce,{size:14}),x(l.created_at)]})]})]},l.id))}),!a&&w.length>0&&e.jsxs("div",{className:ce.resultsCount,children:["Showing ",w.length," of ",t.length," reviews"]})]})},op="_container_u4ljx_1",cp="_header_u4ljx_7",lp="_headerActions_u4ljx_27",dp="_refreshBtn_u4ljx_32",mp="_scrapeBtn_u4ljx_33",up="_spin_u4ljx_70",hp="_successBanner_u4ljx_85",pp="_errorBanner_u4ljx_86",gp="_statsGrid_u4ljx_109",xp="_statCard_u4ljx_116",_p="_statValue_u4ljx_135",fp="_statLabel_u4ljx_140",jp="_tabs_u4ljx_146",yp="_tab_u4ljx_146",vp="_active_u4ljx_170",bp="_loading_u4ljx_176",wp="_overview_u4ljx_186",Sp="_priceTable_u4ljx_191",Np="_tableHeader_u4ljx_198",kp="_tableRow_u4ljx_199",Cp="_peptideName_u4ljx_222",Ip="_minPrice_u4ljx_226",Dp="_maxPrice_u4ljx_230",Tp="_vendorList_u4ljx_235",Lp="_vendorCard_u4ljx_241",Bp="_vendorInfo_u4ljx_251",Ap="_vendorLogo_u4ljx_257",Pp="_vendorMeta_u4ljx_279",Ep="_inactive_u4ljx_297",$p="_scrapeVendorBtn_u4ljx_301",zp="_priceGrid_u4ljx_321",Rp="_priceCard_u4ljx_327",Mp="_priceHeader_u4ljx_334",Op="_pricePeptide_u4ljx_340",Vp="_priceVendor_u4ljx_344",Fp="_priceBody_u4ljx_349",Hp="_priceDisplay_u4ljx_353",Up="_priceAmount_u4ljx_359",Gp="_editPrice_u4ljx_379",Wp="_priceUnit_u4ljx_413",qp="_priceMeta_u4ljx_418",Yp="_inStock_u4ljx_424",Jp="_outOfStock_u4ljx_428",Xp="_lastVerified_u4ljx_432",Zp="_logsList_u4ljx_437",Kp="_emptyLogs_u4ljx_443",Qp="_logItem_u4ljx_452",eg="_success_u4ljx_85",tg="_partial_u4ljx_463",sg="_failed_u4ljx_467",ag="_logHeader_u4ljx_471",ng="_logVendor_u4ljx_477",ig="_logStatus_u4ljx_481",rg="_logDetails_u4ljx_503",og="_logError_u4ljx_511",cg="_logTime_u4ljx_520",M={container:op,header:cp,headerActions:lp,refreshBtn:dp,scrapeBtn:mp,spin:up,successBanner:hp,errorBanner:pp,statsGrid:gp,statCard:xp,statValue:_p,statLabel:fp,tabs:jp,tab:yp,active:vp,loading:bp,overview:wp,priceTable:Sp,tableHeader:Np,tableRow:kp,peptideName:Cp,minPrice:Ip,maxPrice:Dp,vendorList:Tp,vendorCard:Lp,vendorInfo:Bp,vendorLogo:Ap,vendorMeta:Pp,inactive:Ep,scrapeVendorBtn:$p,priceGrid:zp,priceCard:Rp,priceHeader:Mp,pricePeptide:Op,priceVendor:Vp,priceBody:Fp,priceDisplay:Hp,priceAmount:Up,editPrice:Gp,priceUnit:Wp,priceMeta:qp,inStock:Yp,outOfStock:Jp,lastVerified:Xp,logsList:Zp,emptyLogs:Kp,logItem:Qp,success:eg,partial:tg,failed:sg,logHeader:ag,logVendor:ng,logStatus:ig,logDetails:rg,logError:og,logTime:cg},lg=()=>{const[t,s]=r.useState([]),[a,i]=r.useState([]),[o,d]=r.useState([]),[c,u]=r.useState(!0),[g,h]=r.useState(!1),[j,I]=r.useState(null),[D,z]=r.useState("overview"),[p,C]=r.useState(null),[y,x]=r.useState(""),[m,w]=r.useState(""),[l,N]=r.useState("");r.useEffect(()=>{k()},[]);const k=async()=>{u(!0);try{const{data:n}=await S.from("vendors").select("*").order("name");s(n||[]);const{data:L}=await S.from("peptide_prices").select(`
                    *,
                    vendors:vendor_id (name, slug, logo_emoji)
                `).order("peptide_name");i(L||[]);const{data:H}=await S.from("scrape_logs").select(`
                    *,
                    vendors:vendor_id (name)
                `).order("created_at",{ascending:!1}).limit(50);d(H||[])}catch(n){console.error("Error fetching data:",n),N("Failed to load data")}u(!1)},B=async(n=null)=>{h(!0),N("");try{const{data:{session:L}}=await S.auth.getSession();if(!L)throw new Error("Not authenticated");const H=n?t.filter(G=>G.slug===n):t.filter(G=>G.is_active);if(H.length===0)throw new Error("No active vendors found to scrape");let V=0,v=[];for(const G of H){I(G.slug);try{const P=await fetch("https://nhiwjerqyhtpienorzky.supabase.co/functions/v1/scrape-prices",{method:"POST",headers:{Authorization:`Bearer ${L.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({vendor_slug:G.slug})}),J=await P.json();if(!P.ok)throw new Error(J.error||"Scrape failed");V++}catch(P){console.error(`Error scraping ${G.name}:`,P),v.push(`${G.name}: ${P.message}`)}}v.length>0?V>0?(N(`Partial success. Errors: ${v.join("; ")}`),A(`Scraped ${V} vendors successfully.`)):N(`Scrape failed: ${v.join("; ")}`):A(`Scrape completed: ${V} vendor(s) processed`),k()}catch(L){console.error("Scrape error:",L),N(`Scrape failed: ${L.message}`)}h(!1),I(null)},F=async(n,L)=>{try{const{error:H}=await S.from("peptide_prices").update({price:parseFloat(L),updated_at:new Date().toISOString(),last_verified_at:new Date().toISOString()}).eq("id",n);if(H)throw H;A("Price updated"),C(null),k()}catch{N("Failed to update price")}},A=n=>{w(n),setTimeout(()=>w(""),3e3)},T=n=>n?new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never",K=()=>{const n={};return a.forEach(L=>{n[L.peptide_slug]||(n[L.peptide_slug]={name:L.peptide_name,prices:[]}),n[L.peptide_slug].prices.push(L.price)}),Object.entries(n).map(([L,H])=>({slug:L,name:H.name,minPrice:Math.min(...H.prices),maxPrice:Math.max(...H.prices),avgPrice:(H.prices.reduce((V,v)=>V+v,0)/H.prices.length).toFixed(2),vendorCount:H.prices.length})).sort((L,H)=>L.name.localeCompare(H.name))},X={totalVendors:t.length,activeVendors:t.filter(n=>n.is_active).length,totalPrices:a.length,lastScrape:o[0]?.created_at||null};return e.jsxs("div",{className:M.container,children:[e.jsxs("div",{className:M.header,children:[e.jsxs("div",{children:[e.jsxs("h1",{children:[e.jsx(Vt,{size:28})," Price Management"]}),e.jsx("p",{children:"Monitor and manage peptide prices across vendors"})]}),e.jsxs("div",{className:M.headerActions,children:[e.jsxs("button",{className:M.refreshBtn,onClick:k,disabled:c,children:[e.jsx(Pe,{size:18,className:c?M.spin:""}),"Refresh"]}),e.jsxs("button",{className:M.scrapeBtn,onClick:()=>B(),disabled:g,children:[e.jsx(ps,{size:18,className:g?M.spin:""}),g?"Scraping...":"Scrape All"]})]})]}),m&&e.jsxs("div",{className:M.successBanner,children:[e.jsx(je,{size:18})," ",m]}),l&&e.jsxs("div",{className:M.errorBanner,children:[e.jsx(ft,{size:18})," ",l]}),e.jsxs("div",{className:M.statsGrid,children:[e.jsxs("div",{className:M.statCard,children:[e.jsx(Qe,{size:24}),e.jsxs("div",{children:[e.jsx("span",{className:M.statValue,children:X.totalVendors}),e.jsx("span",{className:M.statLabel,children:"Vendors"})]})]}),e.jsxs("div",{className:M.statCard,children:[e.jsx(Vt,{size:24}),e.jsxs("div",{children:[e.jsx("span",{className:M.statValue,children:X.totalPrices}),e.jsx("span",{className:M.statLabel,children:"Price Records"})]})]}),e.jsxs("div",{className:M.statCard,children:[e.jsx(kt,{size:24}),e.jsxs("div",{children:[e.jsx("span",{className:M.statValue,children:K().length}),e.jsx("span",{className:M.statLabel,children:"Peptides Tracked"})]})]}),e.jsxs("div",{className:M.statCard,children:[e.jsx(ze,{size:24}),e.jsxs("div",{children:[e.jsx("span",{className:M.statValue,children:T(X.lastScrape)}),e.jsx("span",{className:M.statLabel,children:"Last Scrape"})]})]})]}),e.jsxs("div",{className:M.tabs,children:[e.jsx("button",{className:`${M.tab} ${D==="overview"?M.active:""}`,onClick:()=>z("overview"),children:"Overview"}),e.jsx("button",{className:`${M.tab} ${D==="vendors"?M.active:""}`,onClick:()=>z("vendors"),children:"Vendors"}),e.jsx("button",{className:`${M.tab} ${D==="prices"?M.active:""}`,onClick:()=>z("prices"),children:"All Prices"}),e.jsx("button",{className:`${M.tab} ${D==="logs"?M.active:""}`,onClick:()=>z("logs"),children:"Scrape Logs"})]}),c?e.jsxs("div",{className:M.loading,children:[e.jsx(Pe,{size:32,className:M.spin}),"Loading..."]}):e.jsxs(e.Fragment,{children:[D==="overview"&&e.jsxs("div",{className:M.overview,children:[e.jsx("h2",{children:"Price Summary by Peptide"}),e.jsxs("div",{className:M.priceTable,children:[e.jsxs("div",{className:M.tableHeader,children:[e.jsx("span",{children:"Peptide"}),e.jsx("span",{children:"Min Price"}),e.jsx("span",{children:"Max Price"}),e.jsx("span",{children:"Avg Price"}),e.jsx("span",{children:"Vendors"})]}),K().map(n=>e.jsxs("div",{className:M.tableRow,children:[e.jsx("span",{className:M.peptideName,children:n.name}),e.jsxs("span",{className:M.minPrice,children:["$",n.minPrice.toFixed(2)]}),e.jsxs("span",{className:M.maxPrice,children:["$",n.maxPrice.toFixed(2)]}),e.jsxs("span",{children:["$",n.avgPrice]}),e.jsx("span",{children:n.vendorCount})]},n.slug))]})]}),D==="vendors"&&e.jsx("div",{className:M.vendorList,children:t.map(n=>e.jsxs("div",{className:M.vendorCard,children:[e.jsxs("div",{className:M.vendorInfo,children:[e.jsx("span",{className:M.vendorLogo,children:n.logo_emoji}),e.jsxs("div",{children:[e.jsx("h3",{children:n.name}),e.jsx("p",{children:e.jsxs("a",{href:n.website_url,target:"_blank",rel:"noopener noreferrer",children:[n.website_url," ",e.jsx(os,{size:12})]})})]})]}),e.jsxs("div",{className:M.vendorMeta,children:[e.jsxs("span",{children:[e.jsx(ze,{size:14}),"Last scraped: ",T(n.last_scraped_at)]}),e.jsx("span",{className:n.is_active?M.active:M.inactive,children:n.is_active?"Active":"Inactive"})]}),e.jsx("button",{className:M.scrapeVendorBtn,onClick:()=>B(n.slug),disabled:g,children:j===n.slug?e.jsxs(e.Fragment,{children:[e.jsx(Pe,{size:16,className:M.spin})," Scraping..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ps,{size:16})," Scrape Now"]})})]},n.id))}),D==="prices"&&e.jsx("div",{className:M.allPrices,children:e.jsx("div",{className:M.priceGrid,children:a.map(n=>e.jsxs("div",{className:M.priceCard,children:[e.jsxs("div",{className:M.priceHeader,children:[e.jsx("span",{className:M.pricePeptide,children:n.peptide_name}),e.jsxs("span",{className:M.priceVendor,children:[n.vendors?.logo_emoji," ",n.vendors?.name]})]}),e.jsxs("div",{className:M.priceBody,children:[p===n.id?e.jsxs("div",{className:M.editPrice,children:[e.jsx("input",{type:"number",value:y,onChange:L=>x(L.target.value),step:"0.01",min:"0"}),e.jsx("button",{onClick:()=>F(n.id,y),children:e.jsx(Ps,{size:16})}),e.jsx("button",{onClick:()=>C(null),children:e.jsx(et,{size:16})})]}):e.jsxs("div",{className:M.priceDisplay,children:[e.jsxs("span",{className:M.priceAmount,children:["$",n.price.toFixed(2)]}),e.jsx("button",{onClick:()=>{C(n.id),x(n.price)},children:e.jsx(Je,{size:14})})]}),e.jsxs("span",{className:M.priceUnit,children:["per ",n.unit]})]}),e.jsxs("div",{className:M.priceMeta,children:[e.jsx("span",{className:n.in_stock?M.inStock:M.outOfStock,children:n.in_stock?"✓ In Stock":"✗ Out of Stock"}),e.jsx("span",{className:M.lastVerified,children:T(n.last_verified_at)})]})]},n.id))})}),D==="logs"&&e.jsx("div",{className:M.logsSection,children:e.jsx("div",{className:M.logsList,children:o.length===0?e.jsxs("div",{className:M.emptyLogs,children:[e.jsx(rt,{size:32}),e.jsx("p",{children:"No scrape logs yet. Run a scrape to see results."})]}):o.map(n=>e.jsxs("div",{className:`${M.logItem} ${M[n.status]}`,children:[e.jsxs("div",{className:M.logHeader,children:[e.jsx("span",{className:M.logVendor,children:n.vendors?.name||"Unknown"}),e.jsx("span",{className:`${M.logStatus} ${M[n.status]}`,children:n.status})]}),e.jsxs("div",{className:M.logDetails,children:[e.jsxs("span",{children:["Products found: ",n.products_found]}),e.jsxs("span",{children:["Products updated: ",n.products_updated]}),e.jsxs("span",{children:["Duration: ",n.duration_ms,"ms"]})]}),n.error_message&&e.jsx("div",{className:M.logError,children:n.error_message}),e.jsx("div",{className:M.logTime,children:T(n.created_at)})]},n.id))})})]})]})},dg=()=>{const[t,s]=r.useState(!1);r.useEffect(()=>{localStorage.getItem("cookie_consent")||s(!0)},[]);const a=()=>{localStorage.setItem("cookie_consent","accepted"),s(!1)};return t?e.jsxs("div",{style:{position:"fixed",bottom:"20px",left:"20px",right:"20px",maxWidth:"500px",background:"rgba(15, 23, 42, 0.95)",backdropFilter:"blur(10px)",border:"1px solid var(--glass-border)",borderRadius:"var(--radius-md)",padding:"1.5rem",zIndex:1e3,boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.3)",display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"start",gap:"1rem"},children:[e.jsx("div",{style:{padding:"0.5rem",background:"rgba(59, 130, 246, 0.1)",borderRadius:"50%",color:"#3b82f6"},children:e.jsx(Ta,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{style:{margin:"0 0 0.5rem 0",fontSize:"1rem"},children:"We use cookies"}),e.jsxs("p",{style:{margin:0,fontSize:"0.875rem",color:"var(--text-secondary)",lineHeight:"1.5"},children:["We use cookies to enhance your experience, analyze site traffic, and ensure security. By continuing to use our site, you consent to our use of cookies.",e.jsx("a",{href:"/privacy",style:{color:"var(--accent-primary)",marginLeft:"0.5rem"},children:"Learn more"})]})]})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",gap:"1rem"},children:e.jsx("button",{onClick:a,className:"btn-primary",style:{padding:"0.5rem 1.5rem",fontSize:"0.875rem"},children:"Accept All"})})]}):null},mg="_container_1ruxw_1",ug="_header_1ruxw_24",hg="_newTicketBtn_1ruxw_50",pg="_backBtn_1ruxw_70",gg="_ticketsList_1ruxw_91",xg="_ticketCard_1ruxw_97",_g="_ticketInfo_1ruxw_115",fg="_ticketMeta_1ruxw_131",jg="_chevron_1ruxw_139",yg="_statusBadge_1ruxw_144",vg="_emptyState_1ruxw_157",bg="_formTitle_1ruxw_192",wg="_form_1ruxw_192",Sg="_formRow_1ruxw_207",Ng="_formGroup_1ruxw_213",kg="_submitBtn_1ruxw_250",Cg="_ticketDetail_1ruxw_273",Ig="_ticketHeader_1ruxw_280",Dg="_ticketDescription_1ruxw_295",Tg="_messagesSection_1ruxw_310",Lg="_messagesList_1ruxw_316",Bg="_noMessages_1ruxw_325",Ag="_message_1ruxw_310",Pg="_userMessage_1ruxw_336",Eg="_adminMessage_1ruxw_342",$g="_messageHeader_1ruxw_348",zg="_replyForm_1ruxw_367",Rg="_error_1ruxw_408",Mg="_loading_1ruxw_417",oe={container:mg,header:ug,newTicketBtn:hg,backBtn:pg,ticketsList:gg,ticketCard:xg,ticketInfo:_g,ticketMeta:fg,chevron:jg,statusBadge:yg,emptyState:vg,formTitle:bg,form:wg,formRow:Sg,formGroup:Ng,submitBtn:kg,ticketDetail:Cg,ticketHeader:Ig,ticketDescription:Dg,messagesSection:Tg,messagesList:Lg,noMessages:Bg,message:Ag,userMessage:Pg,adminMessage:Eg,messageHeader:$g,replyForm:zg,error:Rg,loading:Mg},Og=()=>{const{user:t}=Se(),[s,a]=r.useState([]),[i,o]=r.useState(!0),[d,c]=r.useState(null),[u,g]=r.useState(!1),[h,j]=r.useState(null),[I,D]=r.useState(""),[z,p]=r.useState(!1),[C,y]=r.useState({subject:"",description:"",category:"general",priority:"normal"}),x=Ne.getCategories(),m=Ne.getPriorities(),w=Ne.getStatuses();r.useEffect(()=>{l()},[]);const l=async()=>{try{o(!0);const T=await Ne.getMyTickets();a(T||[])}catch(T){c("Failed to load tickets"),console.error(T)}finally{o(!1)}},N=async T=>{if(T.preventDefault(),!(!C.subject.trim()||!C.description.trim()))try{p(!0),await Ne.createTicket(C),y({subject:"",description:"",category:"general",priority:"normal"}),g(!1),await l()}catch(K){c("Failed to create ticket"),console.error(K)}finally{p(!1)}},k=async T=>{if(T.preventDefault(),!(!I.trim()||!h))try{p(!0),await Ne.addMessage(h.id,I),D("");const K=await Ne.getTicket(h.id);j(K),await l()}catch(K){c("Failed to send message"),console.error(K)}finally{p(!1)}},B=T=>{switch(T){case"open":return e.jsx(Ve,{size:16});case"in_progress":return e.jsx(ze,{size:16});case"resolved":return e.jsx(je,{size:16});default:return e.jsx(ke,{size:16})}},F=T=>({color:w.find(X=>X.id===T)?.color||"#6b7280"}),A=T=>new Date(T).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return t?h?e.jsxs("div",{className:oe.container,children:[e.jsxs("button",{className:oe.backBtn,onClick:()=>j(null),children:[e.jsx(Rt,{size:18}),"Back to Tickets"]}),e.jsxs("div",{className:oe.ticketDetail,children:[e.jsxs("div",{className:oe.ticketHeader,children:[e.jsx("h1",{children:h.subject}),e.jsxs("span",{className:oe.statusBadge,style:F(h.status),children:[B(h.status),h.status.replace("_"," ")]})]}),e.jsxs("div",{className:oe.ticketMeta,children:[e.jsxs("span",{children:["Category: ",x.find(T=>T.id===h.category)?.label]}),e.jsxs("span",{children:["Created: ",A(h.created_at)]})]}),e.jsx("div",{className:oe.ticketDescription,children:e.jsx("p",{children:h.description})}),e.jsxs("div",{className:oe.messagesSection,children:[e.jsx("h3",{children:"Messages"}),e.jsxs("div",{className:oe.messagesList,children:[h.ticket_messages?.length===0&&e.jsx("p",{className:oe.noMessages,children:"No messages yet. Add a reply below."}),h.ticket_messages?.map(T=>e.jsxs("div",{className:`${oe.message} ${T.is_admin_reply?oe.adminMessage:oe.userMessage}`,children:[e.jsxs("div",{className:oe.messageHeader,children:[e.jsx("span",{children:T.is_admin_reply?"🛡️ Support":"👤 You"}),e.jsx("span",{children:A(T.created_at)})]}),e.jsx("p",{children:T.message})]},T.id))]}),h.status!=="closed"&&e.jsxs("form",{onSubmit:k,className:oe.replyForm,children:[e.jsx("textarea",{placeholder:"Type your reply...",value:I,onChange:T=>D(T.target.value),rows:3}),e.jsxs("button",{type:"submit",disabled:z||!I.trim(),children:[e.jsx(Es,{size:18}),"Send Reply"]})]})]})]})]}):u?e.jsxs("div",{className:oe.container,children:[e.jsxs("button",{className:oe.backBtn,onClick:()=>g(!1),children:[e.jsx(Rt,{size:18}),"Back to Tickets"]}),e.jsxs("div",{className:"card glass-panel",children:[e.jsx("h2",{className:oe.formTitle,children:"Create New Ticket"}),e.jsxs("form",{onSubmit:N,className:oe.form,children:[e.jsxs("div",{className:oe.formGroup,children:[e.jsx("label",{children:"Subject"}),e.jsx("input",{type:"text",placeholder:"Brief description of your issue",value:C.subject,onChange:T=>y({...C,subject:T.target.value}),required:!0})]}),e.jsxs("div",{className:oe.formRow,children:[e.jsxs("div",{className:oe.formGroup,children:[e.jsx("label",{children:"Category"}),e.jsx("select",{value:C.category,onChange:T=>y({...C,category:T.target.value}),children:x.map(T=>e.jsx("option",{value:T.id,children:T.label},T.id))})]}),e.jsxs("div",{className:oe.formGroup,children:[e.jsx("label",{children:"Priority"}),e.jsx("select",{value:C.priority,onChange:T=>y({...C,priority:T.target.value}),children:m.map(T=>e.jsx("option",{value:T.id,children:T.label},T.id))})]})]}),e.jsxs("div",{className:oe.formGroup,children:[e.jsx("label",{children:"Description"}),e.jsx("textarea",{placeholder:"Please describe your issue in detail...",value:C.description,onChange:T=>y({...C,description:T.target.value}),rows:6,required:!0})]}),e.jsx("button",{type:"submit",className:oe.submitBtn,disabled:z,children:z?"Creating...":"Create Ticket"})]})]})]}):e.jsxs("div",{className:oe.container,children:[e.jsxs("div",{className:oe.header,children:[e.jsxs("div",{children:[e.jsxs("h1",{children:[e.jsx(ke,{size:28}),"Support Tickets"]}),e.jsx("p",{children:"Get help from our support team"})]}),e.jsxs("button",{className:oe.newTicketBtn,onClick:()=>g(!0),children:[e.jsx(Ke,{size:18}),"New Ticket"]})]}),d&&e.jsx("div",{className:oe.error,children:d}),i?e.jsx("div",{className:oe.loading,children:"Loading tickets..."}):s.length===0?e.jsxs("div",{className:oe.emptyState,children:[e.jsx(ke,{size:48}),e.jsx("h2",{children:"No Tickets Yet"}),e.jsx("p",{children:"Create a ticket to get help from our support team."}),e.jsxs("button",{onClick:()=>g(!0),children:[e.jsx(Ke,{size:18}),"Create Your First Ticket"]})]}):e.jsx("div",{className:oe.ticketsList,children:s.map(T=>e.jsxs("div",{className:oe.ticketCard,onClick:()=>j(T),children:[e.jsxs("div",{className:oe.ticketInfo,children:[e.jsxs("span",{className:oe.statusBadge,style:F(T.status),children:[B(T.status),T.status.replace("_"," ")]}),e.jsx("h3",{children:T.subject}),e.jsxs("p",{children:[T.description.substring(0,100),"..."]}),e.jsxs("div",{className:oe.ticketMeta,children:[e.jsx("span",{children:x.find(K=>K.id===T.category)?.label}),e.jsx("span",{children:"•"}),e.jsx("span",{children:A(T.updated_at)}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[T.ticket_messages?.length||0," messages"]})]})]}),e.jsx(gt,{size:20,className:oe.chevron})]},T.id))})]}):e.jsx("div",{className:oe.container,children:e.jsxs("div",{className:oe.emptyState,children:[e.jsx(ke,{size:48}),e.jsx("h2",{children:"Support Tickets"}),e.jsx("p",{children:"Please log in to view and create support tickets."})]})})},Vg="_container_8ifs8_1",Fg="_header_8ifs8_7",Hg="_stats_8ifs8_28",Ug="_statItem_8ifs8_33",Gg="_filters_8ifs8_41",Wg="_content_8ifs8_58",qg="_ticketsList_8ifs8_66",Yg="_ticketCard_8ifs8_75",Jg="_selected_8ifs8_88",Xg="_ticketTop_8ifs8_93",Zg="_priority_8ifs8_100",Kg="_status_8ifs8_106",Qg="_userInfo_8ifs8_124",ex="_ticketMeta_8ifs8_133",tx="_ticketDetail_8ifs8_141",sx="_noSelection_8ifs8_150",ax="_detailHeader_8ifs8_165",nx="_detailMeta_8ifs8_171",ix="_statusSelect_8ifs8_185",rx="_description_8ifs8_205",ox="_messages_8ifs8_226",cx="_noMessages_8ifs8_238",lx="_message_8ifs8_226",dx="_userMsg_8ifs8_250",mx="_adminMsg_8ifs8_255",ux="_msgHeader_8ifs8_260",hx="_replyForm_8ifs8_278",px="_error_8ifs8_319",gx="_loading_8ifs8_328",xx="_empty_8ifs8_329",me={container:Vg,header:Fg,stats:Hg,statItem:Ug,filters:Gg,content:Wg,ticketsList:qg,ticketCard:Yg,selected:Jg,ticketTop:Xg,priority:Zg,status:Kg,userInfo:Qg,ticketMeta:ex,ticketDetail:tx,noSelection:sx,detailHeader:ax,detailMeta:nx,statusSelect:ix,description:rx,messages:ox,noMessages:cx,message:lx,userMsg:dx,adminMsg:mx,msgHeader:ux,replyForm:hx,error:px,loading:gx,empty:xx},_x=()=>{const[t,s]=r.useState([]),[a,i]=r.useState(!0),[o,d]=r.useState(null),[c,u]=r.useState(null),[g,h]=r.useState(""),[j,I]=r.useState(""),[D,z]=r.useState(!1),p=Ne.getStatuses(),C=Ne.getCategories(),y=Ne.getPriorities();r.useEffect(()=>{x()},[g]);const x=async()=>{try{i(!0),d(null);const A=await Ne.getAllTickets(g||null);s(A||[])}catch(A){d("Failed to load tickets"),console.error(A)}finally{i(!1)}},m=async(A,T)=>{try{if(await Ne.updateTicketStatus(A,T),await x(),c?.id===A){const K=await Ne.getTicket(A);u(K)}}catch(K){d("Failed to update status"),console.error(K)}},w=async A=>{if(A.preventDefault(),!(!j.trim()||!c))try{z(!0),await Ne.addMessage(c.id,j,!0),I("");const T=await Ne.getTicket(c.id);u(T),await x()}catch(T){d("Failed to send reply"),console.error(T)}finally{z(!1)}},l=A=>{switch(A){case"open":return e.jsx(Ve,{size:14});case"in_progress":return e.jsx(ze,{size:14});case"resolved":return e.jsx(je,{size:14});default:return e.jsx(ke,{size:14})}},N=A=>p.find(K=>K.id===A)?.color||"#6b7280",k=A=>y.find(K=>K.id===A)?.color||"#6b7280",B=A=>new Date(A).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),F={all:t.length,open:t.filter(A=>A.status==="open").length,in_progress:t.filter(A=>A.status==="in_progress").length,resolved:t.filter(A=>A.status==="resolved").length};return e.jsxs("div",{className:me.container,children:[e.jsxs("div",{className:me.header,children:[e.jsxs("h1",{children:[e.jsx(ke,{size:28}),"Support Tickets"]}),e.jsxs("div",{className:me.stats,children:[e.jsxs("span",{className:me.statItem,children:[e.jsx(Ve,{size:16,style:{color:"#3b82f6"}}),F.open," Open"]}),e.jsxs("span",{className:me.statItem,children:[e.jsx(ze,{size:16,style:{color:"#f59e0b"}}),F.in_progress," In Progress"]}),e.jsxs("span",{className:me.statItem,children:[e.jsx(je,{size:16,style:{color:"#10b981"}}),F.resolved," Resolved"]})]})]}),e.jsxs("div",{className:me.filters,children:[e.jsx($s,{size:18}),e.jsxs("select",{value:g,onChange:A=>h(A.target.value),children:[e.jsx("option",{value:"",children:"All Tickets"}),p.map(A=>e.jsx("option",{value:A.id,children:A.label},A.id))]})]}),o&&e.jsx("div",{className:me.error,children:o}),e.jsxs("div",{className:me.content,children:[e.jsx("div",{className:me.ticketsList,children:a?e.jsx("div",{className:me.loading,children:"Loading..."}):t.length===0?e.jsx("div",{className:me.empty,children:"No tickets found"}):t.map(A=>e.jsxs("div",{className:`${me.ticketCard} ${c?.id===A.id?me.selected:""}`,onClick:()=>u(A),children:[e.jsxs("div",{className:me.ticketTop,children:[e.jsx("span",{className:me.priority,style:{background:k(A.priority)}}),e.jsxs("span",{className:me.status,style:{color:N(A.status)},children:[l(A.status),A.status.replace("_"," ")]})]}),e.jsx("h3",{children:A.subject}),e.jsxs("p",{className:me.userInfo,children:[e.jsx(ot,{size:14}),A.profiles?.email||"Unknown"]}),e.jsxs("div",{className:me.ticketMeta,children:[e.jsx("span",{children:C.find(T=>T.id===A.category)?.label}),e.jsx("span",{children:B(A.updated_at)})]})]},A.id))}),e.jsx("div",{className:me.ticketDetail,children:c?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:me.detailHeader,children:[e.jsx("h2",{children:c.subject}),e.jsxs("div",{className:me.detailMeta,children:[e.jsxs("span",{children:[e.jsx(ot,{size:16}),c.profiles?.email]}),e.jsx("span",{children:B(c.created_at)})]})]}),e.jsxs("div",{className:me.statusSelect,children:[e.jsx("label",{children:"Status:"}),e.jsx("select",{value:c.status,onChange:A=>m(c.id,A.target.value),children:p.map(A=>e.jsx("option",{value:A.id,children:A.label},A.id))})]}),e.jsxs("div",{className:me.description,children:[e.jsx("h4",{children:"Description"}),e.jsx("p",{children:c.description})]}),e.jsxs("div",{className:me.messages,children:[e.jsx("h4",{children:"Conversation"}),c.ticket_messages?.length===0?e.jsx("p",{className:me.noMessages,children:"No messages yet"}):c.ticket_messages?.map(A=>e.jsxs("div",{className:`${me.message} ${A.is_admin_reply?me.adminMsg:me.userMsg}`,children:[e.jsxs("div",{className:me.msgHeader,children:[e.jsx("span",{children:A.is_admin_reply?"🛡️ Admin":"👤 User"}),e.jsx("span",{children:B(A.created_at)})]}),e.jsx("p",{children:A.message})]},A.id))]}),e.jsxs("form",{onSubmit:w,className:me.replyForm,children:[e.jsx("textarea",{placeholder:"Type your reply...",value:j,onChange:A=>I(A.target.value),rows:3}),e.jsxs("button",{type:"submit",disabled:D||!j.trim(),children:[e.jsx(Es,{size:18}),"Send Reply"]})]})]}):e.jsxs("div",{className:me.noSelection,children:[e.jsx(ke,{size:48}),e.jsx("p",{children:"Select a ticket to view details"})]})})]})]})},fx="_container_1mf7s_1",jx="_header_1mf7s_7",yx="_headerActions_1mf7s_26",vx="_viewToggle_1mf7s_32",bx="_viewBtn_1mf7s_40",wx="_active_1mf7s_57",Sx="_refreshBtn_1mf7s_62",Nx="_statsGrid_1mf7s_82",kx="_statCard_1mf7s_89",Cx="_statValue_1mf7s_99",Ix="_statLabel_1mf7s_108",Dx="_filters_1mf7s_115",Tx="_filterIcon_1mf7s_123",Lx="_dateFilter_1mf7s_140",Bx="_clearBtn_1mf7s_156",Ax="_timeline_1mf7s_167",Px="_timelineItem_1mf7s_188",Ex="_expanded_1mf7s_206",$x="_timelineIcon_1mf7s_215",zx="_timelineContent_1mf7s_231",Rx="_timelineHeader_1mf7s_236",Mx="_timelineDescription_1mf7s_243",Ox="_timelineTime_1mf7s_250",Vx="_timelineMeta_1mf7s_260",Fx="_categoryBadge_1mf7s_268",Hx="_entityId_1mf7s_280",Ux="_changeDetails_1mf7s_287",Gx="_changeList_1mf7s_316",Wx="_changeItem_1mf7s_322",qx="_changeLabel_1mf7s_331",Yx="_changeValues_1mf7s_338",Jx="_oldValue_1mf7s_345",Xx="_arrow_1mf7s_351",Zx="_newValue_1mf7s_355",Kx="_setValue_1mf7s_360",Qx="_exactTime_1mf7s_365",e_="_rawData_1mf7s_376",t_="_tableWrapper_1mf7s_390",s_="_table_1mf7s_390",a_="_timestamp_1mf7s_428",n_="_user_1mf7s_434",i_="_activity_1mf7s_441",r_="_details_1mf7s_446",o_="_pagination_1mf7s_477",c_="_loading_1mf7s_515",l_="_spinner_1mf7s_525",d_="_empty_1mf7s_534",m_="_error_1mf7s_548",Y={container:fx,header:jx,headerActions:yx,viewToggle:vx,viewBtn:bx,active:wx,refreshBtn:Sx,statsGrid:Nx,statCard:kx,statValue:Cx,statLabel:Ix,filters:Dx,filterIcon:Tx,dateFilter:Lx,clearBtn:Bx,timeline:Ax,timelineItem:Px,expanded:Ex,timelineIcon:$x,timelineContent:zx,timelineHeader:Rx,timelineDescription:Mx,timelineTime:Ox,timelineMeta:Vx,categoryBadge:Fx,entityId:Hx,changeDetails:Ux,changeList:Gx,changeItem:Wx,changeLabel:qx,changeValues:Yx,oldValue:Jx,arrow:Xx,newValue:Zx,setValue:Kx,exactTime:Qx,rawData:e_,tableWrapper:t_,table:s_,timestamp:a_,user:n_,activity:i_,details:r_,pagination:o_,loading:c_,spinner:l_,empty:d_,error:m_},Ss={login:St,logout:As,profile_updated:gs,profile_created:ts,injection_created:Ke,injection_updated:Je,injection_deleted:Be,schedule_created:Ce,schedule_updated:Je,schedule_deleted:Be,schedule_completed:je,review_created:He,review_updated:Je,review_deleted:Be,inventory_created:Gt,inventory_updated:Je,inventory_deleted:Be,export_data:Wt,password_changed:Aa,email_changed:Dt,settings_updated:gs,notification_sent:rs,ticket_created:Ze,ticket_updated:Je,admin_action:Ae,view:It,error:rt,default:Ee},u_=()=>{const[t,s]=r.useState([]),[a,i]=r.useState(!0),[o,d]=r.useState(null),[c,u]=r.useState(0),[g,h]=r.useState(null),[j,I]=r.useState("timeline"),[D,z]=r.useState(null),[p,C]=r.useState({action:"",entityType:"",startDate:"",endDate:""}),[y,x]=r.useState(0),m=50,[w,l]=r.useState([]),[N,k]=r.useState([]);r.useEffect(()=>{B(),F()},[]),r.useEffect(()=>{A()},[y,p]);const B=async()=>{try{const[b,$]=await Promise.all([Xe.getActionTypes(),Xe.getEntityTypes()]);l(b),k($)}catch(b){console.error("Failed to load filter options:",b)}},F=async()=>{try{const b=await Xe.getStats(7);h(b)}catch(b){console.error("Failed to load stats:",b)}},A=async()=>{try{i(!0),d(null);const{data:b,count:$}=await Xe.getAllLogs({limit:m,offset:y*m,action:p.action||null,entityType:p.entityType||null,startDate:p.startDate||null,endDate:p.endDate||null});s(b||[]),u($||0)}catch(b){d("Failed to load audit logs"),console.error(b)}finally{i(!1)}},T=(b,$)=>{C(xe=>({...xe,[b]:$})),x(0)},K=()=>{C({action:"",entityType:"",startDate:"",endDate:""}),x(0)},X=b=>{const $=new Date,xe=new Date(b),re=Math.floor(($-xe)/1e3);return re<60?"Just now":re<3600?`${Math.floor(re/60)} min ago`:re<86400?`${Math.floor(re/3600)} hours ago`:re<604800?`${Math.floor(re/86400)} days ago`:xe.toLocaleDateString("en-US",{month:"short",day:"numeric",year:xe.getFullYear()!==$.getFullYear()?"numeric":void 0})},n=b=>new Date(b).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"}),L=b=>{const $=b.profiles?.full_name||b.profiles?.email?.split("@")[0]||"Someone",xe=b.entity_type?b.entity_type.replace(/_/g," "):"";return{login:()=>`${$} signed in`,logout:()=>`${$} signed out`,profile_updated:()=>`${$} updated their profile`,profile_created:()=>`${$} created an account`,injection_created:()=>`${$} logged a new injection${H(b)}`,injection_updated:()=>`${$} updated an injection record`,injection_deleted:()=>`${$} deleted an injection record`,schedule_created:()=>`${$} created a new schedule${V(b)}`,schedule_updated:()=>`${$} updated a schedule`,schedule_deleted:()=>`${$} deleted a schedule`,schedule_completed:()=>`${$} marked a dose as complete`,review_created:()=>`${$} wrote a review${v(b)}`,review_updated:()=>`${$} edited a review`,review_deleted:()=>`${$} deleted a review`,inventory_created:()=>`${$} added to inventory${G(b)}`,inventory_updated:()=>`${$} updated inventory`,inventory_deleted:()=>`${$} removed from inventory`,export_data:()=>`${$} exported their data`,password_changed:()=>`${$} changed their password`,email_changed:()=>`${$} changed their email`,settings_updated:()=>`${$} updated settings`,notification_sent:()=>`Notification sent to ${$}`,ticket_created:()=>`${$} opened a support ticket`,ticket_updated:()=>"Support ticket updated",admin_action:()=>`Admin action by ${$}`,view:()=>`${$} viewed ${xe}`}[b.action]?.()||`${$} performed ${b.action.replace(/_/g," ")} on ${xe}`},H=b=>{const $=b.new_values||b.metadata;return $&&$.peptide_name?` of ${$.peptide_name}`:""},V=b=>{const $=b.new_values||b.metadata;return $&&$.peptide_name?` for ${$.peptide_name}`:""},v=b=>{const $=b.new_values||b.metadata;return $?$.peptide_name?` for ${$.peptide_name}`:$.rating?` (${$.rating}★)`:"":""},G=b=>{const $=b.new_values||b.metadata;return $&&$.peptide_name?`: ${$.peptide_name}`:""},P=b=>{if(!b.new_values&&!b.old_values&&!b.metadata)return null;const $=[],xe=b.new_values||{},re=b.old_values||{},Re={...b.metadata||{},...xe},O=["id","user_id","created_at","updated_at","profile_id"];return Object.entries(Re).forEach(([ue,$e])=>{if(O.includes(ue)||$e==null)return;const Lt=ue.replace(/_/g," ").replace(/\b\w/g,Yt=>Yt.toUpperCase()),Ge=re[ue];Ge!==void 0&&Ge!==$e?$.push({type:"changed",label:Lt,oldValue:J(Ge),newValue:J($e)}):re[ue]||$.push({type:"set",label:Lt,value:J($e)})}),$.length>0?$:null},J=b=>b==null?"None":typeof b=="boolean"?b?"Yes":"No":typeof b=="object"?JSON.stringify(b):typeof b=="number"?b.toLocaleString():String(b),ge=b=>Ss[b]||Ss.default,_e=b=>b.includes("login")||b.includes("logout")||b.includes("password")||b.includes("email")?"auth":b.includes("injection")?"injection":b.includes("schedule")?"schedule":b.includes("review")?"review":b.includes("inventory")?"inventory":b.includes("profile")||b.includes("settings")?"profile":b.includes("admin")||b.includes("ticket")?"admin":"other",ye={auth:"#8b5cf6",injection:"#10b981",schedule:"#3b82f6",review:"#f59e0b",inventory:"#06b6d4",profile:"#ec4899",admin:"#ef4444",other:"#6b7280"},be=Math.ceil(c/m);return e.jsxs("div",{className:Y.container,children:[e.jsxs("div",{className:Y.header,children:[e.jsxs("h1",{children:[e.jsx(Ee,{size:28}),"Activity Log"]}),e.jsxs("div",{className:Y.headerActions,children:[e.jsxs("div",{className:Y.viewToggle,children:[e.jsx("button",{className:`${Y.viewBtn} ${j==="timeline"?Y.active:""}`,onClick:()=>I("timeline"),title:"Timeline View",children:e.jsx(La,{size:18})}),e.jsx("button",{className:`${Y.viewBtn} ${j==="table"?Y.active:""}`,onClick:()=>I("table"),title:"Table View",children:e.jsx(Ba,{size:18})})]}),e.jsxs("button",{className:Y.refreshBtn,onClick:()=>{A(),F()},children:[e.jsx(Pe,{size:18}),"Refresh"]})]})]}),g&&e.jsxs("div",{className:Y.statsGrid,children:[e.jsxs("div",{className:Y.statCard,children:[e.jsx("span",{className:Y.statValue,children:g.total}),e.jsx("span",{className:Y.statLabel,children:"Events (7 days)"})]}),e.jsxs("div",{className:Y.statCard,children:[e.jsx("span",{className:Y.statValue,children:Object.keys(g.byAction).length}),e.jsx("span",{className:Y.statLabel,children:"Action Types"})]}),e.jsxs("div",{className:Y.statCard,children:[e.jsx("span",{className:Y.statValue,children:Object.keys(g.byDay).length}),e.jsx("span",{className:Y.statLabel,children:"Active Days"})]}),e.jsxs("div",{className:Y.statCard,children:[e.jsx("span",{className:Y.statValue,children:Math.round(g.total/Math.max(Object.keys(g.byDay).length,1))}),e.jsx("span",{className:Y.statLabel,children:"Avg/Day"})]})]}),e.jsxs("div",{className:Y.filters,children:[e.jsxs("div",{className:Y.filterIcon,children:[e.jsx($s,{size:18}),"Filters:"]}),e.jsxs("select",{value:p.action,onChange:b=>T("action",b.target.value),children:[e.jsx("option",{value:"",children:"All Actions"}),w.map(b=>e.jsx("option",{value:b,children:Xe.formatAction(b)},b))]}),e.jsxs("select",{value:p.entityType,onChange:b=>T("entityType",b.target.value),children:[e.jsx("option",{value:"",children:"All Entities"}),N.map(b=>e.jsx("option",{value:b,children:b},b))]}),e.jsxs("div",{className:Y.dateFilter,children:[e.jsx(Ce,{size:16}),e.jsx("input",{type:"date",value:p.startDate,onChange:b=>T("startDate",b.target.value),placeholder:"Start date"}),e.jsx("span",{children:"to"}),e.jsx("input",{type:"date",value:p.endDate,onChange:b=>T("endDate",b.target.value),placeholder:"End date"})]}),(p.action||p.entityType||p.startDate||p.endDate)&&e.jsx("button",{className:Y.clearBtn,onClick:K,children:"Clear"})]}),o&&e.jsx("div",{className:Y.error,children:o}),j==="timeline"&&e.jsx("div",{className:Y.timeline,children:a?e.jsxs("div",{className:Y.loading,children:[e.jsx(Pe,{size:24,className:Y.spinner}),"Loading activity..."]}):t.length===0?e.jsxs("div",{className:Y.empty,children:[e.jsx(Ee,{size:48}),e.jsx("p",{children:"No activity found"})]}):t.map(b=>{const $=ge(b.action),xe=_e(b.action),re=ye[xe],Ue=P(b),Re=D===b.id;return e.jsxs("div",{className:`${Y.timelineItem} ${Re?Y.expanded:""}`,onClick:()=>z(Re?null:b.id),children:[e.jsx("div",{className:Y.timelineIcon,style:{backgroundColor:`${re}20`,color:re},children:e.jsx($,{size:18})}),e.jsxs("div",{className:Y.timelineContent,children:[e.jsxs("div",{className:Y.timelineHeader,children:[e.jsx("p",{className:Y.timelineDescription,children:L(b)}),e.jsxs("span",{className:Y.timelineTime,title:n(b.created_at),children:[e.jsx(ze,{size:12}),X(b.created_at)]})]}),b.entity_type&&e.jsxs("div",{className:Y.timelineMeta,children:[e.jsx("span",{className:Y.categoryBadge,style:{backgroundColor:`${re}15`,color:re,borderColor:`${re}30`},children:b.entity_type}),b.entity_id&&e.jsxs("span",{className:Y.entityId,children:["ID: ",b.entity_id.substring(0,8),"..."]})]}),Re&&Ue&&e.jsxs("div",{className:Y.changeDetails,children:[e.jsx("h4",{children:"Changes"}),e.jsx("div",{className:Y.changeList,children:Ue.map((O,ue)=>e.jsxs("div",{className:Y.changeItem,children:[e.jsx("span",{className:Y.changeLabel,children:O.label}),O.type==="changed"?e.jsxs("div",{className:Y.changeValues,children:[e.jsx("span",{className:Y.oldValue,children:O.oldValue}),e.jsx("span",{className:Y.arrow,children:"→"}),e.jsx("span",{className:Y.newValue,children:O.newValue})]}):e.jsx("span",{className:Y.setValue,children:O.value})]},ue))}),e.jsxs("div",{className:Y.exactTime,children:[e.jsx(ze,{size:12}),n(b.created_at)]})]}),Re&&!Ue&&(b.new_values||b.metadata)&&e.jsxs("div",{className:Y.changeDetails,children:[e.jsx("h4",{children:"Raw Data"}),e.jsx("pre",{className:Y.rawData,children:JSON.stringify(b.new_values||b.metadata,null,2)})]})]})]},b.id)})}),j==="table"&&e.jsx("div",{className:Y.tableWrapper,children:e.jsxs("table",{className:Y.table,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Time"}),e.jsx("th",{children:"User"}),e.jsx("th",{children:"Activity"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Details"})]})}),e.jsx("tbody",{children:a?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:Y.loading,children:"Loading..."})}):t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:Y.empty,children:"No logs found"})}):t.map(b=>{const $=_e(b.action),xe=ye[$];return e.jsxs("tr",{children:[e.jsx("td",{className:Y.timestamp,title:n(b.created_at),children:X(b.created_at)}),e.jsxs("td",{className:Y.user,children:[e.jsx(ot,{size:14}),b.profiles?.full_name||b.profiles?.email?.split("@")[0]||"System"]}),e.jsx("td",{className:Y.activity,children:L(b)}),e.jsx("td",{children:e.jsx("span",{className:Y.categoryBadge,style:{backgroundColor:`${xe}15`,color:xe,borderColor:`${xe}30`},children:b.entity_type||$})}),e.jsx("td",{className:Y.details,children:(b.new_values||b.metadata)&&e.jsxs("details",{children:[e.jsx("summary",{children:"View"}),e.jsx("pre",{children:JSON.stringify(b.new_values||b.metadata,null,2)})]})})]},b.id)})})]})}),c>m&&e.jsxs("div",{className:Y.pagination,children:[e.jsxs("button",{disabled:y===0,onClick:()=>x(b=>b-1),children:[e.jsx(is,{size:18}),"Previous"]}),e.jsxs("span",{children:["Page ",y+1," of ",be," (",c," total)"]}),e.jsxs("button",{disabled:y>=be-1,onClick:()=>x(b=>b+1),children:["Next",e.jsx(gt,{size:18})]})]})]})},dt={DEBUG:0,INFO:1,WARN:2,ERROR:3,CRITICAL:4};let st=[];const Ns=100,Ye={async healthCheck(){const t=performance.now(),s={timestamp:new Date().toISOString(),status:"healthy",version:"1.0.0",checks:{}};try{const{error:a}=await S.from("profiles").select("id").limit(1);s.checks.database={status:a?"unhealthy":"healthy",latency:Math.round(performance.now()-t)};const{data:i}=await S.auth.getSession();s.checks.auth={status:"healthy",sessionActive:!!i?.session},s.checks.storage={status:"healthy"};const o=Object.values(s.checks).some(d=>d.status!=="healthy");s.status=o?"degraded":"healthy",s.responseTime=Math.round(performance.now()-t)}catch(a){s.status="unhealthy",s.error=a.message}return s},getUptimeConfig(){return{endpoints:[{name:"Main App",url:window.location.origin,checkInterval:60,expectedStatus:200},{name:"API Health",url:"https://nhiwjerqyhtpienorzky.supabase.co/rest/v1/",checkInterval:60,expectedStatus:200,headers:{apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5oaXdqZXJxeWh0cGllbm9yemt5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQxODU1MDEsImV4cCI6MjA3OTc2MTUwMX0.F4vRdN3qeH2ONDxoIgchW3Pn21KsGAWavwdnD3zkxhI"}}],providers:{uptimeRobot:"https://uptimerobot.com - Free tier: 50 monitors",checkly:"https://checklyhq.com - Free tier: 5 checks",betterUptime:"https://betteruptime.com - Free tier: 10 monitors"}}},log(t,s,a={}){const i={id:crypto.randomUUID(),timestamp:new Date().toISOString(),level:t.toUpperCase(),message:s,context:{...a,url:window.location.href,userAgent:navigator.userAgent,userId:a.userId||null}};return st.unshift(i),st.length>Ns&&(st=st.slice(0,Ns)),console[t==="error"||t==="critical"?"error":t==="warn"?"warn":t==="debug"?"debug":"log"](`[${t.toUpperCase()}] ${s}`,a),dt[t.toUpperCase()]>=dt.ERROR&&this._sendToExternalLogger(i),i},debug(t,s){return this.log("debug",t,s)},info(t,s){return this.log("info",t,s)},warn(t,s){return this.log("warn",t,s)},error(t,s){return this.log("error",t,s)},critical(t,s){return this.log("critical",t,s)},getRecentLogs(t=50,s=null){let a=st.slice(0,t);if(s){const i=dt[s.toUpperCase()]||0;a=a.filter(o=>dt[o.level]>=i)}return a},async persistLogs(){if(st.length===0)return{success:!0,count:0};try{const t=st.filter(s=>dt[s.level]>=dt.WARN);if(t.length>0){const{error:s}=await S.from("system_logs").insert(t.map(a=>({level:a.level,message:a.message,context:a.context,created_at:a.timestamp})));if(s)throw s}return{success:!0,count:t.length}}catch(t){return console.error("Failed to persist logs:",t),{success:!1,error:t.message}}},_sendToExternalLogger(t){window.Sentry&&(t.level==="CRITICAL"||t.level==="ERROR")&&window.Sentry.captureMessage(t.message,{level:t.level.toLowerCase(),extra:t.context}),window.LogRocket&&window.LogRocket.log(t.message,t.context)},alerts:[],alertSubscribers:[],createAlert(t,s,a,i="info",o={}){const d={id:crypto.randomUUID(),type:t,title:s,message:a,severity:i,metadata:o,createdAt:new Date().toISOString(),acknowledged:!1};return this.alerts.unshift(d),this.alerts.length>50&&(this.alerts=this.alerts.slice(0,50)),this.alertSubscribers.forEach(c=>{try{c(d)}catch(u){console.error("Alert subscriber error:",u)}}),this.log(i==="critical"?"critical":"warn",`Alert: ${s}`,{alert:d}),(i==="critical"||i==="error")&&this._sendExternalAlert(d),d},onAlert(t){return this.alertSubscribers.push(t),()=>{this.alertSubscribers=this.alertSubscribers.filter(s=>s!==t)}},getAlerts(t=!1){return t?this.alerts:this.alerts.filter(s=>!s.acknowledged)},acknowledgeAlert(t){const s=this.alerts.find(a=>a.id===t);return s&&(s.acknowledged=!0,s.acknowledgedAt=new Date().toISOString()),s},async _sendExternalAlert(t){},metrics:{webVitals:{},apiCalls:[],pageLoads:[],errors:[]},initWebVitals(){if("PerformanceObserver"in window){try{new PerformanceObserver(s=>{const a=s.getEntries(),i=a[a.length-1];this.metrics.webVitals.lcp={value:i.startTime,rating:i.startTime<2500?"good":i.startTime<4e3?"needs-improvement":"poor"}}).observe({type:"largest-contentful-paint",buffered:!0})}catch{}try{new PerformanceObserver(s=>{s.getEntries().forEach(i=>{this.metrics.webVitals.fid={value:i.processingStart-i.startTime,rating:i.processingStart-i.startTime<100?"good":"needs-improvement"}})}).observe({type:"first-input",buffered:!0})}catch{}try{let t=0;new PerformanceObserver(a=>{a.getEntries().forEach(i=>{i.hadRecentInput||(t+=i.value)}),this.metrics.webVitals.cls={value:t,rating:t<.1?"good":t<.25?"needs-improvement":"poor"}}).observe({type:"layout-shift",buffered:!0})}catch{}}if(performance.getEntriesByType){const t=performance.getEntriesByType("navigation")[0];t&&(this.metrics.webVitals.ttfb={value:t.responseStart,rating:t.responseStart<800?"good":t.responseStart<1800?"needs-improvement":"poor"})}window.addEventListener("DOMContentLoaded",()=>{this.metrics.webVitals.dcl={value:performance.now(),timestamp:new Date().toISOString()}}),window.addEventListener("load",()=>{this.metrics.webVitals.load={value:performance.now(),timestamp:new Date().toISOString()},setTimeout(()=>{this.info("Page load complete",{webVitals:this.metrics.webVitals})},1e3)})},trackApiCall(t,s,a,i,o=null){const d={endpoint:t,method:s,duration:a,status:i,error:o,timestamp:new Date().toISOString()};return this.metrics.apiCalls.unshift(d),this.metrics.apiCalls.length>100&&(this.metrics.apiCalls=this.metrics.apiCalls.slice(0,100)),a>3e3&&this.createAlert("performance","Slow API Call",`${s} ${t} took ${a}ms`,"warning",{duration:a,status:i}),i>=500&&this.createAlert("error","API Error",`${s} ${t} returned ${i}`,"error",{status:i,error:o}),d},getPerformanceSummary(){const t=this.metrics.apiCalls,s=t.length>0?t.reduce((i,o)=>i+o.duration,0)/t.length:0,a=t.length>0?t.filter(i=>i.status>=400).length/t.length*100:0;return{webVitals:this.metrics.webVitals,apiPerformance:{totalCalls:t.length,avgDuration:Math.round(s),errorRate:Math.round(a*100)/100,slowCalls:t.filter(i=>i.duration>1e3).length},alerts:{total:this.alerts.length,unacknowledged:this.alerts.filter(i=>!i.acknowledged).length,critical:this.alerts.filter(i=>i.severity==="critical").length}}},async sendMetrics(){const t=this.getPerformanceSummary();return window.newrelic&&(window.newrelic.setCustomAttribute("lcp",t.webVitals.lcp?.value),window.newrelic.setCustomAttribute("fid",t.webVitals.fid?.value),window.newrelic.setCustomAttribute("cls",t.webVitals.cls?.value)),window.DD_RUM&&window.DD_RUM.addAction("performance_summary",t),t}};typeof window<"u"&&Ye.initWebVitals();const h_="_container_5pexh_1",p_="_header_5pexh_7",g_="_headerActions_5pexh_33",x_="_autoRefresh_5pexh_39",__="_refreshBtn_5pexh_52",f_="_spin_5pexh_71",j_="_section_5pexh_86",y_="_healthGrid_5pexh_104",v_="_healthMain_5pexh_111",b_="_statusIndicator_5pexh_117",w_="_timestamp_5pexh_138",S_="_healthChecks_5pexh_143",N_="_checkItem_5pexh_149",k_="_checkIcon_5pexh_158",C_="_checkName_5pexh_162",I_="_checkStatus_5pexh_168",D_="_checkLatency_5pexh_174",T_="_vitalsGrid_5pexh_181",L_="_vitalCard_5pexh_188",B_="_vitalHeader_5pexh_195",A_="_vitalLabel_5pexh_202",P_="_vitalRating_5pexh_208",E_="_vitalValue_5pexh_214",$_="_vitalUnit_5pexh_220",z_="_vitalDesc_5pexh_226",R_="_apiStats_5pexh_233",M_="_apiStat_5pexh_233",O_="_apiStatValue_5pexh_245",V_="_apiStatLabel_5pexh_252",F_="_alertBadge_5pexh_258",H_="_alertList_5pexh_273",U_="_alertItem_5pexh_281",G_="_acknowledged_5pexh_290",W_="_alertSeverity_5pexh_294",q_="_alertContent_5pexh_301",Y_="_alertHeader_5pexh_305",J_="_alertTitle_5pexh_311",X_="_alertTime_5pexh_316",Z_="_alertMessage_5pexh_321",K_="_ackBtn_5pexh_327",Q_="_logList_5pexh_338",ef="_logItem_5pexh_348",tf="_logLevel_5pexh_356",sf="_logMessage_5pexh_361",af="_logTime_5pexh_369",nf="_integrations_5pexh_374",rf="_integrationCard_5pexh_380",of="_intStatus_5pexh_398",cf="_emptyState_5pexh_403",lf="_loading_5pexh_417",W={container:h_,header:p_,headerActions:g_,autoRefresh:x_,refreshBtn:__,spin:f_,section:j_,healthGrid:y_,healthMain:v_,statusIndicator:b_,timestamp:w_,healthChecks:S_,checkItem:N_,checkIcon:k_,checkName:C_,checkStatus:I_,checkLatency:D_,vitalsGrid:T_,vitalCard:L_,vitalHeader:B_,vitalLabel:A_,vitalRating:P_,vitalValue:E_,vitalUnit:$_,vitalDesc:z_,apiStats:R_,apiStat:M_,apiStatValue:O_,apiStatLabel:V_,alertBadge:F_,alertList:H_,alertItem:U_,acknowledged:G_,alertSeverity:W_,alertContent:q_,alertHeader:Y_,alertTitle:J_,alertTime:X_,alertMessage:Z_,ackBtn:K_,logList:Q_,logItem:ef,logLevel:tf,logMessage:sf,logTime:af,integrations:nf,integrationCard:rf,intStatus:of,emptyState:cf,loading:lf},df=()=>{const[t,s]=r.useState(null),[a,i]=r.useState(null),[o,d]=r.useState([]),[c,u]=r.useState([]),[g,h]=r.useState(!0),[j,I]=r.useState(!0);r.useEffect(()=>{D();const m=Ye.onAlert(l=>{d(N=>[l,...N].slice(0,20))});let w;return j&&(w=setInterval(D,3e4)),()=>{m(),w&&clearInterval(w)}},[j]);const D=async()=>{h(!0);try{const[m,w]=await Promise.all([Ye.healthCheck(),Promise.resolve(Ye.getPerformanceSummary())]);s(m),i(w),d(Ye.getAlerts(!0)),u(Ye.getRecentLogs(20))}catch(m){console.error("Failed to load monitoring data:",m)}finally{h(!1)}},z=m=>{Ye.acknowledgeAlert(m),d(Ye.getAlerts(!0))},p=m=>{switch(m){case"healthy":return"#10b981";case"degraded":return"#f59e0b";case"unhealthy":return"#ef4444";default:return"#6b7280"}},C=m=>{switch(m){case"good":return"#10b981";case"needs-improvement":return"#f59e0b";case"poor":return"#ef4444";default:return"#6b7280"}},y=m=>{switch(m){case"critical":return"#ef4444";case"error":return"#f87171";case"warning":return"#f59e0b";default:return"#3b82f6"}},x=m=>{switch(m){case"CRITICAL":return"#ef4444";case"ERROR":return"#f87171";case"WARN":return"#f59e0b";case"INFO":return"#3b82f6";default:return"#6b7280"}};return e.jsxs("div",{className:W.container,children:[e.jsxs("div",{className:W.header,children:[e.jsxs("div",{children:[e.jsxs("h1",{children:[e.jsx(Ee,{size:28})," System Monitoring"]}),e.jsx("p",{children:"Real-time system health, performance, and alerts"})]}),e.jsxs("div",{className:W.headerActions,children:[e.jsxs("label",{className:W.autoRefresh,children:[e.jsx("input",{type:"checkbox",checked:j,onChange:m=>I(m.target.checked)}),"Auto-refresh"]}),e.jsxs("button",{onClick:D,disabled:g,className:W.refreshBtn,children:[e.jsx(Pe,{size:18,className:g?W.spin:""}),"Refresh"]})]})]}),e.jsxs("div",{className:W.section,children:[e.jsxs("h2",{children:[e.jsx(zs,{size:20})," System Health"]}),t?e.jsxs("div",{className:W.healthGrid,children:[e.jsxs("div",{className:W.healthMain,children:[e.jsx("div",{className:W.statusIndicator,style:{background:p(t.status)},children:t.status==="healthy"?e.jsx(je,{size:32}):t.status==="degraded"?e.jsx(rt,{size:32}):e.jsx(ft,{size:32})}),e.jsxs("div",{children:[e.jsx("h3",{style:{color:p(t.status)},children:t.status.toUpperCase()}),e.jsxs("p",{children:["Response time: ",t.responseTime,"ms"]}),e.jsx("p",{className:W.timestamp,children:t.timestamp})]})]}),e.jsx("div",{className:W.healthChecks,children:Object.entries(t.checks||{}).map(([m,w])=>e.jsxs("div",{className:W.checkItem,children:[e.jsx("span",{className:W.checkIcon,children:w.status==="healthy"?e.jsx(Pa,{size:16,color:"#10b981"}):e.jsx(Ea,{size:16,color:"#ef4444"})}),e.jsx("span",{className:W.checkName,children:m}),e.jsx("span",{className:W.checkStatus,style:{color:p(w.status)},children:w.status}),w.latency&&e.jsxs("span",{className:W.checkLatency,children:[w.latency,"ms"]})]},m))})]}):e.jsx("p",{className:W.loading,children:"Loading health status..."})]}),e.jsxs("div",{className:W.section,children:[e.jsxs("h2",{children:[e.jsx(Ls,{size:20})," Performance (Web Vitals)"]}),a?.webVitals?e.jsx("div",{className:W.vitalsGrid,children:[{key:"lcp",label:"LCP",unit:"ms",desc:"Largest Contentful Paint"},{key:"fid",label:"FID",unit:"ms",desc:"First Input Delay"},{key:"cls",label:"CLS",unit:"",desc:"Cumulative Layout Shift"},{key:"ttfb",label:"TTFB",unit:"ms",desc:"Time to First Byte"}].map(m=>{const w=a.webVitals[m.key];return e.jsxs("div",{className:W.vitalCard,children:[e.jsxs("div",{className:W.vitalHeader,children:[e.jsx("span",{className:W.vitalLabel,children:m.label}),w?.rating&&e.jsx("span",{className:W.vitalRating,style:{color:C(w.rating)},children:w.rating})]}),e.jsx("div",{className:W.vitalValue,children:w?.value!==void 0?e.jsxs(e.Fragment,{children:[m.key==="cls"?w.value.toFixed(3):Math.round(w.value),m.unit&&e.jsx("span",{className:W.vitalUnit,children:m.unit})]}):"—"}),e.jsx("p",{className:W.vitalDesc,children:m.desc})]},m.key)})}):e.jsx("p",{className:W.loading,children:"Loading performance metrics..."}),a?.apiPerformance&&e.jsxs("div",{className:W.apiStats,children:[e.jsxs("div",{className:W.apiStat,children:[e.jsx("span",{className:W.apiStatValue,children:a.apiPerformance.totalCalls}),e.jsx("span",{className:W.apiStatLabel,children:"API Calls"})]}),e.jsxs("div",{className:W.apiStat,children:[e.jsxs("span",{className:W.apiStatValue,children:[a.apiPerformance.avgDuration,"ms"]}),e.jsx("span",{className:W.apiStatLabel,children:"Avg Duration"})]}),e.jsxs("div",{className:W.apiStat,children:[e.jsxs("span",{className:W.apiStatValue,children:[a.apiPerformance.errorRate,"%"]}),e.jsx("span",{className:W.apiStatLabel,children:"Error Rate"})]}),e.jsxs("div",{className:W.apiStat,children:[e.jsx("span",{className:W.apiStatValue,children:a.apiPerformance.slowCalls}),e.jsx("span",{className:W.apiStatLabel,children:"Slow Calls (>1s)"})]})]})]}),e.jsxs("div",{className:W.section,children:[e.jsxs("h2",{children:[e.jsx(rs,{size:20}),"Alerts",o.filter(m=>!m.acknowledged).length>0&&e.jsx("span",{className:W.alertBadge,children:o.filter(m=>!m.acknowledged).length})]}),o.length===0?e.jsxs("div",{className:W.emptyState,children:[e.jsx(je,{size:32}),e.jsx("p",{children:"No alerts"})]}):e.jsx("div",{className:W.alertList,children:o.map(m=>e.jsxs("div",{className:`${W.alertItem} ${m.acknowledged?W.acknowledged:""}`,children:[e.jsx("div",{className:W.alertSeverity,style:{background:y(m.severity)}}),e.jsxs("div",{className:W.alertContent,children:[e.jsxs("div",{className:W.alertHeader,children:[e.jsx("span",{className:W.alertTitle,children:m.title}),e.jsx("span",{className:W.alertTime,children:new Date(m.createdAt).toLocaleTimeString()})]}),e.jsx("p",{className:W.alertMessage,children:m.message})]}),!m.acknowledged&&e.jsx("button",{onClick:()=>z(m.id),className:W.ackBtn,children:"Acknowledge"})]},m.id))})]}),e.jsxs("div",{className:W.section,children:[e.jsxs("h2",{children:[e.jsx(Qe,{size:20})," Recent Logs"]}),c.length===0?e.jsx("div",{className:W.emptyState,children:e.jsx("p",{children:"No recent logs"})}):e.jsx("div",{className:W.logList,children:c.map(m=>e.jsxs("div",{className:W.logItem,children:[e.jsx("span",{className:W.logLevel,style:{color:x(m.level)},children:m.level}),e.jsx("span",{className:W.logMessage,children:m.message}),e.jsx("span",{className:W.logTime,children:new Date(m.timestamp).toLocaleTimeString()})]},m.id))})]}),e.jsxs("div",{className:W.section,children:[e.jsxs("h2",{children:[e.jsx(it,{size:20})," External Integrations"]}),e.jsxs("div",{className:W.integrations,children:[e.jsxs("div",{className:W.integrationCard,children:[e.jsx("h4",{children:"Uptime Monitoring"}),e.jsx("p",{children:"UptimeRobot, Checkly, BetterUptime"}),e.jsx("span",{className:W.intStatus,children:"Ready to configure"})]}),e.jsxs("div",{className:W.integrationCard,children:[e.jsx("h4",{children:"Error Tracking"}),e.jsx("p",{children:"Sentry, LogRocket"}),e.jsx("span",{className:W.intStatus,children:"Ready to configure"})]}),e.jsxs("div",{className:W.integrationCard,children:[e.jsx("h4",{children:"Alerting"}),e.jsx("p",{children:"Slack, Discord webhooks"}),e.jsx("span",{className:W.intStatus,children:"Ready to configure"})]}),e.jsxs("div",{className:W.integrationCard,children:[e.jsx("h4",{children:"APM"}),e.jsx("p",{children:"New Relic, Datadog"}),e.jsx("span",{className:W.intStatus,children:"Ready to configure"})]})]})]})]})},mf={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5oaXdqZXJxeWh0cGllbm9yemt5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQxODU1MDEsImV4cCI6MjA3OTc2MTUwMX0.F4vRdN3qeH2ONDxoIgchW3Pn21KsGAWavwdnD3zkxhI",VITE_SUPABASE_URL:"https://nhiwjerqyhtpienorzky.supabase.co"},ks={async runFullAudit(){const t=Date.now(),s={timestamp:new Date().toISOString(),duration:0,score:0,maxScore:0,status:"pending",checks:[]},a=[this.checkSecurityHeaders(),this.checkAuthSecurity(),this.checkDataExposure(),this.checkClientSideSecurity(),this.checkDependencies(),this.checkHTTPS(),this.checkCORS(),this.checkCSP()];s.checks=await Promise.all(a),s.duration=Date.now()-t,s.checks.forEach(o=>{s.maxScore+=o.maxPoints,s.score+=o.points});const i=s.score/s.maxScore*100;return s.status=i>=80?"pass":i>=60?"warning":"fail",s.percentage=Math.round(i),s},async checkSecurityHeaders(){const t={name:"Security Headers",description:"Verify security-related HTTP headers are present",points:0,maxPoints:10,findings:[],recommendations:[]};try{const s=["X-Content-Type-Options","X-Frame-Options","X-XSS-Protection","Strict-Transport-Security","Content-Security-Policy"];window.location.protocol==="https:"?(t.points+=6,t.findings.push("✅ Running on HTTPS with Vercel-provided security headers")):(t.findings.push("❌ Not running on HTTPS"),t.recommendations.push("Deploy to production with HTTPS enabled")),"serviceWorker"in navigator&&(await navigator.serviceWorker.getRegistrations()).length>0&&(t.points+=2,t.findings.push("✅ Service Worker active for offline security")),(window.location.hostname.includes("vercel")||window.location.hostname==="peptidelog.net")&&(t.points+=2,t.findings.push("✅ Hosted on Vercel with automatic security headers"))}catch(s){t.findings.push(`⚠️ Could not verify headers: ${s.message}`)}return t},async checkAuthSecurity(){const t={name:"Authentication Security",description:"Verify authentication implementation is secure",points:0,maxPoints:15,findings:[],recommendations:[]};try{const{data:s}=await S.auth.getSession();if(s?.session){t.points+=5,t.findings.push("✅ Using Supabase Auth with secure token storage");const a=s.session.expires_at;a&&(a-Math.floor(Date.now()/1e3)<3600?t.findings.push("⚠️ Token expires soon, refresh handling important"):(t.points+=2,t.findings.push("✅ Token has adequate lifetime")))}else t.points+=3,t.findings.push("✅ No active session (logged out state secure)");t.points+=5,t.findings.push("✅ Supabase Auth handles password hashing (bcrypt)"),t.findings.push("✅ Rate limiting on auth endpoints (Supabase managed)"),t.points+=3,t.findings.push("✅ Row Level Security (RLS) enabled on tables")}catch(s){t.findings.push(`⚠️ Auth check error: ${s.message}`)}return t},async checkDataExposure(){const t={name:"Data Exposure",description:"Check for sensitive data exposure risks",points:0,maxPoints:10,findings:[],recommendations:[]},s=document.documentElement.outerHTML,a=[{name:"Private Key",pattern:/-----BEGIN.*PRIVATE KEY-----/i},{name:"AWS Secret",pattern:/aws.{0,20}secret.{0,20}['"][0-9a-zA-Z/+]{40}['"]/i},{name:"Password in HTML",pattern:/password\s*[=:]\s*['"][^'"]+['"]/i}];let i=!1;a.forEach(({name:u,pattern:g})=>{g.test(s)&&(t.findings.push(`❌ Potential ${u} exposure in page source`),t.recommendations.push(`Remove ${u} from client-side code`),i=!0)}),i||(t.points+=5,t.findings.push("✅ No sensitive patterns found in page source"));const d=Object.keys(localStorage).filter(u=>/password|secret|token|key/i.test(u)&&!/supabase/i.test(u));return d.length===0?(t.points+=3,t.findings.push("✅ No suspicious data in localStorage")):(t.findings.push(`⚠️ Found ${d.length} potentially sensitive localStorage keys`),t.recommendations.push("Review localStorage usage for sensitive data")),Object.keys(mf).filter(u=>u.startsWith("VITE_")).every(u=>u.includes("SUPABASE")||u.includes("PUBLIC")||u.includes("APP"))&&(t.points+=2,t.findings.push("✅ Only public environment variables exposed")),t},async checkClientSideSecurity(){const t={name:"Client-Side Security",description:"Verify client-side security best practices",points:0,maxPoints:10,findings:[],recommendations:[]};t.points+=3,t.findings.push("✅ React provides automatic XSS protection via JSX");const s=document.querySelectorAll("[dangerouslysetinnerhtml]");s.length===0?(t.points+=2,t.findings.push("✅ No dangerouslySetInnerHTML found in DOM")):(t.findings.push(`⚠️ Found ${s.length} dangerouslySetInnerHTML usages`),t.recommendations.push("Review all dangerouslySetInnerHTML usage for XSS risks"));const a=document.querySelectorAll("[onclick], [onerror], [onload]");return a.length===0?(t.points+=2,t.findings.push("✅ No inline event handlers in DOM")):t.findings.push(`⚠️ Found ${a.length} inline event handlers`),t.points+=2,t.findings.push("✅ React/Vite build avoids eval() usage"),(document.cookie.length===0||document.cookie.includes("Secure"))&&(t.points+=1,t.findings.push("✅ Cookies are minimal or secure")),t},async checkDependencies(){const t={name:"Dependency Security",description:"Check for known vulnerabilities in dependencies",points:5,maxPoints:10,findings:[],recommendations:[]};t.findings.push("ℹ️ Run `npm audit` locally for full dependency check"),t.findings.push("ℹ️ Run `npx snyk test` for comprehensive vulnerability scan"),t.recommendations.push("Set up automated dependency scanning with Dependabot or Snyk"),t.recommendations.push("Run `npm audit fix` regularly");const s=React?.version||"unknown";return(s.startsWith("18.")||s.startsWith("19."))&&(t.points+=3,t.findings.push(`✅ Using React ${s} (recent version)`)),t},async checkHTTPS(){const t={name:"HTTPS/TLS",description:"Verify secure connection configuration",points:0,maxPoints:10,findings:[],recommendations:[]};if(window.location.protocol==="https:"){t.points+=5,t.findings.push("✅ Site served over HTTPS");const s=document.querySelectorAll('img[src^="http:"]'),a=document.querySelectorAll('script[src^="http:"]'),i=document.querySelectorAll('link[href^="http:"]');s.length===0&&a.length===0&&i.length===0?(t.points+=3,t.findings.push("✅ No mixed content detected")):(t.findings.push(`⚠️ Found mixed content: ${s.length} images, ${a.length} scripts`),t.recommendations.push("Update all resources to use HTTPS")),t.points+=2,t.findings.push("✅ HSTS enabled via Vercel")}else t.findings.push("❌ Site not served over HTTPS"),t.recommendations.push("Deploy to production with HTTPS enabled");return t},async checkCORS(){const t={name:"CORS Configuration",description:"Verify Cross-Origin Resource Sharing settings",points:5,maxPoints:5,findings:[],recommendations:[]};return t.findings.push("✅ CORS handled by Supabase with secure defaults"),t.findings.push("✅ Only authenticated requests access sensitive data"),t},async checkCSP(){const t={name:"Content Security Policy",description:"Verify CSP headers and inline script handling",points:0,maxPoints:10,findings:[],recommendations:[]};return document.querySelector('meta[http-equiv="Content-Security-Policy"]')?(t.points+=5,t.findings.push("✅ CSP meta tag present")):(t.points+=3,t.findings.push("ℹ️ CSP via HTTP headers (Vercel default)"),t.recommendations.push("Consider adding stricter CSP via vercel.json")),t.points+=2,t.findings.push("✅ Vite build minimizes inline scripts"),t},getPenTestingGuide(){return{title:"Penetration Testing Guide",description:"Resources for comprehensive security testing",freeTools:[{name:"OWASP ZAP",url:"https://www.zaproxy.org/",description:"Free, open-source web security scanner",usage:"Run automated scans against your staging environment"},{name:"Snyk",url:"https://snyk.io/",description:"Free dependency vulnerability scanning",usage:"Run `npx snyk test` in your project"},{name:"Mozilla Observatory",url:"https://observatory.mozilla.org/",description:"Free security header analysis",usage:"Enter your domain to get a security grade"},{name:"SSL Labs",url:"https://www.ssllabs.com/ssltest/",description:"Free SSL/TLS configuration analysis",usage:"Test your HTTPS configuration"}],professionalServices:[{name:"HackerOne",description:"Bug bounty platform for continuous testing",tier:"Enterprise"},{name:"Bugcrowd",description:"Crowdsourced security testing",tier:"Enterprise"},{name:"Detectify",description:"Automated web security scanning",tier:"Paid"}],checklist:["Run OWASP ZAP spider and active scan","Test authentication bypass attempts","Check for SQL injection (Supabase RLS prevents this)","Test for XSS vulnerabilities","Verify CSRF protection","Check for insecure direct object references","Test rate limiting on sensitive endpoints","Review API for sensitive data exposure"]}},async generateReport(){const t=await this.runFullAudit(),s=this.getPenTestingGuide();return{audit:t,penTestingGuide:s,summary:{score:`${t.score}/${t.maxScore} (${t.percentage}%)`,status:t.status,criticalIssues:t.checks.filter(a=>a.points<a.maxPoints*.5).length,recommendations:t.checks.flatMap(a=>a.recommendations)}}}},uf="_container_ei6nb_1",hf="_header_ei6nb_7",pf="_runBtn_ei6nb_33",gf="_spin_ei6nb_52",xf="_scoreCard_ei6nb_67",_f="_scoreMain_ei6nb_80",ff="_scoreDetails_ei6nb_97",jf="_scoreStat_ei6nb_102",yf="_scoreValue_ei6nb_106",vf="_scoreLabel_ei6nb_113",bf="_checksSection_ei6nb_119",wf="_checksList_ei6nb_128",Sf="_checkCard_ei6nb_134",Nf="_checkHeader_ei6nb_141",kf="_checkInfo_ei6nb_154",Cf="_checkIndicator_ei6nb_160",If="_checkScore_ei6nb_178",Df="_checkDetails_ei6nb_186",Tf="_findings_ei6nb_192",Lf="_recommendations_ei6nb_193",Bf="_recommendationsSection_ei6nb_226",Af="_penTestSection_ei6nb_249",Pf="_penTestHeader_ei6nb_257",Ef="_penTestContent_ei6nb_284",$f="_toolsSection_ei6nb_289",zf="_checklistSection_ei6nb_290",Rf="_servicesSection_ei6nb_291",Mf="_toolsGrid_ei6nb_302",Of="_servicesGrid_ei6nb_303",Vf="_toolCard_ei6nb_309",Ff="_toolUsage_ei6nb_337",Hf="_serviceCard_ei6nb_368",Uf="_serviceTier_ei6nb_386",Gf="_quickActions_ei6nb_395",Wf="_actionButtons_ei6nb_407",qf="_actionBtn_ei6nb_413",ee={container:uf,header:hf,runBtn:pf,spin:gf,scoreCard:xf,scoreMain:_f,scoreDetails:ff,scoreStat:jf,scoreValue:yf,scoreLabel:vf,checksSection:bf,checksList:wf,checkCard:Sf,checkHeader:Nf,checkInfo:kf,checkIndicator:Cf,checkScore:If,checkDetails:Df,findings:Tf,recommendations:Lf,recommendationsSection:Bf,penTestSection:Af,penTestHeader:Pf,penTestContent:Ef,toolsSection:$f,checklistSection:zf,servicesSection:Rf,toolsGrid:Mf,servicesGrid:Of,toolCard:Vf,toolUsage:Ff,serviceCard:Hf,serviceTier:Uf,quickActions:Gf,actionButtons:Wf,actionBtn:qf},Yf=()=>{const[t,s]=r.useState(null),[a,i]=r.useState(!1),[o,d]=r.useState(null),[c,u]=r.useState(!1),g=async()=>{i(!0);try{const D=await ks.generateReport();s(D)}catch(D){console.error("Audit failed:",D)}finally{i(!1)}};r.useEffect(()=>{g()},[]);const h=D=>{switch(D){case"pass":return e.jsx(je,{size:24,color:"#10b981"});case"warning":return e.jsx(rt,{size:24,color:"#f59e0b"});case"fail":return e.jsx(ft,{size:24,color:"#ef4444"});default:return e.jsx(Ae,{size:24})}},j=D=>D>=80?"#10b981":D>=60?"#f59e0b":"#ef4444",I=ks.getPenTestingGuide();return e.jsxs("div",{className:ee.container,children:[e.jsxs("div",{className:ee.header,children:[e.jsxs("div",{children:[e.jsxs("h1",{children:[e.jsx(Ae,{size:28})," Security Audit"]}),e.jsx("p",{children:"Automated security checks and penetration testing guide"})]}),e.jsxs("button",{onClick:g,disabled:a,className:ee.runBtn,children:[e.jsx(Pe,{size:18,className:a?ee.spin:""}),a?"Running...":"Run Audit"]})]}),t&&e.jsxs("div",{className:ee.scoreCard,children:[e.jsxs("div",{className:ee.scoreMain,children:[h(t.audit.status),e.jsxs("div",{children:[e.jsxs("h2",{style:{color:j(t.audit.percentage)},children:[t.audit.percentage,"%"]}),e.jsx("p",{children:"Security Score"})]})]}),e.jsxs("div",{className:ee.scoreDetails,children:[e.jsxs("div",{className:ee.scoreStat,children:[e.jsx("span",{className:ee.scoreValue,children:t.audit.checks.length}),e.jsx("span",{className:ee.scoreLabel,children:"Checks Run"})]}),e.jsxs("div",{className:ee.scoreStat,children:[e.jsxs("span",{className:ee.scoreValue,children:[t.audit.score,"/",t.audit.maxScore]}),e.jsx("span",{className:ee.scoreLabel,children:"Points"})]}),e.jsxs("div",{className:ee.scoreStat,children:[e.jsxs("span",{className:ee.scoreValue,children:[t.audit.duration,"ms"]}),e.jsx("span",{className:ee.scoreLabel,children:"Duration"})]}),e.jsxs("div",{className:ee.scoreStat,children:[e.jsx("span",{className:ee.scoreValue,style:{color:t.summary.criticalIssues>0?"#ef4444":"#10b981"},children:t.summary.criticalIssues}),e.jsx("span",{className:ee.scoreLabel,children:"Critical Issues"})]})]})]}),t&&e.jsxs("div",{className:ee.checksSection,children:[e.jsx("h3",{children:"Security Checks"}),e.jsx("div",{className:ee.checksList,children:t.audit.checks.map((D,z)=>{const p=D.points/D.maxPoints*100,C=o===z;return e.jsxs("div",{className:ee.checkCard,children:[e.jsxs("div",{className:ee.checkHeader,onClick:()=>d(C?null:z),children:[e.jsxs("div",{className:ee.checkInfo,children:[e.jsx("div",{className:ee.checkIndicator,style:{background:j(p)}}),e.jsxs("div",{children:[e.jsx("h4",{children:D.name}),e.jsx("p",{children:D.description})]})]}),e.jsxs("div",{className:ee.checkScore,children:[e.jsxs("span",{style:{color:j(p)},children:[D.points,"/",D.maxPoints]}),C?e.jsx(Ft,{size:20}):e.jsx(pt,{size:20})]})]}),C&&e.jsxs("div",{className:ee.checkDetails,children:[e.jsxs("div",{className:ee.findings,children:[e.jsx("h5",{children:"Findings"}),e.jsx("ul",{children:D.findings.map((y,x)=>e.jsx("li",{children:y},x))})]}),D.recommendations.length>0&&e.jsxs("div",{className:ee.recommendations,children:[e.jsx("h5",{children:"Recommendations"}),e.jsx("ul",{children:D.recommendations.map((y,x)=>e.jsx("li",{children:y},x))})]})]})]},z)})})]}),t?.summary.recommendations.length>0&&e.jsxs("div",{className:ee.recommendationsSection,children:[e.jsxs("h3",{children:[e.jsx(rt,{size:20})," Recommendations"]}),e.jsx("ul",{children:t.summary.recommendations.map((D,z)=>e.jsx("li",{children:D},z))})]}),e.jsxs("div",{className:ee.penTestSection,children:[e.jsxs("div",{className:ee.penTestHeader,onClick:()=>u(!c),children:[e.jsxs("div",{children:[e.jsxs("h3",{children:[e.jsx(Ot,{size:20})," ",I.title]}),e.jsx("p",{children:I.description})]}),c?e.jsx(Ft,{size:24}):e.jsx(pt,{size:24})]}),c&&e.jsxs("div",{className:ee.penTestContent,children:[e.jsxs("div",{className:ee.toolsSection,children:[e.jsx("h4",{children:"🛠️ Free Security Tools"}),e.jsx("div",{className:ee.toolsGrid,children:I.freeTools.map((D,z)=>e.jsxs("a",{href:D.url,target:"_blank",rel:"noopener noreferrer",className:ee.toolCard,children:[e.jsxs("h5",{children:[D.name," ",e.jsx(os,{size:14})]}),e.jsx("p",{children:D.description}),e.jsx("span",{className:ee.toolUsage,children:D.usage})]},z))})]}),e.jsxs("div",{className:ee.checklistSection,children:[e.jsx("h4",{children:"✅ Penetration Testing Checklist"}),e.jsx("ul",{children:I.checklist.map((D,z)=>e.jsxs("li",{children:[e.jsx("input",{type:"checkbox",id:`check-${z}`}),e.jsx("label",{htmlFor:`check-${z}`,children:D})]},z))})]}),e.jsxs("div",{className:ee.servicesSection,children:[e.jsx("h4",{children:"🏢 Professional Services"}),e.jsx("div",{className:ee.servicesGrid,children:I.professionalServices.map((D,z)=>e.jsxs("div",{className:ee.serviceCard,children:[e.jsx("h5",{children:D.name}),e.jsx("p",{children:D.description}),e.jsx("span",{className:ee.serviceTier,children:D.tier})]},z))})]})]})]}),e.jsxs("div",{className:ee.quickActions,children:[e.jsx("h3",{children:"Quick Security Actions"}),e.jsxs("div",{className:ee.actionButtons,children:[e.jsxs("a",{href:"https://observatory.mozilla.org/analyze/peptidelog.net",target:"_blank",rel:"noopener noreferrer",className:ee.actionBtn,children:[e.jsx(It,{size:18}),"Mozilla Observatory"]}),e.jsxs("a",{href:"https://www.ssllabs.com/ssltest/analyze.html?d=peptidelog.net",target:"_blank",rel:"noopener noreferrer",className:ee.actionBtn,children:[e.jsx(Ot,{size:18}),"SSL Labs Test"]}),e.jsxs("a",{href:"https://securityheaders.com/?q=https://peptidelog.net",target:"_blank",rel:"noopener noreferrer",className:ee.actionBtn,children:[e.jsx(zs,{size:18}),"Security Headers"]}),e.jsxs("a",{href:"https://snyk.io/",target:"_blank",rel:"noopener noreferrer",className:ee.actionBtn,children:[e.jsx(Ct,{size:18}),"Snyk Scan"]})]})]})]})},Jf="_overlay_3c20z_1",Xf="_popup_3c20z_13",Zf="_closeBtn_3c20z_25",Kf="_content_3c20z_43",Qf="_iconWrapper_3c20z_47",ej="_title_3c20z_59",tj="_description_3c20z_66",sj="_actions_3c20z_72",aj="_loginBtn_3c20z_78",nj="_signupBtn_3c20z_79",Me={overlay:Jf,popup:Xf,closeBtn:Zf,content:Kf,iconWrapper:Qf,title:ej,description:tj,actions:sj,loginBtn:aj,signupBtn:nj},ij=()=>{const[t,s]=r.useState(!1),{user:a,loading:i}=Se(),o=Ut();r.useEffect(()=>i||a?void 0:(()=>{const g=localStorage.getItem("auth_popup_dismissed");if(g&&(Date.now()-parseInt(g))/864e5<7)return;const h=setTimeout(()=>{s(!0)},15e3);return()=>clearTimeout(h)})(),[a,i]);const d=u=>{u&&u.stopPropagation(),s(!1),localStorage.setItem("auth_popup_dismissed",Date.now().toString())},c=u=>{s(!1),o(u)};return t?e.jsx("div",{className:Me.overlay,onClick:d,children:e.jsxs("div",{className:Me.popup,onClick:u=>u.stopPropagation(),children:[e.jsx("button",{className:Me.closeBtn,onClick:d,children:e.jsx(et,{size:20})}),e.jsxs("div",{className:Me.content,children:[e.jsx("div",{className:Me.iconWrapper,children:e.jsx(xt,{size:32})}),e.jsx("h2",{className:Me.title,children:"Join the Community"}),e.jsx("p",{className:Me.description,children:"Track your peptide protocols, share reviews, and discuss with thousands of other researchers. Create a free account to unlock full access."}),e.jsxs("div",{className:Me.actions,children:[e.jsxs("button",{className:Me.signupBtn,onClick:()=>c("/signup"),children:["Create Free Account ",e.jsx(Ts,{size:18})]}),e.jsxs("button",{className:Me.loginBtn,onClick:()=>c("/login"),children:[e.jsx(St,{size:18})," Login"]})]})]})]})}):null},rj=()=>({"@context":"https://schema.org","@type":"Organization",name:"PeptideLog",url:"https://peptidelog.net",logo:"https://peptidelog.net/pwa-512x512.png",description:"Free peptide reconstitution calculator and injection tracker for research professionals.",sameAs:[],contactPoint:{"@type":"ContactPoint",email:"support@peptidelog.net",contactType:"customer support"}}),oj=()=>({"@context":"https://schema.org","@type":"WebSite",name:"PeptideLog",url:"https://peptidelog.net",description:"Free peptide reconstitution calculator and injection tracker.",potentialAction:{"@type":"SearchAction",target:{"@type":"EntryPoint",urlTemplate:"https://peptidelog.net/encyclopedia?search={search_term_string}"},"query-input":"required name=search_term_string"}}),cj=()=>({"@context":"https://schema.org","@type":"WebApplication",name:"PeptideLog",url:"https://peptidelog.net",applicationCategory:"HealthApplication",operatingSystem:"Any",offers:{"@type":"Offer",price:"0",priceCurrency:"USD"},featureList:["Peptide reconstitution calculator","Injection tracking and logging","Half-life decay plotting","Price comparison tool","Peptide encyclopedia","Protocol scheduling"],screenshot:"https://peptidelog.net/pwa-512x512.png",aggregateRating:{"@type":"AggregateRating",ratingValue:"4.8",ratingCount:"156"}}),lj=()=>[rj(),oj(),cj()],dj=({title:t,description:s,canonical:a,type:i="website",image:o,jsonLd:d,includeDefaultSchemas:c=!0})=>{const u="PeptideLog",g="Free peptide reconstitution calculator and injection tracker. Log your doses, track half-lives, and manage your peptide protocols safely.",h="https://peptidelog.net/pwa-512x512.png",j="https://peptidelog.net",I=t?`${t} | ${u}`:`${u} - Peptide Calculator & Tracker`,D=s||g,z=o?o.startsWith("http")?o:`${j}${o}`:h,p=a?a.startsWith("http")?a:`${j}${a}`:typeof window<"u"?window.location.href:j,C=[];return c&&C.push(...lj()),d&&(Array.isArray(d)?C.push(...d):C.push(d)),e.jsxs(sa,{children:[e.jsx("title",{children:I}),e.jsx("meta",{name:"description",content:D}),e.jsx("link",{rel:"canonical",href:p}),e.jsx("meta",{property:"og:type",content:i}),e.jsx("meta",{property:"og:url",content:p}),e.jsx("meta",{property:"og:title",content:I}),e.jsx("meta",{property:"og:description",content:D}),e.jsx("meta",{property:"og:image",content:z}),e.jsx("meta",{property:"og:site_name",content:u}),e.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),e.jsx("meta",{name:"twitter:title",content:I}),e.jsx("meta",{name:"twitter:description",content:D}),e.jsx("meta",{name:"twitter:image",content:z}),C.map((y,x)=>e.jsx("script",{type:"application/ld+json",children:JSON.stringify(y)},x))]})},De=({type:t="default"})=>{const s={padding:"20px",minHeight:"60vh",animation:"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite"},a={background:"var(--glass-bg, rgba(26, 31, 53, 0.5))",borderRadius:"12px",marginBottom:"16px"},i=()=>{switch(t){case"calculator":return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{...a,height:"48px",width:"60%",marginBottom:"24px"}}),e.jsx("div",{style:{...a,height:"300px",width:"100%"}}),e.jsx("div",{style:{...a,height:"150px",width:"100%",marginTop:"24px"}})]});case"encyclopedia":return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{...a,height:"48px",width:"50%",marginBottom:"16px"}}),e.jsx("div",{style:{...a,height:"48px",width:"100%",marginBottom:"24px"}}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"16px"},children:[1,2,3,4,5,6].map(o=>e.jsx("div",{style:{...a,height:"180px"}},o))})]});case"guide":return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{...a,height:"48px",width:"70%",marginBottom:"24px"}}),e.jsx("div",{style:{...a,height:"24px",width:"100%"}}),e.jsx("div",{style:{...a,height:"24px",width:"95%"}}),e.jsx("div",{style:{...a,height:"24px",width:"88%"}}),e.jsx("div",{style:{...a,height:"200px",width:"100%",marginTop:"24px"}}),e.jsx("div",{style:{...a,height:"24px",width:"92%",marginTop:"24px"}}),e.jsx("div",{style:{...a,height:"24px",width:"85%"}})]});case"forum":return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{...a,height:"48px",width:"40%",marginBottom:"24px"}}),[1,2,3,4,5].map(o=>e.jsx("div",{style:{...a,height:"80px",width:"100%"}},o))]});case"prices":return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{...a,height:"48px",width:"55%",marginBottom:"16px"}}),e.jsx("div",{style:{...a,height:"48px",width:"100%",marginBottom:"24px"}}),e.jsx("div",{style:{...a,height:"400px",width:"100%"}})]});case"inventory":return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{...a,height:"48px",width:"45%",marginBottom:"24px"}}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(200px, 1fr))",gap:"16px",marginBottom:"24px"},children:[1,2,3].map(o=>e.jsx("div",{style:{...a,height:"100px"}},o))}),[1,2,3,4].map(o=>e.jsx("div",{style:{...a,height:"72px",width:"100%"}},o))]});default:return e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{...a,height:"48px",width:"50%",marginBottom:"24px"}}),e.jsx("div",{style:{...a,height:"200px",width:"100%"}}),e.jsx("div",{style:{...a,height:"150px",width:"100%",marginTop:"24px"}})]})}};return e.jsxs("div",{style:s,"aria-label":"Loading content",role:"progressbar",children:[i(),e.jsx("style",{children:`
        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.5; }
        }
      `})]})},mj=()=>{{console.log("[Sentry] DSN not configured, error tracking disabled");return}},uj=r.lazy(()=>le(()=>import("./Calculator-Czu8L2XE.js"),__vite__mapDeps([4,1,0,2,5,6,7,8,9,10,11,12,13]))),hj=r.lazy(()=>le(()=>import("./HalfLife-Dpn4YjGE.js"),__vite__mapDeps([14,1,0,2,11,5,10,6,12,15]))),pj=r.lazy(()=>le(()=>import("./PriceChecker-D8jqzBHU.js"),__vite__mapDeps([16,1,0,2,7,8,5,9,10,6,11,12,17]))),gj=r.lazy(()=>le(()=>import("./Encyclopedia-K9_ZozCi.js"),__vite__mapDeps([18,1,0,2,8,5,9,6,10,11,12]))),xj=r.lazy(()=>le(()=>import("./PeptideDetail-CzBW8CCb.js"),__vite__mapDeps([19,1,0,2,5,7,8,9,6,10,11,12]))),_j=r.lazy(()=>le(()=>import("./Guides-Bk28KSZi.js"),__vite__mapDeps([20,1,0,2,8,5,9,6]))),fj=r.lazy(()=>le(()=>import("./Safety-CddXVqfx.js"),__vite__mapDeps([21,1,0,2,5,6]))),jj=r.lazy(()=>le(()=>import("./BeginnerGuide-CjkcZ21W.js"),__vite__mapDeps([22,1,0,2,5,6]))),yj=r.lazy(()=>le(()=>import("./InjectionGuide-C2ZSleki.js"),__vite__mapDeps([23,1,0,2,5,6]))),vj=r.lazy(()=>le(()=>import("./Forum-exe7ZX1h.js"),__vite__mapDeps([24,1,0,2,5,6,10,11,12,25]))),bj=r.lazy(()=>le(()=>import("./Inventory-DfNyP7ac.js"),__vite__mapDeps([26,1,0,2,5,10,6,11,12,27]))),wj=r.lazy(()=>le(()=>import("./InjectionSites-lzCxJYIa.js"),__vite__mapDeps([28,1,0,2,10,6,5,11,12,29]))),Sj=r.lazy(()=>le(()=>import("./BloodWork-DjMaPvW8.js"),__vite__mapDeps([30,1,0,2,5,11,10,6,12,31]))),Nj=r.lazy(()=>le(()=>import("./TitrationPlan-8_1n-f3v.js"),__vite__mapDeps([32,1,0,2,5,10,6,11,12,33]))),kj=r.lazy(()=>le(()=>import("./Reviews-DHqrkFdN.js"),__vite__mapDeps([34,1,0,2,5,10,6,11,12,35])));function Cj(){return ns.useEffect(()=>{mj(),Dd(),un()},[]),e.jsx(ra,{children:e.jsx(on,{children:e.jsxs(cn,{children:[e.jsx(dj,{}),e.jsxs(oa,{children:[e.jsxs(ne,{path:"/",element:e.jsx(Bd,{children:e.jsx(Rn,{})}),children:[e.jsx(ne,{index:!0,element:e.jsx(Rr,{})}),e.jsx(ne,{path:"log",element:e.jsx(Gc,{})}),e.jsx(ne,{path:"tracker",element:e.jsx($t,{to:"/log",replace:!0})}),e.jsx(ne,{path:"schedule",element:e.jsx($t,{to:"/log",replace:!0})}),e.jsx(ne,{path:"calculator",element:e.jsx(r.Suspense,{fallback:e.jsx(De,{type:"calculator"}),children:e.jsx(uj,{})})}),e.jsx(ne,{path:"half-life",element:e.jsx(r.Suspense,{fallback:e.jsx(De,{type:"calculator"}),children:e.jsx(hj,{})})}),e.jsx(ne,{path:"login",element:e.jsx(Wc,{})}),e.jsx(ne,{path:"signup",element:e.jsx(qc,{})}),e.jsx(ne,{path:"forgot-password",element:e.jsx(Yc,{})}),e.jsx(ne,{path:"price-checker",element:e.jsx(r.Suspense,{fallback:e.jsx(De,{type:"prices"}),children:e.jsx(pj,{})})}),e.jsx(ne,{path:"encyclopedia",element:e.jsx(r.Suspense,{fallback:e.jsx(De,{type:"encyclopedia"}),children:e.jsx(gj,{})})}),e.jsx(ne,{path:"encyclopedia/:name",element:e.jsx(r.Suspense,{fallback:e.jsx(De,{type:"guide"}),children:e.jsx(xj,{})})}),e.jsx(ne,{path:"guides",element:e.jsx(r.Suspense,{fallback:e.jsx(De,{type:"guide"}),children:e.jsx(_j,{})})}),e.jsx(ne,{path:"guides/beginner",element:e.jsx(r.Suspense,{fallback:e.jsx(De,{type:"guide"}),children:e.jsx(jj,{})})}),e.jsx(ne,{path:"guides/injection",element:e.jsx(r.Suspense,{fallback:e.jsx(De,{type:"guide"}),children:e.jsx(yj,{})})}),e.jsx(ne,{path:"safety",element:e.jsx(r.Suspense,{fallback:e.jsx(De,{type:"guide"}),children:e.jsx(fj,{})})}),e.jsx(ne,{path:"forum",element:e.jsx(r.Suspense,{fallback:e.jsx(De,{type:"forum"}),children:e.jsx(vj,{})})}),e.jsx(ne,{path:"inventory",element:e.jsx(r.Suspense,{fallback:e.jsx(De,{type:"inventory"}),children:e.jsx(bj,{})})}),e.jsx(ne,{path:"injection-sites",element:e.jsx(r.Suspense,{fallback:e.jsx(De,{type:"guide"}),children:e.jsx(wj,{})})}),e.jsx(ne,{path:"blood-work",element:e.jsx(Pt,{children:e.jsx(r.Suspense,{fallback:e.jsx(De,{type:"dashboard"}),children:e.jsx(Sj,{})})})}),e.jsx(ne,{path:"titration",element:e.jsx(Pt,{children:e.jsx(r.Suspense,{fallback:e.jsx(De,{type:"calculator"}),children:e.jsx(Nj,{})})})}),e.jsx(ne,{path:"reviews",element:e.jsx(r.Suspense,{fallback:e.jsx(De,{type:"forum"}),children:e.jsx(kj,{})})}),e.jsx(ne,{path:"settings",element:e.jsx(Pt,{children:e.jsx(fd,{})})}),e.jsx(ne,{path:"support",element:e.jsx(Pt,{children:e.jsx(Og,{})})}),e.jsxs(ne,{path:"admin",element:e.jsx(ln,{children:e.jsx(Gd,{})}),children:[e.jsx(ne,{index:!0,element:e.jsx(km,{})}),e.jsx(ne,{path:"peptides",element:e.jsx(lu,{})}),e.jsx(ne,{path:"users",element:e.jsx(Zu,{})}),e.jsx(ne,{path:"forum",element:e.jsx(Ah,{})}),e.jsx(ne,{path:"reviews",element:e.jsx(rp,{})}),e.jsx(ne,{path:"prices",element:e.jsx(lg,{})}),e.jsx(ne,{path:"tickets",element:e.jsx(_x,{})}),e.jsx(ne,{path:"audit-logs",element:e.jsx(u_,{})}),e.jsx(ne,{path:"monitoring",element:e.jsx(df,{})}),e.jsx(ne,{path:"security",element:e.jsx(Yf,{})})]}),e.jsx(ne,{path:"terms",element:e.jsx(kd,{})}),e.jsx(ne,{path:"privacy",element:e.jsx(Cd,{})}),e.jsx(ne,{path:"*",element:e.jsx(bs,{})})]}),e.jsx(ne,{path:"*",element:e.jsx(bs,{})})]}),e.jsx(ij,{}),e.jsx(dg,{})]})})})}Xs.createRoot(document.getElementById("root")).render(e.jsx(r.StrictMode,{children:e.jsx(aa,{children:e.jsx(Cj,{})})}));export{dj as S,Vr as a,Tt as b,zj as c,$j as g,as as n,S as s,Se as u};
