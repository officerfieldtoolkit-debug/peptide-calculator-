import{j as e,r}from"./vendor-CkzOwYxW.js";import{u as X,a as Z,s as T}from"./index-CkrV_KEF.js";import{as as F,at as ee,au as te,v as se,av as ne,e as ae,aw as ie,k as oe,b as re,ax as le,ay as ce}from"./icons-CxzY2V_d.js";import"./charts-CXyhUZZ_.js";const de="_container_3bh71_1",ue="_pageHeader_3bh71_11",me="_headerLeft_3bh71_19",he="_headerIcon_3bh71_25",pe="_headerActions_3bh71_45",xe="_iconBtn_3bh71_50",ge="_iconBtnActive_3bh71_70",_e="_badge_3bh71_76",je="_savedPanel_3bh71_91",be="_noSaved_3bh71_103",ve="_savedList_3bh71_110",fe="_savedItem_3bh71_116",ye="_savedItemBtn_3bh71_121",Ce="_savedPeptide_3bh71_140",Ne="_savedDetails_3bh71_145",Be="_deleteBtn_3bh71_150",ke="_inputGroup_3bh71_165",we="_label_3bh71_170",Ae="_input_3bh71_165",Se="_inputWithUnit_3bh71_198",Ue="_unitLabel_3bh71_208",We="_autocompleteWrapper_3bh71_217",Me="_chevron_3bh71_221",Ie="_chevronUp_3bh71_231",Le="_autocomplete_3bh71_217",De="_autocompleteItem_3bh71_249",Pe="_peptideCategory_3bh71_271",Te="_peptideHint_3bh71_279",$e="_quickButtons_3bh71_286",qe="_quickBtn_3bh71_293",Ge="_quickBtnActive_3bh71_310",Re="_recommendBtn_3bh71_316",Ve="_doseInputRow_3bh71_332",ze="_unitToggle_3bh71_341",Fe="_unitBtn_3bh71_348",Ee="_unitBtnActive_3bh71_368",Oe="_syringeTypes_3bh71_374",He="_syringeBtn_3bh71_380",Je="_syringeBtnActive_3bh71_400",Ye="_resultContainer_3bh71_407",Ke="_warning_3bh71_417",Qe="_resultCard_3bh71_428",Xe="_resultLabel_3bh71_433",Ze="_resultValue_3bh71_443",et="_resultWarning_3bh71_455",tt="_resultUnit_3bh71_459",st="_details_3bh71_466",nt="_detailRow_3bh71_475",at="_dosesValue_3bh71_493",it="_saveBtn_3bh71_499",ot="_infoBox_3bh71_523",s={container:de,pageHeader:ue,headerLeft:me,headerIcon:he,headerActions:pe,iconBtn:xe,iconBtnActive:ge,badge:_e,savedPanel:je,noSaved:be,savedList:ve,savedItem:fe,savedItemBtn:ye,savedPeptide:Ce,savedDetails:Ne,deleteBtn:Be,inputGroup:ke,label:we,input:Ae,inputWithUnit:Se,unitLabel:Ue,autocompleteWrapper:We,chevron:Me,chevronUp:Ie,autocomplete:Le,autocompleteItem:De,peptideCategory:Pe,peptideHint:Te,quickButtons:$e,quickBtn:qe,quickBtnActive:Ge,recommendBtn:Re,doseInputRow:Ve,unitToggle:ze,unitBtn:Fe,unitBtnActive:Ee,syringeTypes:Oe,syringeBtn:He,syringeBtnActive:Je,resultContainer:Ye,warning:Ke,resultCard:Qe,resultLabel:Xe,resultValue:Ze,resultWarning:et,resultUnit:tt,details:st,detailRow:nt,dosesValue:at,saveBtn:it,infoBox:ot},rt=({units:c,maxUnits:p=100})=>{const d=Math.min(Math.max(c,0),p),_=200,S=_/p,u=d*S;return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",padding:"30px 20px"},children:[e.jsxs("svg",{width:"350",height:"140",viewBox:"0 0 350 140",style:{filter:"drop-shadow(0 4px 12px rgba(0, 0, 0, 0.3))"},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"barrelGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"rgba(255, 255, 255, 0.15)"}),e.jsx("stop",{offset:"50%",stopColor:"rgba(255, 255, 255, 0.05)"}),e.jsx("stop",{offset:"100%",stopColor:"rgba(255, 255, 255, 0.12)"})]}),e.jsxs("linearGradient",{id:"liquidGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"rgba(59, 130, 246, 0.8)"}),e.jsx("stop",{offset:"50%",stopColor:"rgba(59, 130, 246, 0.6)"}),e.jsx("stop",{offset:"100%",stopColor:"rgba(6, 182, 212, 0.7)"})]}),e.jsxs("linearGradient",{id:"plungerGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"#4b5563"}),e.jsx("stop",{offset:"50%",stopColor:"#374151"}),e.jsx("stop",{offset:"100%",stopColor:"#4b5563"})]}),e.jsxs("linearGradient",{id:"needleGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"#9ca3af"}),e.jsx("stop",{offset:"50%",stopColor:"#d1d5db"}),e.jsx("stop",{offset:"100%",stopColor:"#6b7280"})]}),e.jsxs("linearGradient",{id:"reflection",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[e.jsx("stop",{offset:"0%",stopColor:"rgba(255, 255, 255, 0.4)"}),e.jsx("stop",{offset:"100%",stopColor:"rgba(255, 255, 255, 0)"})]})]}),e.jsxs("g",{children:[e.jsx("rect",{x:"35",y:"58",width:"20",height:"24",rx:"2",fill:"#e5e7eb",stroke:"#9ca3af",strokeWidth:"1"}),e.jsx("polygon",{points:"10,68 10,72 35,70",fill:"url(#needleGradient)",stroke:"#6b7280",strokeWidth:"0.5"}),e.jsx("polygon",{points:"8,70 10,68 10,72",fill:"#4b5563"}),e.jsx("line",{x1:"12",y1:"69",x2:"33",y2:"69.5",stroke:"rgba(255, 255, 255, 0.6)",strokeWidth:"0.5"})]}),e.jsx("rect",{x:"55",y:"45",width:"220",height:"50",rx:"6",fill:"url(#barrelGradient)",stroke:"rgba(255, 255, 255, 0.3)",strokeWidth:"2"}),e.jsx("rect",{x:"60",y:"52",width:"210",height:"36",rx:"3",fill:"rgba(0, 0, 0, 0.2)",stroke:"rgba(255, 255, 255, 0.1)",strokeWidth:"1"}),Array.from({length:11}).map((M,m)=>{const y=60+m*(_/10),h=m%2===0;return e.jsxs("g",{children:[e.jsx("line",{x1:y,y1:h?45:48,x2:y,y2:"52",stroke:"rgba(255, 255, 255, 0.4)",strokeWidth:h?"1.5":"1"}),h&&e.jsx("text",{x:y,y:"40",fontSize:"11",fontWeight:"600",fill:"var(--text-secondary)",textAnchor:"middle",fontFamily:"Inter, sans-serif",children:m*10})]},m)}),u>0&&e.jsxs("g",{children:[e.jsx("rect",{x:"60",y:"53",width:u,height:"34",rx:"2",fill:"url(#liquidGradient)"}),e.jsx("rect",{x:"60",y:"53",width:u,height:"12",rx:"2",fill:"url(#reflection)",opacity:"0.6"}),e.jsx("ellipse",{cx:60+u,cy:"70",rx:"3",ry:"15",fill:"rgba(59, 130, 246, 0.3)"})]}),e.jsx("rect",{x:"58",y:"48",width:"214",height:"18",rx:"4",fill:"url(#reflection)",opacity:"0.3"}),e.jsxs("g",{transform:`translate(${u}, 0)`,children:[e.jsx("rect",{x:"60",y:"54",width:"6",height:"32",rx:"1",fill:"url(#plungerGradient)"}),e.jsx("rect",{x:"66",y:"67",width:"50",height:"6",rx:"3",fill:"#6b7280",stroke:"#4b5563",strokeWidth:"1"}),e.jsxs("g",{children:[e.jsx("circle",{cx:"116",cy:"70",r:"16",fill:"#374151",stroke:"#4b5563",strokeWidth:"2"}),e.jsx("circle",{cx:"116",cy:"70",r:"12",fill:"#1f2937"}),e.jsx("circle",{cx:"116",cy:"70",r:"8",fill:"none",stroke:"#4b5563",strokeWidth:"1"}),e.jsx("circle",{cx:"116",cy:"70",r:"5",fill:"none",stroke:"#4b5563",strokeWidth:"0.5"})]})]}),e.jsxs("g",{children:[e.jsx("rect",{x:"268",y:"40",width:"4",height:"60",rx:"2",fill:"rgba(255, 255, 255, 0.2)"}),e.jsx("rect",{x:"273",y:"40",width:"4",height:"60",rx:"2",fill:"rgba(255, 255, 255, 0.2)"})]})]}),e.jsxs("div",{style:{marginTop:"20px",fontSize:"1.25rem",fontWeight:"700",background:"var(--gradient-primary)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",letterSpacing:"0.02em"},children:[d.toFixed(1)," Units"]}),e.jsx("div",{style:{fontSize:"0.875rem",color:"var(--text-muted)",marginTop:"4px"},children:"Draw to this mark on your syringe"})]})},q="peptide_saved_calculations",$=[{id:"u100",name:"U-100 (1ml)",unitsPerMl:100,maxUnits:100},{id:"u50",name:"U-50 (0.5ml)",unitsPerMl:100,maxUnits:50},{id:"u40",name:"U-40",unitsPerMl:40,maxUnits:40}],lt=[.5,1,1.5,2,2.5,3],ct=()=>{try{const c=localStorage.getItem(q);return c?JSON.parse(c):[]}catch{return[]}},dt=()=>{const{user:c}=X(),{peptides:p}=Z(),[d,_]=r.useState(""),[S,u]=r.useState("5"),[M,m]=r.useState("2"),[y,h]=r.useState("250"),[g,j]=r.useState("mcg"),[B,I]=r.useState("u100"),b=parseFloat(S)||0,k=parseFloat(M)||0,x=parseFloat(y)||0,[G,L]=r.useState(!1),[C,N]=r.useState([]),[D,R]=r.useState(!1),P=r.useRef(null);r.useEffect(()=>{(async()=>{if(c){const{data:n,error:a}=await T.from("user_calculations").select("*").order("created_at",{ascending:!1});if(n&&!a){const i=n.map(o=>({id:o.id,peptide:o.peptide_name,vialAmount:o.vial_amount,waterAmount:o.water_amount,doseAmount:o.dose_amount,doseUnit:o.dose_unit,syringeType:o.syringe_type}));N(i)}}else N(ct())})()},[c]);const V=r.useMemo(()=>{const t=p.map(a=>a.name);if(!d)return t.slice(0,8);const n=d.toLowerCase();return t.filter(a=>a.toLowerCase().includes(n)).slice(0,8)},[d,p]),w=r.useMemo(()=>p.find(t=>t.name===d)||null,[d,p]),E=r.useMemo(()=>{if(!w)return[100,250,500,1e3];const t=w.commonDosage||"",n=t.match(/(\d+(?:\.\d+)?)/g);if(n&&n.length>0){const a=n.map(i=>parseFloat(i));return a[0]<10&&t.toLowerCase().includes("mg")?a.map(i=>i*1e3):a}return[100,250,500,1e3]},[w]);r.useEffect(()=>{const t=n=>{P.current&&!P.current.contains(n.target)&&L(!1)};return document.addEventListener("mousedown",t),()=>document.removeEventListener("mousedown",t)},[]);const l=r.useMemo(()=>{if(b<=0||k<=0||x<=0)return null;const t=$.find(z=>z.id===B),n=t?.unitsPerMl||100,a=t?.maxUnits||100,i=g==="mg"?x*1e3:x,o=b*1e3,U=o/k,v=i/U,f=v*n,A=Math.floor(o/i),W=f>a;return{concentration:U,drawMl:v.toFixed(4),units:f.toFixed(1),dosesPerVial:A,isOverMax:W,maxUnits:a}},[b,k,x,g,B]),O=t=>{_(t),L(!1);const n=p.find(a=>a.name===t);if(n){const a=n.commonDosage||"",i=a.match(/(\d+(?:\.\d+)?)/g);if(i&&i.length>0){const o=parseFloat(i[0]);a.toLowerCase().includes("mg")&&o<10?(h(String(o)),j("mg")):(h(String(o)),j("mcg"))}}},H=async()=>{const t={peptide:d||"Custom",vialAmount:b,waterAmount:k,doseAmount:x,doseUnit:g,syringeType:B};if(c){const{data:n,error:a}=await T.from("user_calculations").insert([{user_id:c.id,peptide_name:t.peptide,vial_amount:t.vialAmount,water_amount:t.waterAmount,dose_amount:t.doseAmount,dose_unit:t.doseUnit,syringe_type:t.syringeType}]).select().single();n&&!a&&N(i=>[{id:n.id,...t},...i])}else{const a=[{id:Date.now(),...t},...C.slice(0,9)];N(a),localStorage.setItem(q,JSON.stringify(a))}},J=t=>{_(t.peptide),u(String(t.vialAmount)),m(String(t.waterAmount)),h(String(t.doseAmount)),j(t.doseUnit||"mcg"),I(t.syringeType||"u100"),R(!1)},Y=async t=>{if(c){const{error:n}=await T.from("user_calculations").delete().eq("id",t);n||N(a=>a.filter(i=>i.id!==t))}else{const n=C.filter(a=>a.id!==t);N(n),localStorage.setItem(q,JSON.stringify(n))}},K=()=>{_(""),u("5"),m("2"),h("250"),j("mcg"),I("u100")},Q=()=>{if(b<=0||x<=0)return;const t=$.find(f=>f.id===B),n=t?.unitsPerMl||100,a=t?.maxUnits||100,i=g==="mg"?x*1e3:x,o=b*1e3,U=[10,20,25,50,5,15,30,40];let v=null;for(const f of U){if(f>a)continue;const A=o*f/(i*n);if(A>=.5&&A<=3){const W=Math.round(A*10)/10;if(i/(o/W)*n<=a){v=W;break}}}v||(v=2),m(String(v))};return e.jsxs("div",{className:s.container,children:[e.jsxs("div",{className:s.pageHeader,children:[e.jsxs("div",{className:s.headerLeft,children:[e.jsx(F,{size:28,className:s.headerIcon}),e.jsxs("div",{children:[e.jsx("h1",{children:"Reconstitution Calculator"}),e.jsx("p",{children:"Calculate exact syringe draw volumes"})]})]}),e.jsxs("div",{className:s.headerActions,children:[e.jsxs("button",{className:`${s.iconBtn} ${D?s.iconBtnActive:""}`,onClick:()=>R(!D),title:"Saved calculations",children:[e.jsx(ee,{size:20}),C.length>0&&e.jsx("span",{className:s.badge,children:C.length})]}),e.jsx("button",{className:s.iconBtn,onClick:K,title:"Reset",children:e.jsx(te,{size:20})})]})]}),D&&e.jsxs("div",{className:`card glass-panel ${s.savedPanel}`,children:[e.jsx("h3",{children:"Saved Calculations"}),C.length===0?e.jsx("p",{className:s.noSaved,children:"No saved calculations yet"}):e.jsx("div",{className:s.savedList,children:C.map(t=>e.jsxs("div",{className:s.savedItem,children:[e.jsxs("button",{className:s.savedItemBtn,onClick:()=>J(t),children:[e.jsx("span",{className:s.savedPeptide,children:t.peptide}),e.jsxs("span",{className:s.savedDetails,children:[t.vialAmount,"mg / ",t.waterAmount,"ml → ",t.doseAmount,t.doseUnit]})]}),e.jsx("button",{className:s.deleteBtn,onClick:()=>Y(t.id),children:e.jsx(se,{size:16})})]},t.id))})]}),e.jsxs("div",{className:"card glass-panel",children:[e.jsxs("div",{className:s.inputGroup,ref:P,children:[e.jsxs("label",{className:s.label,children:[e.jsx(ne,{size:16}),"Peptide"]}),e.jsxs("div",{className:s.autocompleteWrapper,children:[e.jsx("input",{type:"text",placeholder:"Search or type peptide name...",value:d,onChange:t=>_(t.target.value),onFocus:()=>L(!0),className:s.input,autoComplete:"off"}),e.jsx(ae,{size:18,className:`${s.chevron} ${G?s.chevronUp:""}`}),G&&V.length>0&&e.jsx("div",{className:s.autocomplete,children:V.map(t=>e.jsxs("button",{type:"button",className:s.autocompleteItem,onClick:()=>O(t),children:[e.jsx("span",{children:t}),e.jsx("span",{className:s.peptideCategory,children:p.find(n=>n.name===t)?.category})]},t))})]}),w&&e.jsxs("p",{className:s.peptideHint,children:["Common: ",w.commonDosage]})]}),e.jsxs("div",{className:s.inputGroup,children:[e.jsxs("label",{className:s.label,children:[e.jsx(F,{size:16}),"Vial Quantity"]}),e.jsxs("div",{className:s.inputWithUnit,children:[e.jsx("input",{type:"number",value:S,onChange:t=>u(t.target.value),onWheel:t=>t.target.blur(),step:"1",min:"0",className:s.input}),e.jsx("span",{className:s.unitLabel,children:"mg"})]}),e.jsx("div",{className:s.quickButtons,children:[5,10,15,20].map(t=>e.jsxs("button",{className:`${s.quickBtn} ${b===t?s.quickBtnActive:""}`,onClick:()=>u(String(t)),children:[t,"mg"]},t))})]}),e.jsxs("div",{className:s.inputGroup,children:[e.jsxs("label",{className:s.label,children:[e.jsx(ie,{size:16}),"Bacteriostatic Water"]}),e.jsxs("div",{className:s.inputWithUnit,children:[e.jsx("input",{type:"number",value:M,onChange:t=>m(t.target.value),onWheel:t=>t.target.blur(),step:"0.5",min:"0",className:s.input}),e.jsx("span",{className:s.unitLabel,children:"ml"})]}),e.jsxs("div",{className:s.quickButtons,children:[lt.map(t=>e.jsxs("button",{className:`${s.quickBtn} ${k===t?s.quickBtnActive:""}`,onClick:()=>m(String(t)),children:[t,"ml"]},t)),e.jsxs("button",{className:`${s.quickBtn} ${s.recommendBtn}`,onClick:Q,title:"Calculate optimal water for easy-to-read syringe marks",children:[e.jsx(oe,{size:14}),"Recommend"]})]})]}),e.jsxs("div",{className:s.inputGroup,children:[e.jsxs("label",{className:s.label,children:[e.jsx(re,{size:16}),"Desired Dose"]}),e.jsxs("div",{className:s.doseInputRow,children:[e.jsx("input",{type:"number",value:y,onChange:t=>h(t.target.value),onWheel:t=>t.target.blur(),step:g==="mg"?"0.1":"50",min:"0",className:s.input}),e.jsxs("div",{className:s.unitToggle,children:[e.jsx("button",{className:`${s.unitBtn} ${g==="mcg"?s.unitBtnActive:""}`,onClick:()=>j("mcg"),children:"mcg"}),e.jsx("button",{className:`${s.unitBtn} ${g==="mg"?s.unitBtnActive:""}`,onClick:()=>j("mg"),children:"mg"})]})]}),e.jsx("div",{className:s.quickButtons,children:E.map(t=>e.jsx("button",{className:`${s.quickBtn} ${x===t&&g==="mcg"?s.quickBtnActive:""}`,onClick:()=>{h(String(t)),j("mcg")},children:t>=1e3?`${t/1e3}mg`:`${t}mcg`},t))})]}),e.jsxs("div",{className:s.inputGroup,children:[e.jsx("label",{className:s.label,children:"Syringe Type"}),e.jsx("div",{className:s.syringeTypes,children:$.map(t=>e.jsx("button",{className:`${s.syringeBtn} ${B===t.id?s.syringeBtnActive:""}`,onClick:()=>I(t.id),children:t.name},t.id))})]}),l&&e.jsxs("div",{className:s.resultContainer,children:[l.isOverMax&&e.jsxs("div",{className:s.warning,children:["⚠️ Dose exceeds syringe capacity (",l.maxUnits," units max). Use more water or a larger syringe."]}),e.jsxs("div",{className:s.resultCard,children:[e.jsx("span",{className:s.resultLabel,children:"Draw to Tick Mark"}),e.jsx("span",{className:`${s.resultValue} ${l.isOverMax?s.resultWarning:""}`,children:l.units}),e.jsx("span",{className:s.resultUnit,children:"Units"})]}),e.jsx(rt,{units:Math.min(parseFloat(l.units),l.maxUnits),maxUnits:l.maxUnits}),e.jsxs("div",{className:s.details,children:[e.jsxs("div",{className:s.detailRow,children:[e.jsx("span",{children:"Volume to Draw:"}),e.jsxs("span",{children:[Number(l.drawMl)," mL"]})]}),e.jsxs("div",{className:s.detailRow,children:[e.jsx("span",{children:"Concentration:"}),e.jsxs("span",{children:[l.concentration.toFixed(1)," mcg/ml"]})]}),e.jsxs("div",{className:s.detailRow,children:[e.jsx("span",{children:"Doses per Vial:"}),e.jsxs("span",{className:s.dosesValue,children:[l.dosesPerVial," doses"]})]})]}),e.jsxs("button",{className:s.saveBtn,onClick:H,children:[e.jsx(le,{size:18}),"Save This Calculation"]})]})]}),e.jsxs("div",{className:s.infoBox,children:[e.jsx(ce,{size:16}),e.jsxs("div",{children:[e.jsx("strong",{children:"U-100 Insulin Syringe:"})," Most common. 100 units = 1ml.",e.jsx("br",{}),e.jsx("strong",{children:"Tip:"})," Add a little extra BAC water for easier dosing."]})]})]})},xt=()=>e.jsx("div",{className:"padding-container",style:{padding:"20px"},children:e.jsx(dt,{})});export{xt as default};
